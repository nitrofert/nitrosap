"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[817],{817:(ma,re,s)=>{s.r(re),s.d(re,{SolpedModule:()=>P});var m=s(6895),_=s(4006),f=s(9335),d=s(805),e=s(4650),T=s(1562),y=s(4931),x=s(2453),C=s(5861),Z=s(1922),le=s(3631),v=s(5593),M=s(3608),W=s(585),E=s(1493),se=s(5108),U=s(2210),de=s(3388),H=s(8235),pe=s(5047),J=s(3054),I=s(1740),S=s(99),L=s(9090);const me=["filter"],_e=function(){return{height:"6px"}};function he(n,o){1&n&&(e.TgZ(0,"div",39),e._UZ(1,"p-progressBar",57),e.qZA()),2&n&&(e.xp6(1),e.Akn(e.DdM(2,_e)))}function ge(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",39)(1,"p-button",58),e.NdJ("onClick",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.MostrarDetalle())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].read_accion)("badge",t.lineasSolped.length.toString())}}function fe(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.CardCode," - ",t.CardName,"")}}function Ce(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.ItemCode," - ",t.ItemName,"")}}function be(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.viceprecidencia.vicepresidency)}}function Se(n,o){if(1&n&&e.YNc(0,be,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.viceprecidencia)}}function ve(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.vicepresidency)}}function Te(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.dependencia.dependence)}}function ye(n,o){if(1&n&&e.YNc(0,Te,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.dependencia)}}function xe(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.dependence)}}function Ae(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.localidad.location)}}function Ze(n,o){if(1&n&&e.YNc(0,Ae,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.localidad)}}function Me(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.location)}}function Ue(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.almacen.storename)}}function Ne(n,o){if(1&n&&e.YNc(0,Ue,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.almacen)}}function we(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.storename)}}function qe(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.impuesto.Code)}}function Fe(n,o){if(1&n&&e.YNc(0,qe,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.impuesto)}}function Pe(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.AsE("",t.Code," - ",t.Name,"")}}const b=function(n){return{"ng-invalid ng-dirty":n}},ee=function(){return{width:"100%"}};function Ee(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",39)(2,"label",59),e._uU(3,"Fecha necesaria"),e.qZA(),e.TgZ(4,"p-calendar",60),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.fechaRequerida=i)}),e.qZA()(),e.TgZ(5,"div",39)(6,"label",61),e._uU(7,"Proveedor"),e.qZA(),e.TgZ(8,"p-autoComplete",62),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.proveedor=i)})("completeMethod",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.filtrarProveedores(i))})("onSelect",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarProveedor())}),e.YNc(9,fe,2,2,"ng-template",63),e.qZA()()(),e.TgZ(10,"div",1)(11,"div",39)(12,"label",64),e._uU(13,"C\xf3digo \xedtem"),e.qZA(),e.TgZ(14,"p-autoComplete",65),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.item=i)})("completeMethod",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.filtrarItems(i))})("onSelect",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarItemCode())})("onClear",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearItemCode())}),e.YNc(15,Ce,2,2,"ng-template",63),e.qZA()(),e.TgZ(16,"div",39)(17,"label",66),e._uU(18,"Descripci\xf3n"),e.qZA(),e.TgZ(19,"input",67),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.descripcion=i)}),e.qZA()()(),e.TgZ(20,"div",1)(21,"div",39)(22,"label",68),e._uU(23,"Vicepresidencia"),e.qZA(),e.TgZ(24,"p-dropdown",69,70),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.viceprecidencia=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarVicepresidencia())}),e.YNc(26,Se,1,1,"ng-template",71),e.YNc(27,ve,3,1,"ng-template",63),e.qZA()(),e.TgZ(28,"div",39)(29,"label",72),e._uU(30,"Dependencia"),e.qZA(),e.TgZ(31,"p-dropdown",73,74),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.dependencia=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarDependencia())}),e.YNc(33,ye,1,1,"ng-template",71),e.YNc(34,xe,3,1,"ng-template",63),e.qZA()(),e.TgZ(35,"div",39)(36,"label",75),e._uU(37,"Localidad"),e.qZA(),e.TgZ(38,"p-dropdown",76,77),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.localidad=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarLocalidad())}),e.YNc(40,Ze,1,1,"ng-template",71),e.YNc(41,Me,3,1,"ng-template",63),e.qZA()()(),e.TgZ(42,"div",1)(43,"div",39)(44,"label",78),e._uU(45,"Almacen"),e.qZA(),e.TgZ(46,"p-dropdown",79),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.almacen=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarAlmacen())}),e.YNc(47,Ne,1,1,"ng-template",71),e.YNc(48,we,3,1,"ng-template",63),e.qZA()()(),e.TgZ(49,"div",1)(50,"div",39)(51,"label",80),e._uU(52,"Cantidad"),e.qZA(),e.TgZ(53,"input",81),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.cantidad=i)})("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.calcularSubtotalLinea())}),e.qZA()(),e.TgZ(54,"div",39)(55,"label",82),e._uU(56,"Precio"),e.qZA(),e.TgZ(57,"div",16)(58,"p-dropdown",83),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.moneda=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarMoneda())}),e.qZA(),e.TgZ(59,"p-inputNumber",84),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.precio=i)})("ngModelChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.calcularSubtotalLinea())}),e.qZA()()(),e.TgZ(60,"div",39)(61,"label",85),e._uU(62,"Subtotal linea"),e.qZA(),e.TgZ(63,"p-inputNumber",86),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.subtotalLinea=i)}),e.qZA()()(),e.TgZ(64,"div",1)(65,"div",39)(66,"label",87),e._uU(67,"Impuesto"),e.qZA(),e.TgZ(68,"div",16)(69,"p-dropdown",88),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.impuesto=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarImpuesto())}),e.YNc(70,Fe,1,1,"ng-template",71),e.YNc(71,Pe,3,2,"ng-template",63),e.qZA(),e.TgZ(72,"p-inputNumber",89),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.prcImpuesto=i)}),e.qZA()()(),e.TgZ(73,"div",39)(74,"label",90),e._uU(75,"Valor impuesto"),e.qZA(),e.TgZ(76,"p-inputNumber",91),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.valorImpuesto=i)}),e.qZA()(),e.TgZ(77,"div",39)(78,"label",92),e._uU(79,"Total linea"),e.qZA(),e.TgZ(80,"p-inputNumber",93),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.totalLinea=i)}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.fechaRequerida)("showIcon",!0)("required",!0)("ngClass",e.VKq(66,b,t.envioLinea&&!t.fechaRequerida)),e.xp6(4),e.Q6J("ngModel",t.proveedor)("showEmptyMessage",!0)("suggestions",t.proveedoresFiltrados)("minLength",1)("delay",1e3),e.xp6(6),e.Q6J("ngModel",t.item)("showEmptyMessage",!0)("suggestions",t.itemsFiltrados)("minLength",1)("delay",1e3)("showClear",!0)("autofocus",!0)("disabled","S"===t.clase)("ngClass",e.VKq(68,b,"I"===t.clase&&t.envioLinea&&!t.item.ItemCode)),e.xp6(5),e.Q6J("ngModel",t.descripcion)("ngClass",e.VKq(70,b,t.envioLinea&&!t.descripcion)),e.xp6(5),e.Q6J("options",t.vicepresidencias)("ngModel",t.viceprecidencia)("filter",!0)("showClear",!0)("ngClass",e.VKq(72,b,t.envioLinea&&!t.viceprecidencia.vicepresidency)),e.xp6(7),e.Q6J("options",t.dependencias)("ngModel",t.dependencia)("filter",!0)("showClear",!0)("ngClass",e.VKq(74,b,t.envioLinea&&!t.dependencia.dependence)),e.xp6(7),e.Q6J("options",t.localidades)("ngModel",t.localidad)("filter",!0)("showClear",!0)("ngClass",e.VKq(76,b,t.envioLinea&&!t.localidad.location)),e.xp6(8),e.Q6J("options",t.almacenes)("ngModel",t.almacen)("filter",!0)("showClear",!0)("ngClass",e.VKq(78,b,t.envioLinea&&!t.almacen.store)),e.xp6(7),e.Q6J("ngModel",t.cantidad)("ngClass",e.VKq(80,b,t.envioLinea&&!t.cantidad)),e.xp6(5),e.Q6J("options",t.monedas)("ngModel",t.moneda)("required",!0)("readonly",t.lineasSolped.length>0),e.xp6(1),e.Q6J("ngModel",t.precio)("ngStyle",e.DdM(82,ee)),e.xp6(4),e.Q6J("ngModel",t.subtotalLinea)("ngStyle",e.DdM(83,ee))("readonly",!0),e.xp6(6),e.Q6J("options",t.impuestos)("ngModel",t.impuesto)("filter",!0)("showClear",!0)("ngClass",e.VKq(84,b,t.envioLinea&&!t.impuesto)),e.xp6(3),e.Q6J("ngModel",t.prcImpuesto)("readonly",!0)("disabled",!0),e.xp6(4),e.Q6J("ngModel",t.valorImpuesto)("ngStyle",e.DdM(86,ee))("readonly",!0)("disabled",!0),e.xp6(4),e.Q6J("ngModel",t.totalLinea)("disabled",!0)("readonly",!0)}}function Je(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",97),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.RegistrarLinea())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion)}}function Ie(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",98)(1,"div")(2,"button",99),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(99);return e.KtG(i.clear(r))}),e.qZA(),e.TgZ(3,"button",100),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.AdicionarLinea())}),e.qZA(),e.TgZ(4,"button",101),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.EditarLinea())}),e.qZA(),e.TgZ(5,"button",102),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.BorrarLineas())}),e.qZA()(),e.TgZ(6,"span",103),e._UZ(7,"i",104),e.TgZ(8,"input",105,106),e.NdJ("input",function(i){e.CHM(t);const r=e.oxw(),l=e.MAs(99);return e.KtG(r.onGlobalFilter(l,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("label",t.permisosUsuarioPagina.length>0&&t.permisosUsuarioPagina[0].create_accion?"Editar":"Consultar")("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaSeleccionada||1!=t.lineaSeleccionada.length),e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaSeleccionada||0==t.lineaSeleccionada.length||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)}}function Le(n,o){1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",107),e.TgZ(2,"th")(3,"div",108),e._uU(4," Linea detalle "),e._UZ(5,"p-columnFilter",109),e.qZA()(),e.TgZ(6,"th")(7,"div",108),e._uU(8," C\xf3digo Item "),e._UZ(9,"p-columnFilter",110),e.qZA()(),e.TgZ(10,"th")(11,"div",108),e._uU(12," Descripci\xf3n "),e._UZ(13,"p-columnFilter",111),e.qZA()(),e.TgZ(14,"th")(15,"div",108),e._uU(16," Fecha requerida "),e.qZA()(),e.TgZ(17,"th")(18,"div",108),e._uU(19," Proveedor "),e._UZ(20,"p-columnFilter",112),e.qZA()(),e.TgZ(21,"th")(22,"div",108),e._uU(23," Cuenta Mayor "),e._UZ(24,"p-columnFilter",113),e.qZA()(),e.TgZ(25,"th")(26,"div",108),e._uU(27," Vicepresidencia "),e._UZ(28,"p-columnFilter",114),e.qZA()(),e.TgZ(29,"th")(30,"div",108),e._uU(31," Dependencia "),e._UZ(32,"p-columnFilter",115),e.qZA()(),e.TgZ(33,"th")(34,"div",108),e._uU(35," Localidad "),e._UZ(36,"p-columnFilter",116),e.qZA()(),e.TgZ(37,"th")(38,"div",108),e._uU(39," Cantidad "),e.qZA()(),e.TgZ(40,"th")(41,"div",108),e._uU(42," Precio "),e.qZA()(),e.TgZ(43,"th")(44,"div",108),e._uU(45," Impuesto "),e.qZA()(),e.TgZ(46,"th")(47,"div",108),e._uU(48," Valor Impuesto "),e.qZA()(),e.TgZ(49,"th")(50,"div",108),e._uU(51," Subtotal l\xednea "),e.qZA()(),e.TgZ(52,"th")(53,"div",108),e._uU(54," Total l\xednea "),e.qZA()()())}function ke(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"p-tableCheckbox",117),e.NdJ("onClick",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarLinea())}),e.qZA()(),e.TgZ(3,"td",118),e._uU(4),e.qZA(),e.TgZ(5,"td",118),e._uU(6),e.qZA(),e.TgZ(7,"td",118),e._uU(8),e.qZA(),e.TgZ(9,"td",118),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td",118),e._uU(13),e.qZA(),e.TgZ(14,"td",118),e._uU(15),e.qZA(),e.TgZ(16,"td",118),e._uU(17),e.qZA(),e.TgZ(18,"td",118),e._uU(19),e.qZA(),e.TgZ(20,"td",118),e._uU(21),e.qZA(),e.TgZ(22,"td",118),e._uU(23),e.qZA(),e.TgZ(24,"td",118),e._uU(25),e.ALo(26,"currency"),e.qZA(),e.TgZ(27,"td",118),e._uU(28),e.ALo(29,"percent"),e.qZA(),e.TgZ(30,"td",118),e._uU(31),e.ALo(32,"currency"),e.qZA(),e.TgZ(33,"td",118),e._uU(34),e.ALo(35,"currency"),e.qZA(),e.TgZ(36,"td",118),e._uU(37),e.ALo(38,"currency"),e.qZA()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.linenum," "),e.xp6(2),e.hij(" ",t.itemcode," "),e.xp6(2),e.hij(" ",t.dscription," "),e.xp6(2),e.hij(" ",e.lcZ(11,17,t.reqdatedet)," "),e.xp6(3),e.hij(" ",t.linevendor," "),e.xp6(2),e.hij(" ",t.acctcode," "),e.xp6(2),e.hij(" ",t.ocrcode3," "),e.xp6(2),e.hij(" ",t.ocrcode2," "),e.xp6(2),e.hij(" ",t.ocrcode," "),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",e.xi3(26,19,t.price,t.moneda)," "),e.xp6(3),e.AsE(" ",t.tax," ",e.lcZ(29,22,t.linegtotal/t.linetotal-1)," "),e.xp6(3),e.hij(" ",e.xi3(32,24,t.taxvalor,"COP")," "),e.xp6(3),e.hij(" ",e.xi3(35,27,t.linetotal,"COP")," "),e.xp6(3),e.hij(" ",e.xi3(38,30,t.linegtotal,"COP")," ")}}function De(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",119),e._uU(2,"Total"),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"currency"),e.qZA()()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(e.xi3(5,3,t.totalimpuestos,"COP")),e.xp6(3),e.Oqu(e.xi3(8,6,t.subtotal,"COP")),e.xp6(3),e.Oqu(e.xi3(11,9,t.grantotal,"COP"))}}function Oe(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",120),e._uU(2,"No se econtraron lineas asociadas a la solped."),e.qZA()())}function ze(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",120),e._uU(2,"Cargando solicitudes de pedido. Por favor espere"),e.qZA()())}function Qe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",121),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.listadoLineas=!1)}),e.qZA()}}function Re(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",98)(1,"div")(2,"button",99),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(99);return e.KtG(i.clear(r))}),e.qZA(),e.TgZ(3,"button",122),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.AdicionarAnexo())}),e.qZA(),e.TgZ(4,"button",123),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.BorrarAnexo())}),e.qZA()(),e.TgZ(5,"span",103),e._UZ(6,"i",104),e.TgZ(7,"input",105,106),e.NdJ("input",function(i){e.CHM(t);const r=e.oxw(),l=e.MAs(99);return e.KtG(r.onGlobalFilter(l,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaAnexoSeleccionada||0==t.lineaAnexoSeleccionada.length||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)}}function Ke(n,o){1&n&&(e.TgZ(0,"th",127),e._UZ(1,"div",108),e.qZA())}function Be(n,o){if(1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",107),e.TgZ(2,"th")(3,"div",108),e._uU(4," Tipo "),e._UZ(5,"p-columnFilter",124),e.qZA()(),e.TgZ(6,"th")(7,"div",108),e._uU(8," Nombre anexo "),e._UZ(9,"p-columnFilter",125),e.qZA()(),e.TgZ(10,"th")(11,"div",108),e._uU(12," Tama\xf1o anexo "),e.qZA()(),e.YNc(13,Ke,2,0,"th",126),e.qZA()),2&n){const t=e.oxw();e.xp6(13),e.Q6J("ngIf",t.solpedEditar)}}function Ge(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",130)(1,"p-button",131),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw();return e.KtG(r.consultarAnexo(i.url))}),e.qZA()()}}function Ye(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",128),e.qZA(),e.TgZ(3,"td",118),e._uU(4),e.qZA(),e.TgZ(5,"td",118),e._uU(6),e.qZA(),e.TgZ(7,"td",118),e._uU(8),e.qZA(),e.YNc(9,Ge,2,0,"td",129),e.qZA()),2&n){const t=o.$implicit,a=e.oxw();e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.tipo," "),e.xp6(2),e.hij(" ",t.file.name," "),e.xp6(2),e.hij(" ",t.file.size," "),e.xp6(1),e.Q6J("ngIf",a.solpedEditar)}}function He(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",120),e._uU(2,"No se econtraron anexos asociados a la solped."),e.qZA()())}function je(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",120),e._uU(2,"Cargando anexos asociados a la solicitud de pedido. Por favor espere"),e.qZA()())}function $e(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",121),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.listadoAnexos=!1)}),e.qZA()}}function Ve(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.tipoanexo.name)}}function Xe(n,o){if(1&n&&e.YNc(0,Ve,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.tipoanexo)}}function We(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.name)}}function et(n,o){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.name," - ",t.size," bytes")}}function tt(n,o){if(1&n&&(e.TgZ(0,"ul"),e.YNc(1,et,2,2,"li",136),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.uploadedFiles)}}function ot(n,o){if(1&n&&e.YNc(0,tt,2,1,"ul",135),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.uploadedFiles.length)}}function it(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",39)(2,"label",132),e._uU(3,"Tipo anexo"),e.qZA(),e.TgZ(4,"p-dropdown",133,70),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.tipoanexo=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.seleccionarTipoAnexo())}),e.YNc(6,Xe,1,1,"ng-template",71),e.YNc(7,We,3,1,"ng-template",63),e.qZA()()(),e.TgZ(8,"div",1)(9,"div",39)(10,"p-fileUpload",134),e.NdJ("onSelect",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onLoad(i))}),e.YNc(11,ot,1,1,"ng-template",44),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("options",t.tiposanexo)("ngModel",t.tipoanexo)("filter",!0)("showClear",!0)("ngClass",e.VKq(10,b,t.envioLineaanexo&&!t.tipoanexo||t.envioLineaanexo&&""==t.tipoanexo)),e.xp6(6),e.Q6J("multiple",!1)("showUploadButton",!1)("maxFileSize",1e6)("ngClass",e.VKq(12,b,t.envioLineaanexo&&!t.fileTmp||t.envioLineaanexo&&""==t.fileTmp))("disabled",!t.tipoanexo)}}function at(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",97),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.adicionarlineaAnexo())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion)}}const j=function(){return{width:"50vw"}},ce=function(){return{"960px":"75vw","640px":"100vw"}},nt=function(){return["itemcode","dscription","linevendor","acctcodename","acctcode","ocrcode","ocrcode2","ocrcode3"]},rt=function(){return["tipo","file.name","created_at"]};class N{constructor(o,t,a,i,r,l){this.authService=o,this.sapService=t,this.comprasService=a,this.router=i,this.messageService=r,this.rutaActiva=l,this.onNewSolped=new e.vpe,this.perfilesUsuario=[],this.permisosUsuario=[],this.dependenciasUsuario=[],this.vicepresidencias=[],this.dependencias=[],this.localidades=[],this.series=[],this.areas=[],this.clases=[],this.materiaprima=[{option:"Si",value:"S"},{option:"No",value:"N"}],this.proveedores=[],this.items=[],this.cuentas=[],this.almacenes=[],this.monedas=[],this.trm=0,this.impuestos=[],this.estados=[{name:"Proyectado"},{name:"Solicitado"}],this.nombreusuario="",this.area="",this.clase="I",this.nf_pedmp="",this.serie="",this.serieName="",this.codigoSap="0",this.fechaContable=new Date,this.fechaCaducidad=new Date,this.fechaDocumento=new Date,this.fechaNecesidad=new Date,this.comentarios="",this.currency="COP",this.nf_agente="",this.nf_pago="",this.nf_tipocarga="",this.nf_puertosalida="",this.nf_motonave="",this.nf_lastshippping=new Date,this.nf_dateofshipping=new Date,this.nf_Incoterms="",this.iteradorLinea=0,this.numeroLinea=-1,this.fechaRequerida=new Date,this.descripcion="",this.unidad="",this.almacen="",this.zonacode="",this.nombreCuenta="",this.cantidad=1,this.moneda="",this.precio=0,this.subtotalLinea=0,this.impuesto="",this.prcImpuesto=0,this.valorImpuesto=0,this.totalLinea=0,this.tiposdecarga=[{tipo:"Empacado"},{tipo:"Granel"}],this.totalimpuestos=0,this.subtotal=0,this.grantotal=0,this.lineasSolped=[],this.lineaSeleccionada=[],this.anexosSolped=[],this.lineaAnexoSeleccionada=[],this.envioFormulario=!1,this.nuevaLinea=!1,this.editarLinea=!1,this.formularioLinea=!1,this.formularioAnexo=!1,this.envioLinea=!1,this.envioLineaanexo=!1,this.listadoLineas=!1,this.listadoAnexos=!1,this.uploadedFiles=[],this.tiposanexo=[{name:"Revisi\xf3n presupuestal"},{name:"Especificaci\xf3n t\xe9cnica"},{name:"Otro"}],this.loading=!1,this.solpedAprobada="N",this.urlBreadCrumb="",this.loadingSave=!1,this.proveedoresFiltrados=[],this.itemsFiltrados=[],this.cuentasFiltradas=[]}ngOnInit(){this.getInfoUsuario(),this.getPerfilesUsuario(),this.getPermisosUsuario(),this.getPermisosUsuarioPagina(),this.getDependenciasUsuario()}getInfoUsuario(){this.infoUsuario=this.authService.getInfoUsuario()}getPerfilesUsuario(){this.perfilesUsuario=this.authService.getPerfilesUsuario()}getPermisosUsuario(){this.permisosUsuario=this.authService.getPermisosUsuario()}getPermisosUsuarioPagina(){let o="";if(this.rutaActiva.snapshot.params.solped){let t=this.rutaActiva.snapshot.params;this.router.url.indexOf("/"+t.solped)>=0&&(o=this.router.url.substring(0,this.router.url.indexOf("/"+t.solped)))}else o=this.router.url;this.urlBreadCrumb=o,this.permisosUsuarioPagina=this.permisosUsuario.filter(t=>t.url===o),console.log(this.permisosUsuario,this.permisosUsuarioPagina)}getDependenciasUsuario(){this.authService.getDependeciasUsuarioXE().subscribe({next:o=>{for(let t in o)this.dependenciasUsuario.push(o[t]);console.log("dependencias usuario",this.dependenciasUsuario);for(let t of this.dependenciasUsuario)0===this.vicepresidencias.filter(a=>a.vicepresidency===t.vicepresidency).length&&this.vicepresidencias.push(t);0==this.vicepresidencias.length&&this.vicepresidencias.push({codusersap:this.infoUsuario.codusersap,dependence:"VPCADSU2",location:"SANTAMAR",vicepresidency:"VPCADSUM",id:0}),this.getSeries()},error:o=>{}})}getSeries(){this.sapService.seriesDocXEngineSAP(this.authService.getToken(),"1470000113").subscribe({next:o=>{console.log(o);for(let t in o)"SPMP"==o[t].name&&this.series.push(o[t]);this.serie=this.series[0].code,this.serieName=this.series[0].name,this.clase="I",this.getAreas()},error:o=>{console.log(o)}})}getAreas(){var o=this;return(0,C.Z)(function*(){yield o.authService.getAreasUsuarioXE().subscribe({next:t=>{for(let a in t)o.areas.push(t[a]);console.log("Areas usuario:",o.areas),0==o.areas.length&&o.areas.push({codusersap:o.infoUsuario.username,area:"VPCADSU2"}),o.area="VPCADSU2",o.getClases()},error:t=>{}})})()}getClases(){this.clases=[{code:"I",name:"Art\xedculo"},{code:"S",name:"Servicio"}],this.getProveedores()}getProveedores(){this.sapService.BusinessPartnersXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.proveedores.push(o[t]);this.getItems()},error:o=>{}})}getItems(){this.sapService.itemsSAPXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.items.push(o[t]);this.getAlmacenesMPSL()},error:o=>{}})}getAlmacenesMPSL(){this.sapService.getAlmacenesMPSL(this.authService.getToken()).subscribe({next:o=>{for(let t in o.value)this.almacenes.push({store:o.value[t].WarehouseCode,storename:o.value[t].WarehouseName,zonacode:o.value[t].State});this.getCuentas()},error:o=>{console.log(o)}})}getCuentas(){this.sapService.CuentasSAPXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.cuentas.push(o[t]);this.getMonedas(new Date)},error:o=>{}})}getMonedas(o){this.sapService.monedasXEngineSAP(this.authService.getToken(),o.toISOString()).subscribe({next:t=>{this.monedas=[{Currency:"COP",TRM:1}];for(let a in t)this.monedas.push(t[a]);this.setearTRMSolped("USD"),this.getImpuestos()},error:t=>{}})}getAlmacenes(){this.authService.getAlmacenesUsuarioXE().subscribe({next:o=>{console.log(o);for(let t in o)this.almacenes.push(o[t])},error:o=>{}})}getImpuestos(){this.comprasService.taxesXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.impuestos.push(o[t]);this.SeleccionarImpuesto(),setTimeout(()=>{this.getInformacionSolped()},500),this.resetearFormularioLinea()},error:o=>{}})}getInformacionSolped(){this.solpedEditar&&this.comprasService.solpedById(this.authService.getToken(),this.solpedEditar).subscribe({next:o=>{this.infoSolpedEditar=o,this.lineasSolped=this.infoSolpedEditar.solpedDet,this.serie=this.series.filter(t=>t.code==this.infoSolpedEditar.solped.serie)[0].code,this.codigoSap=this.infoSolpedEditar.solped.sapdocnum||"0",this.clase=this.infoSolpedEditar.solped.doctype||"",this.fechaContable=new Date(this.infoSolpedEditar.solped.docdate.toString().replace("T00","T05")),this.fechaCaducidad=new Date(this.infoSolpedEditar.solped.docduedate.toString().replace("T00","T05")),this.fechaDocumento=new Date(this.infoSolpedEditar.solped.taxdate.toString().replace("T00","T05")),this.fechaNecesidad=new Date(this.infoSolpedEditar.solped.reqdate.toString().replace("T00","T05")),this.comentarios=this.infoSolpedEditar.solped.comments||"",this.trm=this.infoSolpedEditar.solped.trm,this.currency=this.infoSolpedEditar.solped.currency||1===this.trm?"COP":"USD",this.iteradorLinea=this.lineasSolped[this.lineasSolped.length-1].linenum+1,this.solpedAprobada=this.infoSolpedEditar.solped.approved||"N",this.areas.filter(t=>t.area===this.infoSolpedEditar.solped.u_nf_depen_solped).length>0&&(this.area=this.areas.filter(t=>t.area===this.infoSolpedEditar.solped.u_nf_depen_solped)[0].area),this.u_nf_status=this.estados.filter(t=>t.name===this.infoSolpedEditar.solped.u_nf_status)[0].name,this.nf_agente=this.infoSolpedEditar.solped.nf_agente||"",this.nf_lastshippping=new Date(this.infoSolpedEditar.solped.nf_lastshippping||Date.now()),this.nf_dateofshipping=new Date(this.infoSolpedEditar.solped.nf_dateofshipping||Date.now()),this.nf_pago=this.infoSolpedEditar.solped.nf_pago||"",this.nf_tipocarga=this.infoSolpedEditar.solped.nf_tipocarga||"",this.nf_puertosalida=this.infoSolpedEditar.solped.nf_puertosalida||"",this.nf_motonave=this.infoSolpedEditar.solped.nf_motonave||""},error:o=>{console.log(o)}})}SeleccionarArea(){}SeleccionarClase(){}SeleccionarSerie(){this.serieName=this.series.filter(o=>o.code===this.serie)[0].name,this.clase="SPB"==this.serieName?"I":"",this.resetearFormularioLinea()}SeleccionarFechaContable(){this.getMonedas(this.fechaContable)}SeleccionarProveedor(){}SeleccionarItemCode(){console.log(this.item),this.descripcion=this.item.ItemName,this.getUnidadItemSL(),this.impuesto=this.item.ApTaxCode?this.impuestos.filter(o=>o.Code===this.item.ApTaxCode)[0]:this.impuestos.filter(o=>"ID08"===o.Code)[0],this.SeleccionarImpuesto(),this.cuenta={Code:"",Name:""},this.nombreCuenta=""}getUnidadItemSL(){this.sapService.getUnidadItemSL(this.authService.getToken(),this.item.ItemCode).subscribe({next:o=>{this.unidad=o.value[0].PurchaseUnit,console.log(this.unidad)},error:o=>{console.log(o)}})}SeleccionarVicepresidencia(){if(this.viceprecidencia){let o=this.dependenciasUsuario.filter(t=>t.vicepresidency===this.viceprecidencia.vicepresidency);for(let t of o)0===this.dependencias.filter(a=>a.dependence===t.dependence).length&&this.dependencias.push(t);0==this.dependencias.length&&this.dependencias.push({codusersap:this.infoUsuario.codusersap,dependence:"VPCADSU2",location:"SANTAMAR",vicepresidency:"VPCADSUM",id:0})}}SeleccionarDependencia(){if(this.dependencia){let o=this.dependenciasUsuario.filter(t=>t.dependence===this.dependencia.dependence&&t.vicepresidency===this.dependencia.vicepresidency);for(let t of o)0===this.localidades.filter(a=>a.location===t.location).length&&this.localidades.push(t);0==this.localidades.length&&(this.localidades.push({codusersap:this.infoUsuario.codusersap,dependence:"VPCADSU2",location:"SANTAMAR",vicepresidency:"VPCADSUM",id:0}),this.localidades.push({codusersap:this.infoUsuario.codusersap,dependence:"VPCADSU2",location:"BVENTURA",vicepresidency:"VPCADSUM",id:1})),this.cuentasxDependencia()}}SeleccionarLocalidad(){}SeleccionarAlmacen(){console.log(this.almacen),this.zonacode=this.almacen.zonacode,console.log(this.zonacode)}SeleccionarCuenta(){this.nombreCuenta=this.cuenta.Name}SeleccionarMoneda(){this.currency=this.monedas.filter(o=>o.Currency===this.moneda)[0].Currency,this.calcularSubtotalLinea()}SeleccionarImpuesto(){this.impuesto?(this.prcImpuesto=this.impuesto.tax,this.calcularImpuesto()):this.prcImpuesto=0}SeleccionarLinea(){}filtrarProveedores(o){let a,t=[],i=o.query;for(let r=0;r<this.proveedores.length;r++)a=this.proveedores[r],(a.CardCode.toLowerCase().indexOf(i.toLowerCase())>=0||a.CardName.toLowerCase().indexOf(i.toLowerCase())>=0)&&t.push(a);this.proveedoresFiltrados=t}filtrarItems(o){let t=[],a=o.query;for(let i=0;i<this.items.length;i++){let r=this.items[i];null!=r.ItemCode&&null!=r.ItemName&&(r.ItemCode.toLowerCase().indexOf(a.toLowerCase())>=0||r.ItemName.toLowerCase().indexOf(a.toLowerCase())>=0)&&t.push(r)}this.itemsFiltrados=t}clearItemCode(){}cuentasxDependencia(){this.sapService.cuentasPorDependenciaXE(this.authService.getToken(),this.dependencia.dependence).subscribe({next:o=>{let t=[];for(let r in o)t.push(o[r].U_NF_CUENTA);let a,i=[];for(let r=0;r<this.cuentas.length;r++){a=this.cuentas[r];for(let l of t)0==a.Code.indexOf(l)&&i.push(a)}this.cuentasDependencia=i},error:o=>{}})}filtrarCuentas(o){let t=[],a=o.query;for(let i=0;i<this.cuentasDependencia.length;i++){let r=this.cuentasDependencia[i];null!=r.Code&&null!=r.Name&&(r.Code.toLowerCase().indexOf(a.toLowerCase())>=0||r.Name.toLowerCase().indexOf(a.toLowerCase())>=0)&&t.push(r)}this.cuentasFiltradas=t}calcularSubtotalLinea(){this.monedas.filter(t=>t.Currency===this.moneda),this.subtotalLinea=this.cantidad&&this.precio?this.cantidad*this.precio:0,this.calcularImpuesto()}resetearFormularioLinea(){this.numeroLinea=-1,this.fechaRequerida=new Date,this.proveedor={CardCode:"PE821401799",CardName:"NITRON GROUP"},this.proveedoresFiltrados=[],this.item={ApTaxCode:"",ItemCode:"",ItemName:""},this.itemsFiltrados=[],this.descripcion="",this.viceprecidencia={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.dependencia={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.localidad={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.almacen="",this.cuenta={Code:"",Name:""},this.cuentasFiltradas=[],this.nombreCuenta="",this.cantidad=1,this.moneda=this.lineasSolped.length>0?this.lineasSolped[0].moneda||"COP":"USD",this.precio=0,this.subtotalLinea=0,this.impuesto="",this.prcImpuesto=0,this.valorImpuesto=0,this.totalLinea=0}setearTRMSolped(o){this.monedas.filter(t=>t.Currency===o).length>0?(this.trm=this.monedas.filter(t=>t.Currency===o)[0].TRM,this.moneda=o,console.log(this.moneda)):this.trm=0}calcularImpuesto(){this.valorImpuesto=this.impuesto.tax&&0!=this.subtotalLinea?this.subtotalLinea*(this.impuesto.tax/100):0,this.calcularTotalLinea()}calcularTotalLinea(){this.totalLinea=this.subtotalLinea+this.valorImpuesto}calculatTotales(){this.totalimpuestos=0,this.subtotal=0,this.grantotal=0;for(let o of this.lineasSolped)this.totalimpuestos+=o.taxvalor,this.subtotal+=o.linetotal,this.grantotal+=o.linegtotal}verAnexos(){this.listadoAnexos=!0}adicionarlineaAnexo(){this.envioLineaanexo=!0,this.tipoanexo&&""!=this.tipoanexo&&this.fileTmp&&""!=this.fileTmp?(this.solpedEditar?this.loadFile(this.solpedEditar,{tipo:this.tipoanexo.name,file:this.fileTmp.fileRaw,url:"#"}):this.anexosSolped.push({tipo:this.tipoanexo.name,file:this.fileTmp.fileRaw,url:"#"}),this.tipoanexo="",this.fileTmp="",this.formularioAnexo=!1):this.messageService.add({severity:"error",summary:"!Error\xa1",detail:"Debe seleccionar el tipo y el archivo a anexar a la solped"})}loadFile(o,t){let a;a=new FormData,a.append("myFile",t.file,t.file.name),a.append("anexotipo",t.tipo),a.append("solpedID",o),this.comprasService.uploadAnexo(this.authService.getToken(),a).subscribe({next:i=>{this.anexosSolped.push({tipo:t.tipo,file:t.file,url:i.ruta,idanexo:i.idanexo}),this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:i.message})},error:i=>{console.log(i),this.messageService.add({severity:"error",summary:"!Error\xa1",detail:i})}})}AdicionarAnexo(){this.formularioAnexo=!0;let o=[];if(this.anexosSolped.length>0){for(let t of this.tiposanexo)"Otro"!=t.name?0==this.anexosSolped.filter(a=>a.tipo==t.name).length&&o.push({name:t.name}):o.push({name:t.name});this.tiposanexo=o}}BorrarAnexo(){let o=[],t=!1;for(let a of this.anexosSolped){t=!1;for(let i of this.lineaAnexoSeleccionada)a===i&&(t=!0);t||o.push(a)}if(this.anexosSolped=o,this.solpedEditar)for(let a of this.lineaAnexoSeleccionada){let i={ruta:a.url,name:a.file.name,tipo:a.tipo,idsolped:this.infoSolpedEditar.solped.id,idanexo:a.idanexo};this.comprasService.borrarAnexo(this.authService.getToken(),i).subscribe({next:r=>{this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:r.message})},error:r=>{console.log(r),this.messageService.add({severity:"error",summary:"!Error",detail:r})}})}}seleccionarTipoAnexo(){}loadFiles(){let o;for(let t of this.anexosSolped)o=new FormData,o.append("myFile",t.file,t.file.name),o.append("anexotipo",t.tipo),this.comprasService.uploadAnexo(this.authService.getToken(),o).subscribe({next:a=>{},error:a=>{console.log(a)}})}onLoad(o){const[t]=o.currentFiles;this.fileTmp={fileRaw:t,fileName:t.name}}consultarAnexo(o){let t=this.comprasService.downloadAnexo(o);window.open(t,"blank")}AdicionarLinea(){this.nuevaLinea=!0,this.clase&&this.serie&&this.area&&this.fechaContable&&this.fechaCaducidad&&this.fechaDocumento&&this.fechaNecesidad?(this.resetearFormularioLinea(),this.numeroLinea=this.iteradorLinea,this.MostrarFormularioLinea()):this.messageService.add({severity:"error",summary:"!Opps",detail:"Debe diligenciar los campos resaltados en rojo"})}MostrarFormularioLinea(){this.formularioLinea=!0,this.nuevaLinea=!1,this.viceprecidencia=this.vicepresidencias.filter(o=>"VPCADSUM"==o.vicepresidency)[0],this.SeleccionarVicepresidencia(),this.dependencia=this.dependencias.filter(o=>"VPCADSU2"==o.dependence)[0],this.SeleccionarDependencia()}MostrarDetalle(){this.listadoLineas=!0,this.calculatTotales()}GuardarSolped(){if(this.envioFormulario=!0,this.clase&&this.serie&&this.area&&this.fechaContable&&this.fechaCaducidad&&this.fechaDocumento&&this.fechaNecesidad)if(this.lineasSolped.length>0){this.loadingSave=!0;const o={solped:{id_user:this.infoUsuario.id,usersap:this.infoUsuario.codusersap,fullname:this.infoUsuario.fullname,serie:this.serie,doctype:this.clase,docdate:this.fechaContable,docduedate:this.fechaCaducidad,taxdate:this.fechaDocumento,reqdate:this.fechaNecesidad,sapdocnum:this.solpedEditar?this.infoSolpedEditar.solped.sapdocnum:"0",u_nf_depen_solped:this.area,comments:this.comentarios,trm:this.trm,currency:this.currency,nf_lastshippping:this.nf_lastshippping,nf_dateofshipping:this.nf_dateofshipping,nf_agente:this.nf_agente,nf_pago:this.nf_pago,nf_tipocarga:this.nf_tipocarga,nf_puertosalida:this.nf_puertosalida,nf_motonave:this.nf_motonave,u_nf_status:this.solpedEditar?this.u_nf_status:"Proyectado",nf_pedmp:this.nf_pedmp,nf_Incoterms:this.nf_Incoterms},solpedDet:this.lineasSolped};this.solpedEditar&&(o.solped.approved=this.infoSolpedEditar.solped.approved,o.solped.id=this.solpedEditar),this.onNewSolped.emit(o),this.registroSolped=!0,this.envioFormulario=!1}else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar al menos una l\xednea en la solped"});else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar los campos resaltados en rojo"})}NuevaSolped(){}RegistrarLinea(){if(this.envioLinea=!0,this.descripcion&&this.fechaRequerida&&this.cantidad&&this.almacen&&(this.cuenta.Code&&!this.item.ItemCode||!this.cuenta.Code&&this.item.ItemCode)){let o=this.LineaDuplicada();o>=0&&this.lineasSolped[o].linenum!==this.numeroLinea?this.messageService.add({severity:"warn",summary:"!Atenci\xf3n",detail:`Los siguientes datos item: ${this.item.ItemCode}, \n                                            Vicepresidencia: ${this.viceprecidencia.vicepresidency}, \n                                            Dependencia: ${this.dependencia.dependence} y \n                                            localidad: ${this.localidad.location} \n                                            ya se encuentran registrados en la \n                                            linea ${this.lineasSolped[o].linenum} de esta solped`}):(this.editarLinea?(this.asignarCamposLinea(this.lineaSeleccionada[0].linenum),this.lineasSolped.splice(this.lineasSolped.indexOf(this.lineaSeleccionada[0]),1,this.lineaSolped),this.messageService.add({severity:"success",summary:"!OK\xa1",detail:"Se realizo correctamente la actualizaci\xf3n de la l\xednea"}),this.editarLinea=!1):(this.asignarCamposLinea(this.numeroLinea),this.lineasSolped.push(this.lineaSolped),this.iteradorLinea++,this.messageService.add({severity:"success",summary:"!OK\xa1",detail:"Se realizo correctamente el registro de la l\xednea"})),this.formularioLinea=!1,this.calculatTotales(),this.resetearFormularioLinea(),this.envioLinea=!1)}else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar los campos resaltados en rojo"})}asignarCamposLinea(o){this.lineaSolped={id_solped:this.solpedEditar?this.solpedEditar:0,linenum:o,id_user:this.infoUsuario.id,reqdatedet:this.fechaRequerida,linevendor:this.proveedor.CardCode,itemcode:this.item.ItemCode,dscription:this.descripcion,ocrcode3:this.viceprecidencia.vicepresidency,ocrcode2:this.dependencia.dependence,ocrcode:this.localidad.location,whscode:""!=this.almacen?this.almacen.store:"SM_N300",acctcode:this.cuenta.Code,acctcodename:this.nombreCuenta,quantity:this.cantidad,moneda:this.moneda,price:this.precio,trm:this.trm,linetotal:this.subtotalLinea,tax:this.impuesto.Code,taxvalor:this.valorImpuesto,linegtotal:this.totalLinea,unidad:this.unidad,zonacode:this.zonacode}}LineaDuplicada(){let o=this.lineasSolped.filter(t=>t.itemcode===this.item.ItemCode&&t.dscription===this.descripcion&&t.ocrcode===this.localidad.location&&t.ocrcode2===this.dependencia.dependence&&t.ocrcode3===this.viceprecidencia.vicepresidency);return this.lineasSolped.indexOf(o[0])}EditarLinea(){this.lineaSolped=this.lineaSeleccionada[0],this.editarLinea=!0,this.MostrarFormularioLinea(),this.numeroLinea=this.lineaSolped.linenum,this.lineaSolped.itemcode&&(this.item=this.items.filter(o=>o.ItemCode===this.lineaSolped.itemcode)[0]),this.descripcion=this.lineaSolped.dscription,this.lineaSolped.linevendor&&(this.proveedor=this.proveedores.filter(o=>o.CardCode===this.lineaSolped.linevendor)[0]),this.lineaSolped.acctcode&&(this.cuenta=this.cuentas.filter(o=>o.Code===this.lineaSolped.acctcode)[0]),this.lineaSolped.ocrcode3&&(this.viceprecidencia=this.vicepresidencias.filter(o=>o.vicepresidency===this.lineaSolped.ocrcode3)[0],this.SeleccionarVicepresidencia()),this.lineaSolped.ocrcode2&&(this.dependencia=this.dependencias.filter(o=>o.dependence===this.lineaSolped.ocrcode2)[0],this.SeleccionarDependencia()),this.lineaSolped.ocrcode&&(this.localidad=this.localidades.filter(o=>o.location===this.lineaSolped.ocrcode)[0]),this.lineaSolped.whscode&&(this.almacenes.filter(o=>o.store===this.lineaSolped.whscode).length>0?(this.almacen=this.almacenes.filter(o=>o.store===this.lineaSolped.whscode)[0],this.zonacode=this.almacen.zonacode,console.log(this.zonacode)):this.almacen=""),this.lineaSolped.tax&&(this.impuesto=this.impuestos.filter(o=>o.Code===this.lineaSolped.tax)[0]),this.lineaSolped.acctcode&&(this.cuenta=this.cuentas.filter(o=>o.Code===this.lineaSolped.acctcode)[0],this.nombreCuenta=this.cuenta.Name),this.cantidad=this.lineaSolped.quantity||1,console.log(this.monedas,this.lineaSolped.moneda),this.moneda=this.monedas.filter(o=>o.Currency===this.lineaSolped.moneda).length>0?this.monedas.filter(o=>o.Currency===this.lineaSolped.moneda)[0].Currency:"COP",this.precio=this.lineaSolped.price||0,this.subtotalLinea=this.lineaSolped.linetotal,this.prcImpuesto=isNaN(100*(this.lineaSolped.linegtotal/this.lineaSolped.linetotal-1))?0:100*(this.lineaSolped.linegtotal/this.lineaSolped.linetotal-1),this.valorImpuesto=this.lineaSolped.linegtotal*(this.prcImpuesto/100),this.totalLinea=this.lineaSolped.linegtotal}BorrarLineas(){let o=[],t=!1;for(let a of this.lineasSolped){t=!1;for(let i of this.lineaSeleccionada)a===i&&(t=!0);t||o.push(a)}this.lineasSolped=o}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}}N.\u0275fac=function(o){return new(o||N)(e.Y36(T.e),e.Y36(Z.c),e.Y36(y.K),e.Y36(f.F0),e.Y36(d.ez),e.Y36(f.gz))},N.\u0275cmp=e.Xpm({type:N,selectors:[["app-form-solped-mp"]],viewQuery:function(o,t){if(1&o&&e.Gf(me,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},inputs:{solpedEditar:"solpedEditar",registroSolped:"registroSolped"},outputs:{onNewSolped:"onNewSolped"},features:[e._Bn([d.ez])],decls:119,vars:115,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12"],[1,"card","p-fluid"],[1,"col"],[1,"field"],["htmlFor","nombreusuario"],["pInputText","","id","nombreusuario","name","nombreusuario","type","text","required","","readonly","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["htmlFor","area"],["optionLabel","area","optionValue","area","id","area","name","area","placeholder","Area","styleClass","p-dropdown-sm ",3,"options","ngModel","required","readonly","ngClass","ngModelChange","onChange"],["htmlFor","nf_pedmp"],["optionLabel","option","optionValue","value","id","nf_pedmp","name","nf_pedmp","styleClass","p-dropdown-sm ",3,"options","ngModel","required","ngClass","ngModelChange"],["htmlFor","nf_agente"],["pInputText","","id","nf_agente","name","nf_agente","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["htmlFor","nf_pago"],["pInputText","","id","nf_pago","name","nf_pago","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],[1,"flex"],["htmlFor","serie"],["optionLabel","name","optionValue","code","id","serie","name","serie","placeholder","Tipo","styleClass","w-full p-dropdown-sm p-inputtext-sm",3,"options","ngModel","readonly","required","ngClass","ngModelChange","onChange"],["htmlFor","codigoSap"],["pInputText","","id","codigoSap","name","codigoSap","styleClass","w-full ","type","text","required","","readonly","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["for","fechaContable"],["inputId","fechaContable","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","readonlyInput","ngClass","ngModelChange","onSelect"],["for","nf_lastshippping"],["inputId","nf_lastshippping","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","nf_dateofshipping"],["inputId","nf_dateofshipping","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","fechaNecesidad"],["inputId","fechaNecesidad","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["htmlFor","nf_tipocarga"],["optionLabel","tipo","optionValue","tipo","id","nf_tipocarga","name","nf_tipocarga","placeholder","Tipo de carga","styleClass","p-dropdown-sm ",3,"options","ngModel","required","ngModelChange"],["htmlFor","nf_puertosalida"],["pInputText","","id","nf_puertosalida","name","nf_puertosalida","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["htmlFor","nf_motonave"],["pInputText","","id","nf_motonave","name","nf_motonave","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["htmlFor","comentarios"],["rows","3","pInputTextarea","","id","comments",1,"w-full",3,"ngModel","ngModelChange"],["class","field col",4,"ngIf"],[1,"grid","align-content-center"],[1,"field","col"],["pButton","","label","Nueva L\xednea","icon","pi pi-list",1,"p-button-outlined","mb-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","label","Guardar","icon","pi pi-save",1,"p-button-outlined","mb-2","p-button-success","p-button-sm",3,"disabled","click"],["pButton","","label","Nueva solped","icon","pi pi-list",1,"p-button-outlined","mb-2","p-button-primary","p-button-sm",3,"disabled","click"],[3,"header","visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["pTemplate","content"],["pTemplate","footer"],["header","Detalle de la solicitud de pedido",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","linenum","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["header","Anexos de la solicitud de pedido",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","file.name","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["header","Cargar anexo",3,"visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["mode","indeterminate"],["label","Ver Detalle","icon","pi pi-search","styleClass","p-button-outlined mb-2 p-button-secondary p-button-sm","badgeClass","p-badge-danger",3,"disabled","badge","onClick"],["for","fechaRequerida"],["inputId","fechaRequerida","styleClass","w-full",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","proveedor"],["field","CardCode","panelStyleClass","text-sm sm:ml-2","inputStyleClass","w-full","styleClass","w-full","inputId","proveedor2",3,"ngModel","showEmptyMessage","suggestions","minLength","delay","ngModelChange","completeMethod","onSelect"],["pTemplate","item"],["for","itemCode"],["field","ItemCode","inputStyleClass","w-full","styleClass","w-full","inputId","itemCode","panelStyleClass","text-sm sm:ml-2",3,"ngModel","showEmptyMessage","suggestions","minLength","delay","showClear","autofocus","disabled","ngClass","ngModelChange","completeMethod","onSelect","onClear"],["for","descripcion"],["pInputText","","id","descripcion","name","descripcion","type","text","required","",1,"w-full",3,"ngModel","ngClass","ngModelChange"],["for","viceprecidencia"],["optionLabel","vicepresidency","filterBy","vicepresidency","placeholder","Seleccione una vicepresidencia","styleClass","w-full","inputId","viceprecidencia",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode3",""],["pTemplate","selectedItem"],["for","dependencia"],["optionLabel","dependence","placeholder","Seleccione una dependencia","filterBy","dependence","styleClass","w-full","inputId","dependencia",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode2",""],["for","localidad"],["optionLabel","location","placeholder","Seleccione una localidad","filterBy","location","styleClass","w-full","inputId","localidad",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode",""],["for","almacen"],["optionLabel","storename","placeholder","Seleccione una almacen","filterBy","storename","styleClass","w-full","inputId","almacen",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["for","cantidad"],["pInputText","","type","number","id","cantidad","placeholder","Cantidad","required","",1,"w-full",3,"ngModel","ngClass","ngModelChange","change"],["for","precio"],["optionLabel","Currency","optionValue","Currency","id","moneda","name","moneda",3,"options","ngModel","required","readonly","ngModelChange","onChange"],["inputId","precio","mode","currency","currency","COP","locale","es-CO","placeholder","Precio","styleClass","w-full",3,"ngModel","ngStyle","ngModelChange"],["for","subtotalLinea"],["inputId","subtotalLinea","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",3,"ngModel","ngStyle","readonly","ngModelChange"],["for","impuesto"],["optionLabel","Code","placeholder","Seleccione un impuesto","filterBy","Code","styleClass","w-full","inputId","impuesto",1,"w-full",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["suffix","%","inputStyleClass","text-center w-6","styleClass","text-center",3,"ngModel","readonly","disabled","ngModelChange"],["for","valorImpuesto"],["inputId","valorImpuesto","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",1,"w-full",3,"ngModel","ngStyle","readonly","disabled","ngModelChange"],["for","totalLinea"],["inputId","totalLinea","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",1,"w-full",3,"ngModel","disabled","readonly","ngModelChange"],["class","country-item country-item-value",4,"ngIf"],[1,"country-item","country-item-value"],[1,"country-item"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"disabled","click"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","label","Limpiar","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["pButton","","label","Nueva L\xednea","icon","pi pi-list",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","icon","pi pi-pencil",1,"p-button-outlined","mb-2","mr-2","p-button-secondary","p-button-sm",3,"label","disabled","click"],["pButton","","label","Borrar linea","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar por palabra clave",1,"w-full","p-inputtext-sm",3,"input"],["filter",""],[2,"width","3rem"],[1,"flex","justify-content-between","align-items-center"],["type","text","field","linenum","display","menu","placeholder","Buscar por linea detalle"],["type","text","field","itemcode","display","menu","placeholder","Buscar por c\xf3digo item"],["type","text","field","dscription","display","menu","placeholder","Buscar por descripci\xf3n"],["type","text","field","linevendor","display","menu","placeholder","Buscar por proveedor"],["type","text","field","acctcode","display","menu","placeholder","Buscar por cuenta"],["type","text","field","ocrcode3","display","menu","placeholder","Buscar por vicepresidencia"],["type","text","field","orecode2","display","menu","placeholder","Buscar por dependencia"],["type","text","field","location","display","menu","placeholder","Buscar por localidad"],[3,"value","onClick"],[2,"min-width","12rem"],["colspan","13",1,"text-right"],["colspan","16",1,"text-center"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"click"],["pButton","","label","Nuevo anexo","icon","pi pi-list",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","label","Borrar anexo","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],["type","text","field","tipo","display","menu","placeholder","Buscar por tipo anexo"],["type","text","field","nombre","display","menu","placeholder","Buscar por nombre"],["style","width: 1rem",4,"ngIf"],[2,"width","1rem"],[3,"value"],["style","min-width: 1rem;","class","flex justify-content-center flex-wrap",4,"ngIf"],[1,"flex","justify-content-center","flex-wrap",2,"min-width","1rem"],["icon","pi pi-download","label","","pTooltip","Descargar",1,"w-full",3,"click"],["for","tipoanexo"],["optionLabel","name","filterBy","name","placeholder","Seleccione el tipo del anexo","styleClass","w-full","inputId","tipoanexo",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["name","demo[]","chooseLabel","Seleccionar","cancelLabel","Cancelar","styleClass","w-full",1,"w-full",3,"multiple","showUploadButton","maxFileSize","ngClass","disabled","onSelect"],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast")(1,"app-breadcrumb",0),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",1)(6,"div",4)(7,"div",5)(8,"label",6),e._uU(9,"Nombre Solicitante"),e.qZA(),e.TgZ(10,"input",7),e.NdJ("ngModelChange",function(i){return t.infoUsuario.fullname=i}),e.qZA()(),e.TgZ(11,"div",5)(12,"label",8),e._uU(13,"Area"),e.qZA(),e.TgZ(14,"p-dropdown",9),e.NdJ("ngModelChange",function(i){return t.area=i})("onChange",function(){return t.SeleccionarArea()}),e.qZA()(),e.TgZ(15,"div",5)(16,"label",10),e._uU(17," Materia prima importada"),e.qZA(),e.TgZ(18,"p-dropdown",11),e.NdJ("ngModelChange",function(i){return t.nf_pedmp=i}),e.qZA()(),e.TgZ(19,"div",5)(20,"label",12),e._uU(21,"Agente"),e.qZA(),e.TgZ(22,"input",13),e.NdJ("ngModelChange",function(i){return t.nf_agente=i}),e.qZA()(),e.TgZ(23,"div",5)(24,"label",14),e._uU(25,"Tipo pago"),e.qZA(),e.TgZ(26,"input",15),e.NdJ("ngModelChange",function(i){return t.nf_pago=i}),e.qZA()(),e.TgZ(27,"div",5)(28,"label",14),e._uU(29,"Incoterms"),e.qZA(),e.TgZ(30,"input",15),e.NdJ("ngModelChange",function(i){return t.nf_Incoterms=i}),e.qZA()()(),e.TgZ(31,"div",4)(32,"div",16)(33,"div",5)(34,"label",17),e._uU(35,"Tipo"),e.qZA(),e.TgZ(36,"p-dropdown",18),e.NdJ("ngModelChange",function(i){return t.serie=i})("onChange",function(){return t.SeleccionarSerie()}),e.qZA()(),e.TgZ(37,"div",5)(38,"label",19),e._uU(39,"Codigo SAP"),e.qZA(),e.TgZ(40,"input",20),e.NdJ("ngModelChange",function(i){return t.codigoSap=i}),e.qZA()()(),e.TgZ(41,"div",16)(42,"div",5)(43,"label",21),e._uU(44,"Fecha Documento"),e.qZA(),e.TgZ(45,"p-calendar",22),e.NdJ("ngModelChange",function(i){return t.fechaContable=i})("onSelect",function(){return t.SeleccionarFechaContable()}),e.qZA()(),e.TgZ(46,"div",5)(47,"label",23),e._uU(48,"Fecha Cargue (LDS)"),e.qZA(),e.TgZ(49,"p-calendar",24),e.NdJ("ngModelChange",function(i){return t.nf_lastshippping=i}),e.qZA()()(),e.TgZ(50,"div",16)(51,"div",5)(52,"label",25),e._uU(53,"Fecha Salida (ETS)"),e.qZA(),e.TgZ(54,"p-calendar",26),e.NdJ("ngModelChange",function(i){return t.nf_dateofshipping=i}),e.qZA()(),e.TgZ(55,"div",5)(56,"label",27),e._uU(57,"Fecha Llegada (ETA)"),e.qZA(),e.TgZ(58,"p-calendar",28),e.NdJ("ngModelChange",function(i){return t.fechaNecesidad=i}),e.qZA()()(),e.TgZ(59,"div",5)(60,"label",29),e._uU(61,"Tipo carga"),e.qZA(),e.TgZ(62,"p-dropdown",30),e.NdJ("ngModelChange",function(i){return t.nf_tipocarga=i}),e.qZA()(),e.TgZ(63,"div",5)(64,"label",31),e._uU(65,"Puerto salida"),e.qZA(),e.TgZ(66,"input",32),e.NdJ("ngModelChange",function(i){return t.nf_puertosalida=i}),e.qZA()(),e.TgZ(67,"div",5)(68,"label",33),e._uU(69,"Motonave"),e.qZA(),e.TgZ(70,"input",34),e.NdJ("ngModelChange",function(i){return t.nf_motonave=i}),e.qZA()()()(),e.TgZ(71,"div",1)(72,"div",4)(73,"div",5)(74,"label",35),e._uU(75,"Comentarios"),e.qZA(),e.TgZ(76,"textarea",36),e.NdJ("ngModelChange",function(i){return t.comentarios=i}),e._uU(77,"                        "),e.qZA()()()(),e._UZ(78,"p-divider"),e.YNc(79,he,2,3,"div",37),e.TgZ(80,"div",1)(81,"div",4)(82,"div",38)(83,"div",39)(84,"button",40),e.NdJ("click",function(){return t.AdicionarLinea()}),e.qZA()(),e.YNc(85,ge,2,2,"div",37),e.qZA()()()()()(),e.TgZ(86,"div",1)(87,"div",2)(88,"div",3)(89,"div",1)(90,"div",4)(91,"button",41),e.NdJ("click",function(){return t.GuardarSolped()}),e.qZA()(),e.TgZ(92,"div",4)(93,"button",42),e.NdJ("click",function(){return t.NuevaSolped()}),e.qZA()()()()()(),e.TgZ(94,"p-dialog",43),e.NdJ("visibleChange",function(i){return t.formularioLinea=i})("onHide",function(){return t.envioLinea=!1}),e.YNc(95,Ee,81,87,"ng-template",44),e.YNc(96,Je,1,1,"ng-template",45),e.qZA(),e.TgZ(97,"p-dialog",46),e.NdJ("visibleChange",function(i){return t.listadoLineas=i}),e.TgZ(98,"p-table",47,48),e.NdJ("selectionChange",function(i){return t.lineaSeleccionada=i}),e.YNc(100,Ie,10,4,"ng-template",49),e.YNc(101,Le,55,0,"ng-template",50),e.YNc(102,ke,39,33,"ng-template",51),e.YNc(103,De,12,12,"ng-template",45),e.YNc(104,Oe,3,0,"ng-template",52),e.YNc(105,ze,3,0,"ng-template",53),e.qZA(),e.YNc(106,Qe,1,0,"ng-template",45),e.qZA(),e.TgZ(107,"p-dialog",54),e.NdJ("visibleChange",function(i){return t.listadoAnexos=i}),e.TgZ(108,"p-table",55,48),e.NdJ("selectionChange",function(i){return t.lineaAnexoSeleccionada=i}),e.YNc(110,Re,9,2,"ng-template",49),e.YNc(111,Be,14,1,"ng-template",50),e.YNc(112,Ye,10,5,"ng-template",51),e.YNc(113,He,3,0,"ng-template",52),e.YNc(114,je,3,0,"ng-template",53),e.qZA(),e.YNc(115,$e,1,0,"ng-template",45),e.qZA(),e.TgZ(116,"p-dialog",56),e.NdJ("visibleChange",function(i){return t.formularioAnexo=i})("onHide",function(){return t.envioLinea=!1}),e.YNc(117,it,12,14,"ng-template",44),e.YNc(118,at,1,1,"ng-template",45),e.qZA()),2&o&&(e.xp6(1),e.Q6J("urlBreadCrumb",t.urlBreadCrumb),e.xp6(9),e.Q6J("ngModel",t.infoUsuario.fullname),e.xp6(4),e.Q6J("options",t.areas)("ngModel",t.area)("required",!0)("readonly",t.lineasSolped.length>0)("ngClass",e.VKq(93,b,t.envioFormulario&&!t.area||t.nuevaLinea&&!t.area)),e.xp6(4),e.Q6J("options",t.materiaprima)("ngModel",t.nf_pedmp)("required",!0)("ngClass",e.VKq(95,b,t.envioFormulario&&!t.nf_pedmp||t.nuevaLinea&&!t.nf_pedmp)),e.xp6(4),e.Q6J("ngModel",t.nf_agente),e.xp6(4),e.Q6J("ngModel",t.nf_pago),e.xp6(4),e.Q6J("ngModel",t.nf_Incoterms),e.xp6(6),e.Q6J("options",t.series)("ngModel",t.serie)("readonly",t.lineasSolped.length>0)("required",!0)("ngClass",e.VKq(97,b,t.envioFormulario&&!t.serie||t.nuevaLinea&&!t.serie)),e.xp6(4),e.Q6J("ngModel",t.codigoSap),e.xp6(5),e.Q6J("ngModel",t.fechaContable)("showIcon",!0)("required",!0)("readonlyInput",!0)("ngClass",e.VKq(99,b,t.envioFormulario&&!t.fechaContable||t.nuevaLinea&&!t.fechaContable)),e.xp6(4),e.Q6J("ngModel",t.nf_lastshippping)("showIcon",!0)("required",!0)("ngClass",e.VKq(101,b,t.envioFormulario&&!t.nf_lastshippping||t.nuevaLinea&&!t.nf_lastshippping)),e.xp6(5),e.Q6J("ngModel",t.nf_dateofshipping)("showIcon",!0)("required",!0)("ngClass",e.VKq(103,b,t.envioFormulario&&!t.nf_dateofshipping||t.nuevaLinea&&!t.nf_dateofshipping)),e.xp6(4),e.Q6J("ngModel",t.fechaNecesidad)("showIcon",!0)("required",!0)("ngClass",e.VKq(105,b,t.envioFormulario&&!t.fechaNecesidad||t.nuevaLinea&&!t.fechaNecesidad)),e.xp6(4),e.Q6J("options",t.tiposdecarga)("ngModel",t.nf_tipocarga)("required",!0),e.xp6(4),e.Q6J("ngModel",t.nf_puertosalida),e.xp6(4),e.Q6J("ngModel",t.nf_motonave),e.xp6(6),e.Q6J("ngModel",t.comentarios),e.xp6(3),e.Q6J("ngIf",!0===t.loadingSave),e.xp6(5),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("ngIf",t.lineasSolped.length>0),e.xp6(6),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||t.registroSolped),e.xp6(2),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.envioFormulario),e.xp6(1),e.Akn(e.DdM(107,j)),e.Q6J("header",t.editarLinea?"Editar l\xednea":"Adicionar L\xednea")("visible",t.formularioLinea)("modal",!0)("breakpoints",e.DdM(108,ce))("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(3),e.Akn(e.DdM(109,j)),e.Q6J("visible",t.listadoLineas)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(1),e.Q6J("value",t.lineasSolped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(110,nt))("selection",t.lineaSeleccionada),e.xp6(9),e.Akn(e.DdM(111,j)),e.Q6J("visible",t.listadoAnexos)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(1),e.Q6J("value",t.anexosSolped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(112,rt))("selection",t.lineaAnexoSeleccionada),e.xp6(8),e.Akn(e.DdM(113,j)),e.Q6J("visible",t.formularioAnexo)("modal",!0)("breakpoints",e.DdM(114,ce))("maximizable",!0)("draggable",!1)("resizable",!1))},dependencies:[m.mk,m.sg,m.O5,m.PC,_.Fj,_.wV,_.JJ,_.Q7,_.On,le.Qc,d.jx,v.Hq,v.zx,M.u,W.f,E.V,se.i,U.Lt,de.p,H.k,pe.Rn,J.g,I.o,S.iA,S.UA,S.xl,x.FN,L.L,m.Zx,m.H9,m.uU],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]});class k{constructor(o,t,a,i,r){this.rutaActiva=o,this.messageService=t,this.authService=a,this.router=i,this.comprasService=r}ngOnInit(){this.solpedSeleccionada=this.rutaActiva.snapshot.params}actualizarSolped(o){this.comprasService.updateSolpedMP(this.authService.getToken(),o).subscribe({next:t=>{501===t.status?this.messageService.add({severity:"error",summary:"!Error",detail:JSON.stringify(t.err)}):(console.log(o.solped.approved),"A"==o.solped.approved?this.comprasService.actualizarSolpedSAP(this.authService.getToken(),o).subscribe({next:a=>{this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:a.message}),setTimeout(()=>{this.router.navigate(["portal/compras/solped/tracking"])},2e3)},error:a=>{console.log(a)}}):(this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:t.message}),setTimeout(()=>{this.router.navigate(["portal/compras/solped/tracking"])},2e3)))},error:t=>{console.log(t)}})}}k.\u0275fac=function(o){return new(o||k)(e.Y36(f.gz),e.Y36(d.ez),e.Y36(T.e),e.Y36(f.F0),e.Y36(y.K))},k.\u0275cmp=e.Xpm({type:k,selectors:[["app-edit-solped-mp"]],features:[e._Bn([d.ez])],decls:2,vars:1,consts:[[3,"solpedEditar","onNewSolped"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast"),e.TgZ(1,"app-form-solped-mp",0),e.NdJ("onNewSolped",function(i){return t.actualizarSolped(i)}),e.qZA()),2&o&&(e.xp6(1),e.Q6J("solpedEditar",t.solpedSeleccionada.solped))},dependencies:[x.FN,N]});const lt=["filter"];function st(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",29)(1,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.importarCSV())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)}}function dt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",29)(1,"p-button",50),e.NdJ("onClick",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.MostrarDetalle())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].read_accion)("badge",t.lineasSolped.length.toString())}}function pt(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.CardCode," - ",t.CardName,"")}}function ct(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.ItemCode," - ",t.ItemName,"")}}function ut(n,o){if(1&n&&(e.TgZ(0,"div",91)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.viceprecidencia.vicepresidency)}}function mt(n,o){if(1&n&&e.YNc(0,ut,3,1,"div",90),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.viceprecidencia)}}function _t(n,o){if(1&n&&(e.TgZ(0,"div",92)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.vicepresidency)}}function ht(n,o){if(1&n&&(e.TgZ(0,"div",91)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.dependencia.dependence)}}function gt(n,o){if(1&n&&e.YNc(0,ht,3,1,"div",90),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.dependencia)}}function ft(n,o){if(1&n&&(e.TgZ(0,"div",92)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.dependence)}}function Ct(n,o){if(1&n&&(e.TgZ(0,"div",91)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.localidad.location)}}function bt(n,o){if(1&n&&e.YNc(0,Ct,3,1,"div",90),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.localidad)}}function St(n,o){if(1&n&&(e.TgZ(0,"div",92)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.location)}}function vt(n,o){if(1&n&&(e.TgZ(0,"div",91)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.almacen.store)}}function Tt(n,o){if(1&n&&e.YNc(0,vt,3,1,"div",90),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.almacen)}}function yt(n,o){if(1&n&&(e.TgZ(0,"div",92)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.store)}}function xt(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.Code," - ",t.Name,"")}}function At(n,o){if(1&n&&(e.TgZ(0,"div",91)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.impuesto.Code)}}function Zt(n,o){if(1&n&&e.YNc(0,At,3,1,"div",90),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.impuesto)}}function Mt(n,o){if(1&n&&(e.TgZ(0,"div",92)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.AsE("",t.Code," - ",t.Name,"")}}const h=function(n){return{"ng-invalid ng-dirty":n}},te=function(){return{width:"100%"}};function Ut(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",29)(2,"label",51),e._uU(3,"Fecha necesaria"),e.qZA(),e.TgZ(4,"p-calendar",52),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.fechaRequerida=i)}),e.qZA()(),e.TgZ(5,"div",29)(6,"label",53),e._uU(7,"Proveedor"),e.qZA(),e.TgZ(8,"p-autoComplete",54),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.proveedor=i)})("completeMethod",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.filtrarProveedores(i))})("onSelect",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarProveedor())}),e.YNc(9,pt,2,2,"ng-template",55),e._uU(10,"\nCue "),e.qZA()()(),e.TgZ(11,"div",1)(12,"div",29)(13,"label",56),e._uU(14,"C\xf3digo \xedtem"),e.qZA(),e.TgZ(15,"p-autoComplete",57),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.item=i)})("completeMethod",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.filtrarItems(i))})("onSelect",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarItemCode())})("onClear",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearItemCode())}),e.YNc(16,ct,2,2,"ng-template",55),e.qZA()(),e.TgZ(17,"div",29)(18,"label",58),e._uU(19,"Descripci\xf3n"),e.qZA(),e.TgZ(20,"input",59),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.descripcion=i)}),e.qZA()()(),e.TgZ(21,"div",1)(22,"div",29)(23,"label",60),e._uU(24,"Vicepresidencia"),e.qZA(),e.TgZ(25,"p-dropdown",61,62),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.viceprecidencia=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarVicepresidencia())}),e.YNc(27,mt,1,1,"ng-template",63),e.YNc(28,_t,3,1,"ng-template",55),e.qZA()(),e.TgZ(29,"div",29)(30,"label",64),e._uU(31,"Dependencia"),e.qZA(),e.TgZ(32,"p-dropdown",65,66),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.dependencia=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarDependencia())}),e.YNc(34,gt,1,1,"ng-template",63),e.YNc(35,ft,3,1,"ng-template",55),e.qZA()(),e.TgZ(36,"div",29)(37,"label",67),e._uU(38,"Localidad"),e.qZA(),e.TgZ(39,"p-dropdown",68,69),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.localidad=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarLocalidad())}),e.YNc(41,bt,1,1,"ng-template",63),e.YNc(42,St,3,1,"ng-template",55),e.qZA()()(),e.TgZ(43,"div",1)(44,"div",29)(45,"label",70),e._uU(46,"Almacen"),e.qZA(),e.TgZ(47,"p-dropdown",71),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.almacen=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarAlmacen())}),e.YNc(48,Tt,1,1,"ng-template",63),e.YNc(49,yt,3,1,"ng-template",55),e.qZA()()(),e.TgZ(50,"div",1)(51,"div",29)(52,"label",72),e._uU(53,"Cuenta Mayor"),e.qZA(),e.TgZ(54,"p-autoComplete",73),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.cuenta=i)})("completeMethod",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.filtrarCuentas(i))})("onSelect",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarCuenta())}),e.YNc(55,xt,2,2,"ng-template",55),e.qZA()(),e.TgZ(56,"div",29)(57,"label",74),e._uU(58,"Nombre cuenta"),e.qZA(),e.TgZ(59,"input",75),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.nombreCuenta=i)}),e.qZA()()(),e.TgZ(60,"div",1)(61,"div",29)(62,"label",76),e._uU(63,"Cantidad"),e.qZA(),e.TgZ(64,"input",77),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.cantidad=i)})("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.calcularSubtotalLinea())}),e.qZA()(),e.TgZ(65,"div",29)(66,"label",78),e._uU(67,"Precio"),e.qZA(),e.TgZ(68,"div",12)(69,"p-dropdown",79),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.moneda=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarMoneda())}),e.qZA(),e.TgZ(70,"p-inputNumber",80),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.precio=i)})("ngModelChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.calcularSubtotalLinea())}),e.qZA()()(),e.TgZ(71,"div",29)(72,"label",81),e._uU(73,"Subtotal l\xednea"),e.qZA(),e.TgZ(74,"p-inputNumber",82),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.subtotalLinea=i)}),e.qZA()()(),e.TgZ(75,"div",1)(76,"div",29)(77,"label",83),e._uU(78,"Impuesto"),e.qZA(),e.TgZ(79,"div",12)(80,"p-dropdown",84),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.impuesto=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarImpuesto())}),e.YNc(81,Zt,1,1,"ng-template",63),e.YNc(82,Mt,3,2,"ng-template",55),e.qZA(),e.TgZ(83,"p-inputNumber",85),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.prcImpuesto=i)}),e.qZA()()(),e.TgZ(84,"div",29)(85,"label",86),e._uU(86,"Valor impuesto"),e.qZA(),e.TgZ(87,"p-inputNumber",87),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.valorImpuesto=i)}),e.qZA()(),e.TgZ(88,"div",29)(89,"label",88),e._uU(90,"Total linea"),e.qZA(),e.TgZ(91,"p-inputNumber",89),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.totalLinea=i)}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.fechaRequerida)("showIcon",!0)("required",!0)("ngClass",e.VKq(79,h,t.envioLinea&&!t.fechaRequerida)),e.xp6(4),e.Q6J("ngModel",t.proveedor)("showEmptyMessage",!0)("suggestions",t.proveedoresFiltrados)("minLength",1)("delay",1e3),e.xp6(7),e.Q6J("ngModel",t.item)("showEmptyMessage",!0)("suggestions",t.itemsFiltrados)("minLength",1)("delay",1e3)("showClear",!0)("autofocus",!0)("disabled","S"===t.clase)("ngClass",e.VKq(81,h,"I"===t.clase&&t.envioLinea&&!t.item.ItemCode)),e.xp6(5),e.Q6J("ngModel",t.descripcion)("ngClass",e.VKq(83,h,t.envioLinea&&!t.descripcion)),e.xp6(5),e.Q6J("options",t.vicepresidencias)("ngModel",t.viceprecidencia)("filter",!0)("showClear",!0)("ngClass",e.VKq(85,h,t.envioLinea&&!t.viceprecidencia.vicepresidency)),e.xp6(7),e.Q6J("options",t.dependencias)("ngModel",t.dependencia)("filter",!0)("showClear",!0)("ngClass",e.VKq(87,h,t.envioLinea&&!t.dependencia.dependence)),e.xp6(7),e.Q6J("options",t.localidades)("ngModel",t.localidad)("filter",!0)("showClear",!0)("ngClass",e.VKq(89,h,t.envioLinea&&!t.localidad.location)),e.xp6(8),e.Q6J("options",t.almacenes)("ngModel",t.almacen)("filter",!0)("showClear",!0),e.xp6(7),e.Q6J("ngModel",t.cuenta)("showEmptyMessage",!0)("suggestions",t.cuentasFiltradas)("minLength",1)("delay",1e3)("disabled",!t.validaCuenta)("ngClass",e.VKq(91,h,t.envioLinea&&!t.cuenta.Code&&t.validaCuenta)),e.xp6(5),e.Q6J("ngModel",t.nombreCuenta)("ngClass",e.VKq(93,h,t.envioLinea&&!t.nombreCuenta&&t.validaCuenta)),e.xp6(5),e.Q6J("ngModel",t.cantidad)("ngClass",e.VKq(95,h,t.envioLinea&&!t.cantidad)),e.xp6(5),e.Q6J("options",t.monedas)("ngModel",t.moneda)("required",!0)("readonly",t.lineasSolped.length>0),e.xp6(1),e.Q6J("ngModel",t.precio)("ngStyle",e.DdM(97,te))("ngClass",e.VKq(98,h,t.envioLinea&&!t.precio)),e.xp6(4),e.Q6J("ngModel",t.subtotalLinea)("ngStyle",e.DdM(100,te))("readonly",!0)("ngClass",e.VKq(101,h,t.envioLinea&&!t.subtotalLinea)),e.xp6(6),e.Q6J("options",t.impuestos)("ngModel",t.impuesto)("filter",!0)("showClear",!0)("ngClass",e.VKq(103,h,t.envioLinea&&!t.impuesto)),e.xp6(3),e.Q6J("ngModel",t.prcImpuesto)("readonly",!0)("disabled",!0)("ngClass",e.VKq(105,h,t.envioLinea&&!t.prcImpuesto)),e.xp6(4),e.Q6J("ngModel",t.valorImpuesto)("ngStyle",e.DdM(107,te))("readonly",!0)("disabled",!0)("ngClass",e.VKq(108,h,t.envioLinea&&!t.valorImpuesto)),e.xp6(4),e.Q6J("ngModel",t.totalLinea)("disabled",!0)("readonly",!0)("ngClass",e.VKq(110,h,t.envioLinea&&!t.totalLinea))}}function Nt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",93),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.RegistrarLinea())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion)}}function wt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",94)(1,"div")(2,"button",95),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(77);return e.KtG(i.clear(r))}),e.qZA(),e.TgZ(3,"button",96),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.AdicionarLinea())}),e.qZA(),e.TgZ(4,"button",97),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.EditarLinea())}),e.qZA(),e.TgZ(5,"button",98),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.BorrarLineas())}),e.qZA()(),e.TgZ(6,"span",99),e._UZ(7,"i",100),e.TgZ(8,"input",101,102),e.NdJ("input",function(i){e.CHM(t);const r=e.oxw(),l=e.MAs(77);return e.KtG(r.onGlobalFilter(l,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("label",t.permisosUsuarioPagina.length>0&&t.permisosUsuarioPagina[0].create_accion?"Editar L\xednea":"Consultar")("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaSeleccionada||1!=t.lineaSeleccionada.length||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaSeleccionada||0==t.lineaSeleccionada.length||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)}}function qt(n,o){1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",103),e.TgZ(2,"th")(3,"div",104),e._uU(4," L\xednea detalle "),e._UZ(5,"p-columnFilter",105),e.qZA()(),e.TgZ(6,"th")(7,"div",104),e._uU(8," C\xf3digo \xcdtem "),e._UZ(9,"p-columnFilter",106),e.qZA()(),e.TgZ(10,"th")(11,"div",104),e._uU(12," Descripci\xf3n "),e._UZ(13,"p-columnFilter",107),e.qZA()(),e.TgZ(14,"th")(15,"div",104),e._uU(16," Fecha requerida "),e.qZA()(),e.TgZ(17,"th")(18,"div",104),e._uU(19," Proveedor "),e._UZ(20,"p-columnFilter",108),e.qZA()(),e.TgZ(21,"th")(22,"div",104),e._uU(23," Cuenta Mayor "),e._UZ(24,"p-columnFilter",109),e.qZA()(),e.TgZ(25,"th")(26,"div",104),e._uU(27," Vicepresidencia "),e._UZ(28,"p-columnFilter",110),e.qZA()(),e.TgZ(29,"th")(30,"div",104),e._uU(31," Dependencia "),e._UZ(32,"p-columnFilter",111),e.qZA()(),e.TgZ(33,"th")(34,"div",104),e._uU(35," Localidad "),e._UZ(36,"p-columnFilter",112),e.qZA()(),e.TgZ(37,"th")(38,"div",104),e._uU(39," Cantidad "),e.qZA()(),e.TgZ(40,"th")(41,"div",104),e._uU(42," Precio "),e.qZA()(),e.TgZ(43,"th")(44,"div",104),e._uU(45," Impuesto "),e.qZA()(),e.TgZ(46,"th")(47,"div",104),e._uU(48," Valor Impuesto "),e.qZA()(),e.TgZ(49,"th")(50,"div",104),e._uU(51," Subtotal l\xednea "),e.qZA()(),e.TgZ(52,"th")(53,"div",104),e._uU(54," Total l\xednea "),e.qZA()()())}function Ft(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"p-tableCheckbox",113),e.NdJ("onClick",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarLinea())}),e.qZA()(),e.TgZ(3,"td",114),e._uU(4),e.qZA(),e.TgZ(5,"td",114),e._uU(6),e.qZA(),e.TgZ(7,"td",114),e._uU(8),e.qZA(),e.TgZ(9,"td",114),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td",114),e._uU(13),e.qZA(),e.TgZ(14,"td",114),e._uU(15),e.qZA(),e.TgZ(16,"td",114),e._uU(17),e.qZA(),e.TgZ(18,"td",114),e._uU(19),e.qZA(),e.TgZ(20,"td",114),e._uU(21),e.qZA(),e.TgZ(22,"td",114),e._uU(23),e.qZA(),e.TgZ(24,"td",114),e._uU(25),e.ALo(26,"currency"),e.qZA(),e.TgZ(27,"td",114),e._uU(28),e.ALo(29,"percent"),e.qZA(),e.TgZ(30,"td",114),e._uU(31),e.ALo(32,"currency"),e.qZA(),e.TgZ(33,"td",114),e._uU(34),e.ALo(35,"currency"),e.qZA(),e.TgZ(36,"td",114),e._uU(37),e.ALo(38,"currency"),e.qZA()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.linenum," "),e.xp6(2),e.hij(" ",t.itemcode," "),e.xp6(2),e.hij(" ",t.dscription," "),e.xp6(2),e.hij(" ",e.lcZ(11,17,t.reqdatedet)," "),e.xp6(3),e.hij(" ",t.linevendor," "),e.xp6(2),e.hij(" ",t.acctcode," "),e.xp6(2),e.hij(" ",t.ocrcode3," "),e.xp6(2),e.hij(" ",t.ocrcode2," "),e.xp6(2),e.hij(" ",t.ocrcode," "),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",e.xi3(26,19,t.price,t.moneda)," "),e.xp6(3),e.AsE(" ",t.tax," ",e.lcZ(29,22,t.linegtotal/t.linetotal-1)," "),e.xp6(3),e.hij(" ",e.xi3(32,24,t.taxvalor,"COP")," "),e.xp6(3),e.hij(" ",e.xi3(35,27,t.linetotal,"COP")," "),e.xp6(3),e.hij(" ",e.xi3(38,30,t.linegtotal,"COP")," ")}}function Pt(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",115),e._uU(2,"Total"),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"currency"),e.qZA()()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(e.xi3(5,3,t.totalimpuestos,"COP")),e.xp6(3),e.Oqu(e.xi3(8,6,t.subtotal,"COP")),e.xp6(3),e.Oqu(e.xi3(11,9,t.grantotal,"COP"))}}function Et(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",116),e._uU(2,"No se econtraron lineas asociadas a la solped."),e.qZA()())}function Jt(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",116),e._uU(2,"Cargando solicitudes de pedido. Por favor espere"),e.qZA()())}function It(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",117),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.listadoLineas=!1)}),e.qZA()}}function Lt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",94)(1,"div")(2,"button",95),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(77);return e.KtG(i.clear(r))}),e.qZA(),e.TgZ(3,"button",118),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.AdicionarAnexo())}),e.qZA(),e.TgZ(4,"button",119),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.BorrarAnexo())}),e.qZA()(),e.TgZ(5,"span",99),e._UZ(6,"i",100),e.TgZ(7,"input",101,102),e.NdJ("input",function(i){e.CHM(t);const r=e.oxw(),l=e.MAs(77);return e.KtG(r.onGlobalFilter(l,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaAnexoSeleccionada||0==t.lineaAnexoSeleccionada.length||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)}}function kt(n,o){1&n&&(e.TgZ(0,"th",123),e._UZ(1,"div",104),e.qZA())}function Dt(n,o){if(1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",103),e.TgZ(2,"th")(3,"div",104),e._uU(4," Tipo "),e._UZ(5,"p-columnFilter",120),e.qZA()(),e.TgZ(6,"th")(7,"div",104),e._uU(8," Nombre anexo "),e._UZ(9,"p-columnFilter",121),e.qZA()(),e.TgZ(10,"th")(11,"div",104),e._uU(12," Tama\xf1o anexo "),e.qZA()(),e.YNc(13,kt,2,0,"th",122),e.qZA()),2&n){const t=e.oxw();e.xp6(13),e.Q6J("ngIf",t.solpedEditar)}}function Ot(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",126)(1,"p-button",127),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw();return e.KtG(r.consultarAnexo3(i.url))}),e.qZA()()}}function zt(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",124),e.qZA(),e.TgZ(3,"td",114),e._uU(4),e.qZA(),e.TgZ(5,"td",114),e._uU(6),e.qZA(),e.TgZ(7,"td",114),e._uU(8),e.qZA(),e.YNc(9,Ot,2,0,"td",125),e.qZA()),2&n){const t=o.$implicit,a=e.oxw();e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.tipo," "),e.xp6(2),e.hij(" ",t.file.name," "),e.xp6(2),e.hij(" ",t.file.size," "),e.xp6(1),e.Q6J("ngIf",a.solpedEditar)}}function Qt(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",116),e._uU(2,"No se econtraron anexos asociados a la solped."),e.qZA()())}function Rt(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",116),e._uU(2,"Cargando anexos asociados a la solicitud de pedido. Por favor espere"),e.qZA()())}function Kt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",117),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.listadoAnexos=!1)}),e.qZA()}}function Bt(n,o){if(1&n&&(e.TgZ(0,"div",91)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.tipoanexo.name)}}function Gt(n,o){if(1&n&&e.YNc(0,Bt,3,1,"div",90),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.tipoanexo)}}function Yt(n,o){if(1&n&&(e.TgZ(0,"div",92)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.name)}}function Ht(n,o){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.name," - ",t.size," bytes")}}function jt(n,o){if(1&n&&(e.TgZ(0,"ul"),e.YNc(1,Ht,2,2,"li",132),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.uploadedFiles)}}function $t(n,o){if(1&n&&e.YNc(0,jt,2,1,"ul",131),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.uploadedFiles.length)}}function Vt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",29)(2,"label",128),e._uU(3,"Tipo anexo"),e.qZA(),e.TgZ(4,"p-dropdown",129,62),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.tipoanexo=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.seleccionarTipoAnexo())}),e.YNc(6,Gt,1,1,"ng-template",63),e.YNc(7,Yt,3,1,"ng-template",55),e.qZA()()(),e.TgZ(8,"div",1)(9,"div",29)(10,"p-fileUpload",130),e.NdJ("onSelect",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onLoad(i))}),e.YNc(11,$t,1,1,"ng-template",35),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("options",t.tiposanexo)("ngModel",t.tipoanexo)("filter",!0)("showClear",!0)("ngClass",e.VKq(10,h,t.envioLineaanexo&&!t.tipoanexo||t.envioLineaanexo&&""==t.tipoanexo)),e.xp6(6),e.Q6J("multiple",!1)("showUploadButton",!1)("maxFileSize",5e6)("ngClass",e.VKq(12,h,t.envioLineaanexo&&!t.fileTmp||t.envioLineaanexo&&""==t.fileTmp))("disabled",!t.tipoanexo)}}function Xt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",93),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.adicionarlineaAnexo())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion)}}function Wt(n,o){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.name," - ",t.size," bytes")}}function eo(n,o){if(1&n&&(e.TgZ(0,"ul"),e.YNc(1,Wt,2,2,"li",132),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.uploadedFiles2)}}function to(n,o){if(1&n&&e.YNc(0,eo,2,1,"ul",131),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.uploadedFiles2.length)}}const oo=function(){return{height:"6px"}};function io(n,o){1&n&&(e.TgZ(0,"div",29),e._UZ(1,"p-progressBar",134),e.qZA()),2&n&&(e.xp6(1),e.Akn(e.DdM(2,oo)))}function ao(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",29)(2,"p-fileUpload",133),e.NdJ("onSelect",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onLoad2(i))}),e.YNc(3,to,1,1,"ng-template",35),e.qZA(),e.YNc(4,io,2,3,"div",28),e.TgZ(5,"div",29)(6,"p"),e._uU(7," Para diligenciar correctamente la plantilla de cargue de la solped, siga las siguentes recomendaciones: "),e.qZA(),e.TgZ(8,"p"),e._uU(9," Columna "),e.TgZ(10,"strong"),e._uU(11,"ITEM"),e.qZA(),e._uU(12,": El c\xf3digo del item debe existir en el maestro de SAP "),e.qZA(),e.TgZ(13,"p"),e._uU(14," Columna "),e.TgZ(15,"strong"),e._uU(16,"DESCITEM"),e.qZA(),e._uU(17,": Es de caracter obligatorio, el n\xfamero m\xe1ximo de caracteres es de "),e.TgZ(18,"strong"),e._uU(19,"200"),e.qZA()(),e.TgZ(20,"p"),e._uU(21," Columna "),e.TgZ(22,"strong"),e._uU(23,"FECHAREQ"),e.qZA(),e._uU(24,": Debe ser una fecha valida "),e.qZA(),e.TgZ(25,"p"),e._uU(26," Columna "),e.TgZ(27,"strong"),e._uU(28,"IDPROVEEDOR"),e.qZA(),e._uU(29,":El c\xf3digo del proveedor debe ser un codigo v\xe1lido en SAP "),e.qZA(),e.TgZ(30,"p"),e._uU(31," Columna "),e.TgZ(32,"strong"),e._uU(33,"IMPUESTO"),e.qZA(),e._uU(34,":El c\xf3digo del impuesto debe ser un codigo v\xe1lido en SAP "),e.qZA(),e.TgZ(35,"p"),e._uU(36," Columna "),e.TgZ(37,"strong"),e._uU(38,"VICEPRESIDENCIA"),e.qZA(),e._uU(39,":Es de caracter obligatorio, el c\xf3digo de la vicepresidencia debe ser un codigo v\xe1lido en SAP y permitido para el usuario creador "),e.qZA(),e.TgZ(40,"p"),e._uU(41," Columna "),e.TgZ(42,"strong"),e._uU(43,"DEPENDENCIA"),e.qZA(),e._uU(44,":Es de caracter obligatorio, el c\xf3digo de la dependencia debe ser un codigo v\xe1lido en SAP y permitido para el usuario creador "),e.qZA(),e.TgZ(45,"p"),e._uU(46," Columna "),e.TgZ(47,"strong"),e._uU(48,"LOCALIDAD"),e.qZA(),e._uU(49,":Es de caracter obligatorio, el c\xf3digo de la localidad debe ser un codigo v\xe1lido en SAP y permitido para el usuario creador "),e.qZA(),e.TgZ(50,"p"),e._uU(51," Columna "),e.TgZ(52,"strong"),e._uU(53,"ALMACEN"),e.qZA(),e._uU(54,":El c\xf3digo del almacen debe ser un codigo v\xe1lido en SAP y permitido para el usuario creador "),e.qZA(),e.TgZ(55,"p"),e._uU(56," Columna "),e.TgZ(57,"strong"),e._uU(58,"CODCUENTA"),e.qZA(),e._uU(59,":El c\xf3digo de la cuenta contable debe ser un codigo v\xe1lido en SAP y permitido para el usuario creador "),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("multiple",!1)("showUploadButton",!1)("maxFileSize",5e6)("ngClass",e.VKq(5,h,!t.fileTmp2)),e.xp6(2),e.Q6J("ngIf",t.loadingCargueCSV)}}function no(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",135),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.descargarCSV())}),e.qZA(),e.TgZ(1,"p-button",93),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.adicionarCSV())}),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.cargueValido)}}const D=function(){return{width:"50vw"}},oe=function(){return{"960px":"75vw","640px":"100vw"}},ro=function(){return["itemcode","dscription","linevendor","acctcodename","acctcode","ocrcode","ocrcode2","ocrcode3"]},lo=function(){return["tipo","file.name","created_at"]};class w{constructor(o,t,a,i,r,l){this.authService=o,this.sapService=t,this.comprasService=a,this.router=i,this.messageService=r,this.rutaActiva=l,this.onNewSolped=new e.vpe,this.perfilesUsuario=[],this.permisosUsuario=[],this.dependenciasUsuario=[],this.vicepresidencias=[],this.dependencias=[],this.localidades=[],this.series=[],this.areas=[],this.clases=[],this.proveedores=[],this.items=[],this.cuentas=[],this.almacenes=[],this.monedas=[],this.trm=0,this.impuestos=[],this.nombreusuario="",this.area="",this.clase="",this.serie="",this.serieName="",this.codigoSap="0",this.fechaContable=new Date,this.fechaCaducidad=new Date,this.fechaDocumento=new Date,this.fechaNecesidad=new Date,this.comentarios="",this.currency="COP",this.iteradorLinea=0,this.numeroLinea=-1,this.fechaRequerida=new Date,this.descripcion="",this.almacen="",this.nombreCuenta="",this.cantidad=1,this.moneda="",this.precio=0,this.subtotalLinea=0,this.impuesto="",this.prcImpuesto=0,this.valorImpuesto=0,this.totalLinea=0,this.totalimpuestos=0,this.subtotal=0,this.grantotal=0,this.lineasSolped=[],this.lineasSolpedCVS=[],this.lineaSeleccionada=[],this.anexosSolped=[],this.lineaAnexoSeleccionada=[],this.envioFormulario=!1,this.nuevaLinea=!1,this.editarLinea=!1,this.formularioLinea=!1,this.formularioAnexo=!1,this.envioLinea=!1,this.formularioCSV=!1,this.envioLineaanexo=!1,this.listadoLineas=!1,this.listadoAnexos=!1,this.uploadedFiles=[],this.uploadedFiles2=[],this.tiposanexoBk=[{name:"Revisi\xf3n presupuestal"},{name:"Especificaci\xf3n t\xe9cnica"},{name:"Otro"}],this.tiposanexo=[{name:"Revisi\xf3n presupuestal"},{name:"Especificaci\xf3n t\xe9cnica"},{name:"Otro"}],this.loading=!1,this.solpedAprobada="N",this.urlBreadCrumb="",this.validaCuenta=!0,this.proveedoresFiltrados=[],this.itemsFiltrados=[],this.cuentasFiltradas=[],this.cargueValido=!1,this.loadingCargueCSV=!1}ngOnInit(){this.getInfoUsuario(),this.getPerfilesUsuario(),this.getPermisosUsuario(),this.getPermisosUsuarioPagina(),this.getDependenciasUsuario(),this.getSeries(),this.getAreas(),this.getClases(),this.getProveedores(),this.getItems(),this.getAlmacenes(),this.getCuentas(),this.getMonedas(new Date),this.getImpuestos(),setTimeout(()=>{this.getInformacionSolped()},500),this.resetearFormularioLinea()}getInfoUsuario(){this.infoUsuario=this.authService.getInfoUsuario()}getPerfilesUsuario(){this.perfilesUsuario=this.authService.getPerfilesUsuario()}getPermisosUsuario(){this.permisosUsuario=this.authService.getPermisosUsuario()}getPermisosUsuarioPagina(){let o="";if(this.rutaActiva.snapshot.params.solped){let t=this.rutaActiva.snapshot.params;this.router.url.indexOf("/"+t.solped)>=0&&(o=this.router.url.substring(0,this.router.url.indexOf("/"+t.solped)))}else o=this.router.url;this.urlBreadCrumb=o,this.permisosUsuarioPagina=this.permisosUsuario.filter(t=>t.url===o)}getDependenciasUsuario(){this.authService.getDependeciasUsuarioXE().subscribe({next:o=>{for(let t in o)this.dependenciasUsuario.push(o[t]);for(let t of this.dependenciasUsuario)0===this.vicepresidencias.filter(a=>a.vicepresidency===t.vicepresidency).length&&this.vicepresidencias.push(t)},error:o=>{}})}getSeries(){this.sapService.seriesDocXEngineSAP(this.authService.getToken(),"1470000113").subscribe({next:o=>{for(let t in o)"SPMP"!=o[t].name&&this.series.push(o[t]);this.serie=this.series[0].code,this.serieName=this.series[0].name,this.clase="I"},error:o=>{}})}getAreas(){var o=this;return(0,C.Z)(function*(){yield o.authService.getAreasUsuarioXE().subscribe({next:t=>{for(let a in t)o.areas.push(t[a])},error:t=>{}})})()}getClases(){this.clases=[{code:"I",name:"Art\xedculo"},{code:"S",name:"Servicio"}]}getProveedores(){this.sapService.BusinessPartnersXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.proveedores.push(o[t])},error:o=>{}})}getItems(){this.sapService.itemsSolpedSAPXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.items.push(o[t])},error:o=>{}})}getCuentas(){this.sapService.CuentasSAPXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.cuentas.push(o[t])},error:o=>{}})}getAlmacenes(){this.authService.getAlmacenesUsuarioXE().subscribe({next:o=>{for(let t in o)this.almacenes.push(o[t])},error:o=>{}})}getMonedas(o){this.sapService.monedasXEngineSAP(this.authService.getToken(),o.toISOString()).subscribe({next:t=>{this.monedas=[{Currency:"COP",TRM:1}];for(let a in t)this.monedas.push(t[a]);this.setearTRMSolped("USD")},error:t=>{}})}getImpuestos(){this.comprasService.taxesXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.impuestos.push(o[t])},error:o=>{}})}getInformacionSolped(){this.solpedEditar&&this.comprasService.solpedById(this.authService.getToken(),this.solpedEditar).subscribe({next:o=>{this.infoSolpedEditar=o,this.lineasSolped=this.infoSolpedEditar.solpedDet;for(let a of this.infoSolpedEditar.anexos)this.anexosSolped.push({tipo:a.tipo,file:{name:a.nombre,size:a.size},url:a.ruta,idanexo:a.id});this.serie=this.series.filter(a=>a.code==this.infoSolpedEditar.solped.serie)[0].code,this.codigoSap=this.infoSolpedEditar.solped.sapdocnum||"0",this.clase=this.infoSolpedEditar.solped.doctype||"";let t=36e5;this.fechaContable=new Date(new Date(this.infoSolpedEditar.solped.docdate).getTime()+5*t),this.fechaCaducidad=new Date(new Date(this.infoSolpedEditar.solped.docduedate).getTime()+5*t),this.fechaDocumento=new Date(new Date(this.infoSolpedEditar.solped.taxdate).getTime()+5*t),this.fechaNecesidad=new Date(new Date(this.infoSolpedEditar.solped.reqdate).getTime()+5*t),this.comentarios=this.infoSolpedEditar.solped.comments||"",this.trm=this.infoSolpedEditar.solped.trm,this.currency=this.infoSolpedEditar.solped.currency||1===this.trm?"COP":"USD",this.iteradorLinea=this.lineasSolped[this.lineasSolped.length-1].linenum+1,this.solpedAprobada=this.infoSolpedEditar.solped.approved||"N",this.areas.length>0&&this.areas.filter(a=>a.area===this.infoSolpedEditar.solped.u_nf_depen_solped).length>0&&(this.area=this.areas.filter(a=>a.area===this.infoSolpedEditar.solped.u_nf_depen_solped)[0].area)},error:o=>{}})}SeleccionarArea(){}SeleccionarClase(){}SeleccionarSerie(){this.serieName=this.series.filter(o=>o.code===this.serie)[0].name,this.clase="SPB"==this.serieName?"I":"",this.resetearFormularioLinea()}SeleccionarFechaContable(){this.getMonedas(this.fechaContable)}SeleccionarProveedor(){}SeleccionarItemCode(){console.log(this.item),this.descripcion=this.item.ItemName,this.item.ApTaxCode&&(this.impuesto=this.impuestos.filter(o=>o.Code===this.item.ApTaxCode)[0],this.SeleccionarImpuesto()),this.cuenta={Code:"",Name:""},this.nombreCuenta="","987654321"!=this.item.Cuenta?(this.validaCuenta=!0,this.cuenta={Code:this.item.Cuenta||"",Name:this.item.Nombre_Cuenta||""},this.nombreCuenta=this.item.Nombre_Cuenta||""):this.validaCuenta=!1}SeleccionarVicepresidencia(){if(this.viceprecidencia){let o=this.dependenciasUsuario.filter(t=>t.vicepresidency===this.viceprecidencia.vicepresidency);for(let t of o)0===this.dependencias.filter(a=>a.dependence===t.dependence).length&&this.dependencias.push(t)}}SeleccionarDependencia(){if(this.dependencia){let o=this.dependenciasUsuario.filter(t=>t.dependence===this.dependencia.dependence&&t.vicepresidency===this.dependencia.vicepresidency);for(let t of o)0===this.localidades.filter(a=>a.location===t.location).length&&this.localidades.push(t);this.cuentasxDependencia()}}SeleccionarLocalidad(){}SeleccionarAlmacen(){}SeleccionarCuenta(){this.nombreCuenta=this.cuenta.Name}SeleccionarMoneda(){this.currency=this.monedas.filter(o=>o.Currency===this.moneda)[0].Currency,this.calcularSubtotalLinea()}SeleccionarImpuesto(){this.impuesto?(this.prcImpuesto=this.impuesto.tax,this.calcularImpuesto()):this.prcImpuesto=0}SeleccionarLinea(){}filtrarProveedores(o){let a,t=[],i=o.query;for(let r=0;r<this.proveedores.length;r++)a=this.proveedores[r],(a.CardCode.toLowerCase().indexOf(i.toLowerCase())>=0||a.CardName.toLowerCase().indexOf(i.toLowerCase())>=0)&&t.push(a);this.proveedoresFiltrados=t}filtrarItems(o){let t=[],a=o.query;for(let i=0;i<this.items.length;i++){let r=this.items[i];null!=r.ItemCode&&null!=r.ItemName&&(r.ItemCode.toLowerCase().indexOf(a.toLowerCase())>=0||r.ItemName.toLowerCase().indexOf(a.toLowerCase())>=0)&&t.push(r)}this.itemsFiltrados=t}clearItemCode(){}descargarPlantilla(){}cuentasxDependencia(){this.sapService.cuentasPorDependenciaXE(this.authService.getToken(),this.dependencia.dependence).subscribe({next:o=>{let t=[];for(let r in o)t.push(o[r].U_NF_CUENTA);let a,i=[];for(let r=0;r<this.cuentas.length;r++){a=this.cuentas[r];for(let l of t)0==a.Code.indexOf(l)&&i.push(a)}this.cuentasDependencia=i},error:o=>{}})}filtrarCuentas(o){let t=[],a=o.query;for(let i=0;i<this.cuentasDependencia.length;i++){let r=this.cuentasDependencia[i];null!=r.Code&&null!=r.Name&&(r.Code.toLowerCase().indexOf(a.toLowerCase())>=0||r.Name.toLowerCase().indexOf(a.toLowerCase())>=0)&&t.push(r)}this.cuentasFiltradas=t}calcularSubtotalLinea(){let o=this.monedas.filter(t=>t.Currency===this.moneda)[0].TRM;this.subtotalLinea=this.cantidad&&this.precio?this.cantidad*(this.precio*(o||0)):0,this.calcularImpuesto()}resetearFormularioLinea(){this.numeroLinea=-1,this.fechaRequerida=new Date,this.proveedor={CardCode:"",CardName:""},this.proveedoresFiltrados=[],this.item={ApTaxCode:"",ItemCode:"",ItemName:""},this.itemsFiltrados=[],this.descripcion="",this.viceprecidencia={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.dependencia={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.localidad={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.almacen="",this.cuenta={Code:"",Name:""},this.cuentasFiltradas=[],this.nombreCuenta="",this.cantidad=1,this.moneda=this.lineasSolped.length>0&&this.lineasSolped[0].moneda||"COP",this.precio=0,this.subtotalLinea=0,this.impuesto="",this.prcImpuesto=0,this.valorImpuesto=0,this.totalLinea=0,this.validaCuenta=!0}setearTRMSolped(o){this.trm=this.monedas.filter(t=>t.Currency===o).length>0?this.monedas.filter(t=>t.Currency===o)[0].TRM:0}calcularImpuesto(){this.valorImpuesto=this.impuesto.tax&&0!=this.subtotalLinea?this.subtotalLinea*(this.impuesto.tax/100):0,this.calcularTotalLinea()}calcularTotalLinea(){this.totalLinea=this.subtotalLinea+this.valorImpuesto}calculatTotales(){this.totalimpuestos=0,this.subtotal=0,this.grantotal=0;for(let o of this.lineasSolped)this.totalimpuestos+=o.taxvalor,this.subtotal+=o.linetotal,this.grantotal+=o.linegtotal}verAnexos(){this.listadoAnexos=!0}adicionarlineaAnexo(){this.envioLineaanexo=!0,this.tipoanexo&&""!=this.tipoanexo&&this.fileTmp&&""!=this.fileTmp?(this.solpedEditar?this.loadFile(this.solpedEditar,{tipo:this.tipoanexo.name,file:this.fileTmp.fileRaw,url:"#"}):this.anexosSolped.push({tipo:this.tipoanexo.name,file:this.fileTmp.fileRaw,url:"#"}),this.tipoanexo="",this.fileTmp="",this.formularioAnexo=!1):this.messageService.add({severity:"error",summary:"!Error\xa1",detail:"Debe seleccionar el tipo y el archivo a anexar a la solped"})}loadFile(o,t){let a;a=new FormData,a.append("myFile",t.file,t.file.name),a.append("anexotipo",t.tipo),a.append("solpedID",o),this.comprasService.uploadAnexo(this.authService.getToken(),a).subscribe({next:i=>{this.anexosSolped.push({tipo:t.tipo,file:t.file,url:i.ruta,idanexo:i.idanexo}),this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:i.message})},error:i=>{this.messageService.add({severity:"error",summary:"!Error\xa1",detail:i})}})}AdicionarAnexo(){this.formularioAnexo=!0;let o=[];for(let t of this.tiposanexoBk)"Otro"!=t.name?0==this.anexosSolped.filter(a=>a.tipo==t.name).length&&o.push({name:t.name}):o.push({name:t.name});this.tiposanexo=o}BorrarAnexo(){let o=[],t=!1;for(let a of this.anexosSolped){t=!1;for(let i of this.lineaAnexoSeleccionada)a===i&&(t=!0);t||o.push(a)}if(this.anexosSolped=o,this.solpedEditar)for(let a of this.lineaAnexoSeleccionada){let i={ruta:a.url,name:a.file.name,tipo:a.tipo,idsolped:this.infoSolpedEditar.solped.id,idanexo:a.idanexo};this.comprasService.borrarAnexo(this.authService.getToken(),i).subscribe({next:r=>{this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:r.message})},error:r=>{this.messageService.add({severity:"error",summary:"!Error",detail:r})}})}}seleccionarTipoAnexo(){}loadFiles(){let o;for(let t of this.anexosSolped)o=new FormData,o.append("myFile",t.file,t.file.name),o.append("anexotipo",t.tipo),this.comprasService.uploadAnexo(this.authService.getToken(),o).subscribe({next:a=>{},error:a=>{}})}onLoad(o){const[t]=o.currentFiles;this.fileTmp={fileRaw:t,fileName:t.name}}consultarAnexo(o){let t=this.comprasService.downloadAnexo(o);window.open(t,"blank")}consultarAnexo3(o){this.comprasService.downloadAnexo3(this.authService.getToken(),o).subscribe({next:t=>{},error:t=>{}})}consultarAnexo2(o){let t={ruta:o.url,name:o.file.name,tipo:o.tipo,idsolped:this.infoSolpedEditar.solped.id,idanexo:o.idanexo};this.comprasService.downloadAnexo2(this.authService.getToken(),t).subscribe({next:a=>{},error:a=>{}})}AdicionarLinea(){this.nuevaLinea=!0,this.clase&&this.serie&&this.area&&this.fechaContable&&this.fechaCaducidad&&this.fechaDocumento&&this.fechaNecesidad?(this.resetearFormularioLinea(),this.numeroLinea=this.iteradorLinea,this.MostrarFormularioLinea()):this.messageService.add({severity:"error",summary:"!Opps",detail:"Debe diligenciar los campos resaltados en rojo"})}MostrarFormularioLinea(){this.formularioLinea=!0,this.nuevaLinea=!1}MostrarDetalle(){this.listadoLineas=!0,this.calculatTotales()}importarCSV(){this.nuevaLinea=!0,this.clase&&this.serie&&this.area&&this.fechaContable&&this.fechaCaducidad&&this.fechaDocumento&&this.fechaNecesidad?this.formularioCSV=!0:this.messageService.add({severity:"error",summary:"!Opps",detail:"Debe diligenciar los campos resaltados en rojo"})}onLoad2(o){this.loadingCargueCSV=!0;const[t]=o.currentFiles;this.fileTmp2={fileRaw:t,fileName:t.name},this.readDocument(t)}readDocument(o){let t=new FileReader,a=[];t.onload=i=>{var l=t.result.split("\n");for(let c of l)a.push(this.reemplazarCaracteresEspeciales(c));this.validarArchivoDetalle(a)},t.readAsText(o)}reemplazarCaracteresEspeciales(o){return o.replace("\r","").replace("\t","")}validarArchivoDetalle(o){var t=this;return(0,C.Z)(function*(){t.validarEncabezado(o[0].split(","))?(t.cargueValido=yield t.validarContenidoCSV(o,","),console.log(t.cargueValido),t.cargueValido&&t.messageService.add({severity:"success",summary:"!Ok",detail:"El archivo cargado cumple con la estructura b\xe1sica requerida"})):t.validarEncabezado(o[0].split(";"))?(t.cargueValido=yield t.validarContenidoCSV(o,";"),t.cargueValido&&t.messageService.add({severity:"success",summary:"!Ok",detail:"El archivo cargado cumple con la estructura b\xe1sica requerida"})):t.messageService.add({severity:"error",summary:"!Error",detail:"El archivo cargado no cumple con la estructura b\xe1sica requerida"}),t.loadingCargueCSV=!1})()}validarEncabezado(o){let t=["CODITEM","DESCITEM","FECHAREQ","IDPROVEEDOR","CANTIDAD","MONEDA","PRECIO","IMPUESTO","VICEPRESIDENCIA","DEPENDENCIA","LOCALIDAD","ALMACEN","CODCUENTA"],a=!0;return o.length!=t.length?a=!1:this.encabezadosValidos(t,o)||(a=!1),a}encabezadosValidos(o,t){let a=!0;for(let i of t)if(!o.includes(i)){a=!1;break}return a}validarDependencia(o,t){var a=this;return(0,C.Z)(function*(){let i=!1;return a.viceprecidencia=a.vicepresidencias.filter(r=>r.vicepresidency===o)[0],yield a.SeleccionarVicepresidencia(),a.dependencias.filter(r=>r.dependence===t).length>0&&(i=!0),i})()}validarLocalidad(o,t){var a=this;return(0,C.Z)(function*(){let i=!1;return a.dependencia=a.dependencias.filter(r=>r.dependence===o)[0],yield a.SeleccionarDependencia(),a.localidades.filter(r=>r.location===t).length>0&&(i=!0),i})()}validarCuentaContable(o){var t=this;return(0,C.Z)(function*(){let a=!1;return t.cuentas.filter(i=>i.Code===o).length>0&&(a=!0),a})()}validarContenidoCSV(o,t){var a=this;return(0,C.Z)(function*(){let r,i=!0;a.lineasSolpedCVS=[];let c,u,l=0;for(let p=1;p<o.length;p++)r=o[p].split(t),13==r.length?("I"==a.clase&&""==r[0]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo del item de la linea ${p}, es obligatorio para solicitudes de bienes`}),i=!1):""!=r[0]&&0==a.items.filter(g=>g.ItemCode==r[0]).length?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo del item  de la linea ${p}, no existe en el listado de items de SAP`}),i=!1):""==r[1]?(a.messageService.add({severity:"error",summary:"!Error",detail:`La descripci\xf3n del articulo o servicio de la linea ${p} es obligatoria`}),i=!1):""==r[2]?(a.messageService.add({severity:"error",summary:"!Error",detail:`La fecha requerida de la linea ${p} es obligatoria`}),i=!1):""!=r[2]&&isNaN(Date.parse(r[2]))?(a.messageService.add({severity:"error",summary:"!Error",detail:`La fecha requerida de la linea ${p} no es valida`}),i=!1):""!=r[3]&&0==a.proveedores.filter(g=>g.CardCode==r[3]).length?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo del proveedor de la linea ${p}, no existe en el listado de proveedores de SAP`}),i=!1):""==r[4]?(a.messageService.add({severity:"error",summary:"!Error",detail:`La cantidad de la linea ${p} es obligatoria`}),i=!1):""!=r[4]&&isNaN(r[4])?(a.messageService.add({severity:"error",summary:"!Error",detail:`La cantidad de la linea ${p} no es un n\xfamero`}),i=!1):""!=r[5]&&0==a.monedas.filter(g=>g.Currency==r[5]).length?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la moneda de la linea ${p}, no existe en el listado de monedas de SAP ${JSON.stringify(a.monedas)}`}),i=!1):""==r[6]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El precio de la linea ${p} es obligatorio`}),i=!1):""!=r[6]&&isNaN(r[6])?(a.messageService.add({severity:"error",summary:"!Error",detail:`La precio de la linea ${p} no es un n\xfamero`}),i=!1):""==r[7]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo del impuesto de la linea ${p} es obligatorio`}),i=!1):""!=r[7]&&0==a.impuestos.filter(g=>g.Code==r[7]).length?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de impuesto de la linea ${p}, no existe en el listado de impuestos de SAP`}),i=!1):""==r[8]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la viceprecidencia de la linea ${p} es obligatorio`}),i=!1):""!=r[8]&&0==a.vicepresidencias.filter(g=>g.vicepresidency==r[8]).length?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la viceprecidencia de la linea ${p}, no existe en el listado de viceprecidencias asociadas al usuario`}),i=!1):""==r[9]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la dependencia de la linea ${p} es obligatorio`}),i=!1):""==r[9]||(yield a.validarDependencia(r[8],r[9]))?""==r[10]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la localidad de la linea ${p} es obligatorio`}),i=!1):""==r[10]||(yield a.validarLocalidad(r[9],r[10]))?""==r[12]&&"S"==a.clase?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la cuenta contable de la linea ${p} es obligatorio`}),i=!1):""==r[12]||(yield a.validarCuentaContable(r[12]))?("COP"==r[5]?(c=r[4]*r[6],u=r[4]*r[6]*(a.impuestos.filter(g=>g.Code==r[7])[0].tax/100)):(c=r[4]*r[6]*a.monedas.filter(g=>g.Currency==r[5])[0].TRM,u=r[4]*r[6]*a.monedas.filter(g=>g.Currency==r[5])[0].TRM*(a.impuestos.filter(g=>g.Code==r[7])[0].tax/100)),a.lineasSolpedCVS.push({itemcode:r[0],dscription:r[1],reqdatedet:r[2],linevendor:r[3],quantity:r[4],moneda:r[5],price:r[6],tax:r[7],ocrcode3:r[8],ocrcode2:r[9],ocrcode:r[10],whscode:r[11],acctcode:r[12],acctcodename:""!=r[12]?yield a.cuentas.filter(g=>g.Code===r[12])[0].Name:"",id_user:a.infoUsuario.id,id_solped:0,linenum:p-1,linetotal:c,linestatus:"O",taxvalor:u,trm:a.trm,linegtotal:c+u})):(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la cuenta contable de la linea ${p}, no existe en el listado de cuentas asociadas a la dependencia seleccionada`}),i=!1):(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la localidad de la linea ${p}, no existe en el listado de localidades asociadas al usuario`}),i=!1):(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la dependencia de la linea ${p}, no existe en el listado de dependencias asociadas al usuario`}),i=!1),l++):r.length>1&&(l++,a.messageService.add({severity:"error",summary:"!Error",detail:`La l\xedena ${p} del archivo a cargar, no posee la estructura b\xe1sica requerida`}),i=!1);return 0==l&&(a.messageService.add({severity:"error",summary:"!Error",detail:"El archivo seleccionado no posse lineas para agregar a la solped"}),i=!1),i})()}adicionarCSV(){this.lineasSolped=this.lineasSolpedCVS,this.formularioCSV=!1}descargarCSV(){return(0,C.Z)(function*(){const t=document.createElement("a");t.target="_blank",t.href="https://nitrofert.com.co/wp-content/uploads/2023/02/plantilla-cargue-detalle-solped.csv",t.click()})()}GuardarSolped(){if(this.envioFormulario=!0,this.clase&&this.serie&&this.area&&this.fechaContable&&this.fechaCaducidad&&this.fechaDocumento&&this.fechaNecesidad)if(this.lineasSolped.length>0)if(this.anexosSolped.length>0)if(this.anexosSolped.filter(o=>"Especificaci\xf3n t\xe9cnica"==o.tipo).length>0){const o={solped:{id_user:this.infoUsuario.id,usersap:this.infoUsuario.codusersap,fullname:this.infoUsuario.fullname,serie:this.serie,doctype:this.clase,docdate:this.fechaContable,docduedate:this.fechaCaducidad,taxdate:this.fechaDocumento,reqdate:this.fechaNecesidad,sapdocnum:"0",u_nf_depen_solped:this.area,comments:this.comentarios,trm:this.trm,currency:this.currency},solpedDet:this.lineasSolped,anexos:this.anexosSolped};this.solpedEditar&&(o.solped.id=this.solpedEditar),this.onNewSolped.emit(o),this.registroSolped=!0,this.envioFormulario=!1}else this.messageService.add({severity:"error",summary:"!Error",detail:"El anexo de revisi\xf3n t\xe9cnica es obligatorio"});else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe adjuntar los anexos requeridos"});else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar al menos una l\xednea en la solped"});else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar los campos resaltados en rojo"})}NuevaSolped(){}RegistrarLinea(){this.envioLinea=!0,this.descripcion&&this.fechaRequerida&&this.viceprecidencia.vicepresidency&&this.dependencia.dependence&&this.localidad.location&&this.cantidad&&this.precio&&this.impuesto&&(this.cuenta.Code&&this.validaCuenta||!this.cuenta.Code&&!this.validaCuenta)?(this.LineaDuplicada(),this.editarLinea?(this.asignarCamposLinea(this.lineaSeleccionada[0].linenum),this.lineasSolped.splice(this.lineasSolped.indexOf(this.lineaSeleccionada[0]),1,this.lineaSolped),this.messageService.add({severity:"success",summary:"!OK\xa1",detail:"Se realizo correctamente la actualizaci\xf3n de la l\xednea"}),this.editarLinea=!1):(this.asignarCamposLinea(this.numeroLinea),this.lineasSolped.push(this.lineaSolped),this.iteradorLinea++,this.messageService.add({severity:"success",summary:"!OK\xa1",detail:"Se realizo correctamente el registro de la l\xednea"})),this.formularioLinea=!1,this.calculatTotales(),this.resetearFormularioLinea(),this.envioLinea=!1):this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar los campos resaltados en rojo"})}asignarCamposLinea(o){this.lineaSolped={id_solped:this.solpedEditar?this.solpedEditar:0,linenum:o,id_user:this.infoUsuario.id,reqdatedet:this.fechaRequerida,linevendor:this.proveedor.CardCode,itemcode:this.item.ItemCode,dscription:this.descripcion,ocrcode3:this.viceprecidencia.vicepresidency,ocrcode2:this.dependencia.dependence,ocrcode:this.localidad.location,whscode:""!=this.almacen?this.almacen.store:"SM_N300",acctcode:this.cuenta.Code,acctcodename:this.nombreCuenta,quantity:this.cantidad,moneda:this.moneda,price:this.precio,trm:this.trm,linetotal:this.subtotalLinea,tax:this.impuesto.Code,taxvalor:this.valorImpuesto,linegtotal:this.totalLinea}}LineaDuplicada(){let o=this.lineasSolped.filter(t=>t.itemcode===this.item.ItemCode&&t.dscription===this.descripcion&&t.ocrcode===this.localidad.location&&t.ocrcode2===this.dependencia.dependence&&t.ocrcode3===this.viceprecidencia.vicepresidency);return this.lineasSolped.indexOf(o[0])}EditarLinea(){this.lineaSolped=this.lineaSeleccionada[0],this.editarLinea=!0,this.MostrarFormularioLinea(),this.numeroLinea=this.lineaSolped.linenum,this.lineaSolped.itemcode&&(this.item=this.items.filter(o=>o.ItemCode===this.lineaSolped.itemcode)[0]),this.descripcion=this.lineaSolped.dscription,this.lineaSolped.linevendor&&(this.proveedor=this.proveedores.filter(o=>o.CardCode===this.lineaSolped.linevendor)[0]),this.lineaSolped.acctcode&&(this.cuenta=this.cuentas.filter(o=>o.Code===this.lineaSolped.acctcode)[0]),this.lineaSolped.ocrcode3&&(this.viceprecidencia=this.vicepresidencias.filter(o=>o.vicepresidency===this.lineaSolped.ocrcode3)[0],this.SeleccionarVicepresidencia()),this.lineaSolped.ocrcode2&&(this.dependencia=this.dependencias.filter(o=>o.dependence===this.lineaSolped.ocrcode2)[0],this.SeleccionarDependencia()),this.lineaSolped.ocrcode&&(this.localidad=this.localidades.filter(o=>o.location===this.lineaSolped.ocrcode)[0]),this.lineaSolped.whscode&&(this.almacen=this.almacenes.filter(o=>o.store===this.lineaSolped.whscode).length>0?this.almacenes.filter(o=>o.store===this.lineaSolped.whscode)[0]:""),this.lineaSolped.tax&&(this.impuesto=this.impuestos.filter(o=>o.Code===this.lineaSolped.tax)[0]),this.lineaSolped.acctcode&&(this.cuenta=this.cuentas.filter(o=>o.Code===this.lineaSolped.acctcode)[0],this.nombreCuenta=this.cuenta.Name),this.cantidad=this.lineaSolped.quantity||1,this.moneda=this.monedas.filter(o=>o.Currency===this.lineaSolped.moneda)[0].Currency,this.precio=this.lineaSolped.price||0,this.subtotalLinea=this.lineaSolped.linetotal,this.prcImpuesto=100*(this.lineaSolped.linegtotal/this.lineaSolped.linetotal-1),this.valorImpuesto=this.lineaSolped.linegtotal*(this.prcImpuesto/100),this.totalLinea=this.lineaSolped.linegtotal}BorrarLineas(){let o=[],t=!1;for(let a of this.lineasSolped){t=!1;for(let i of this.lineaSeleccionada)a===i&&(t=!0);t||o.push(a)}this.lineasSolped=o}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}}w.\u0275fac=function(o){return new(o||w)(e.Y36(T.e),e.Y36(Z.c),e.Y36(y.K),e.Y36(f.F0),e.Y36(d.ez),e.Y36(f.gz))},w.\u0275cmp=e.Xpm({type:w,selectors:[["app-form-solped"]],viewQuery:function(o,t){if(1&o&&e.Gf(lt,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},inputs:{solpedEditar:"solpedEditar",registroSolped:"registroSolped"},outputs:{onNewSolped:"onNewSolped"},features:[e._Bn([d.ez])],decls:100,vars:121,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12"],[1,"card","p-fluid"],[1,"col"],[1,"field"],["htmlFor","nombreusuario"],["pInputText","","id","nombreusuario","name","nombreusuario","type","text","required","","readonly","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["htmlFor","area"],["optionLabel","area","optionValue","area","id","area","name","area","placeholder","\xc1rea","styleClass","p-dropdown-sm ",3,"options","ngModel","required","readonly","ngClass","ngModelChange","onChange"],["htmlFor","clase"],["optionLabel","name","optionValue","code","id","clase","name","clase","placeholder","Clase solped","styleClass","p-dropdown-sm ",3,"options","ngModel","disabled","required","readonly","ngClass","ngModelChange","onChange"],[1,"flex"],["htmlFor","serie"],["optionLabel","name","optionValue","code","id","serie","name","serie","placeholder","Tipo","styleClass","w-full p-dropdown-sm p-inputtext-sm",3,"options","ngModel","readonly","required","ngClass","ngModelChange","onChange"],["htmlFor","codigoSap"],["pInputText","","id","codigoSap","name","codigoSap","styleClass","w-full ","type","text","required","","readonly","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["for","fechaContable"],["inputId","fechaContable","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","readonlyInput","ngClass","ngModelChange","onSelect"],["for","fechaCaducidad"],["inputId","fechaCaducidad","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","fechaDocumento"],["inputId","fechaDocumento","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","fechaNecesidad"],["inputId","fechaNecesidad","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["htmlFor","comentarios"],["rows","3","pInputTextarea","","id","comments",1,"w-full",3,"ngModel","ngModelChange"],[1,"grid","align-content-center"],["class","field col",4,"ngIf"],[1,"field","col"],["pButton","","label","Nueva L\xednea","icon","pi pi-list",1,"p-button-outlined","mb-2","p-button-warning","p-button-sm",3,"disabled","click"],["label","Anexos","icon","pi pi-list","styleClass","p-button-outlined mb-2 p-button-primary p-button-sm","badgeClass","p-badge-danger",3,"disabled","badge","onClick"],["pButton","","label","Guardar","icon","pi pi-save",1,"p-button-outlined","mb-2","p-button-success","p-button-sm",3,"disabled","click"],["pButton","","label","Nueva solped","icon","pi pi-list",1,"p-button-outlined","mb-2","p-button-primary","p-button-sm",3,"disabled","click"],[3,"header","visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["pTemplate","content"],["pTemplate","footer"],["header","Detalle de la solicitud de pedido",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","linenum","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["header","Anexos de la solicitud de pedido",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","file.name","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["header","Cargar anexo",3,"visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["header","Cargar detalle solped",3,"visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["pButton","","label","Importar detalle","icon","pi pi-list",1,"p-button-outlined","mb-2","p-button-warning","p-button-sm",3,"disabled","click"],["label","Ver Detalle","icon","pi pi-search","styleClass","p-button-outlined mb-2 p-button-secondary p-button-sm","badgeClass","p-badge-danger",3,"disabled","badge","onClick"],["for","fechaRequerida"],["inputId","fechaRequerida","styleClass","w-full",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","proveedor"],["field","CardCode","panelStyleClass","text-sm sm:ml-2","inputStyleClass","w-full","styleClass","w-full","inputId","proveedor2",3,"ngModel","showEmptyMessage","suggestions","minLength","delay","ngModelChange","completeMethod","onSelect"],["pTemplate","item"],["for","itemCode"],["field","ItemCode","inputStyleClass","w-full","styleClass","w-full","inputId","itemCode","panelStyleClass","text-sm sm:ml-2",3,"ngModel","showEmptyMessage","suggestions","minLength","delay","showClear","autofocus","disabled","ngClass","ngModelChange","completeMethod","onSelect","onClear"],["for","descripcion"],["pInputText","","id","descripcion","name","descripcion","type","text","required","",1,"w-full",3,"ngModel","ngClass","ngModelChange"],["for","viceprecidencia"],["optionLabel","vicepresidency","filterBy","vicepresidency","placeholder","Seleccione una vicepresidencia","styleClass","w-full","inputId","viceprecidencia",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode3",""],["pTemplate","selectedItem"],["for","dependencia"],["optionLabel","dependence","placeholder","Seleccione una dependencia","filterBy","dependence","styleClass","w-full","inputId","dependencia",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode2",""],["for","localidad"],["optionLabel","location","placeholder","Seleccione una localidad","filterBy","location","styleClass","w-full","inputId","localidad",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode",""],["for","almacen"],["optionLabel","store","placeholder","Seleccione una almacen","filterBy","store","styleClass","w-full","inputId","almacen",3,"options","ngModel","filter","showClear","ngModelChange","onChange"],["for","cuenta"],["field","Code","inputStyleClass","w-full","styleClass","w-full","inputId","cuenta","panelStyleClass","text-sm sm:ml-2",3,"ngModel","showEmptyMessage","suggestions","minLength","delay","disabled","ngClass","ngModelChange","completeMethod","onSelect"],["for","nombreCuenta"],["type","text","pInputText","","id","nombreCuenta","disabled","",1,"w-full",3,"ngModel","ngClass","ngModelChange"],["for","cantidad"],["pInputText","","type","number","id","cantidad","placeholder","Cantidad","required","",1,"w-full",3,"ngModel","ngClass","ngModelChange","change"],["for","precio"],["optionLabel","Currency","optionValue","Currency","id","moneda","name","moneda",3,"options","ngModel","required","readonly","ngModelChange","onChange"],["inputId","precio","mode","currency","currency","COP","locale","es-CO","placeholder","Precio","styleClass","w-full",3,"ngModel","ngStyle","ngClass","ngModelChange"],["for","subtotalLinea"],["inputId","subtotalLinea","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",3,"ngModel","ngStyle","readonly","ngClass","ngModelChange"],["for","impuesto"],["optionLabel","Code","placeholder","Seleccione un impuesto","filterBy","Code","styleClass","w-full","inputId","impuesto",1,"w-full",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["suffix","%","inputStyleClass","text-center w-6","styleClass","text-center",3,"ngModel","readonly","disabled","ngClass","ngModelChange"],["for","valorImpuesto"],["inputId","valorImpuesto","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",1,"w-full",3,"ngModel","ngStyle","readonly","disabled","ngClass","ngModelChange"],["for","totalLinea"],["inputId","totalLinea","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",1,"w-full",3,"ngModel","disabled","readonly","ngClass","ngModelChange"],["class","country-item country-item-value",4,"ngIf"],[1,"country-item","country-item-value"],[1,"country-item"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"disabled","click"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","label","Limpiar","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["pButton","","label","Nueva L\xednea","icon","pi pi-list",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","icon","pi pi-pencil",1,"p-button-outlined","mb-2","mr-2","p-button-secondary","p-button-sm",3,"label","disabled","click"],["pButton","","label","Borrar L\xednea","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar por palabra clave",1,"w-full","p-inputtext-sm",3,"input"],["filter",""],[2,"width","3rem"],[1,"flex","justify-content-between","align-items-center"],["type","text","field","linenum","display","menu","placeholder","Buscar por linea detalle"],["type","text","field","itemcode","display","menu","placeholder","Buscar por c\xf3digo item"],["type","text","field","dscription","display","menu","placeholder","Buscar por descripci\xf3n"],["type","text","field","linevendor","display","menu","placeholder","Buscar por proveedor"],["type","text","field","acctcode","display","menu","placeholder","Buscar por cuenta"],["type","text","field","ocrcode3","display","menu","placeholder","Buscar por vicepresidencia"],["type","text","field","orecode2","display","menu","placeholder","Buscar por dependencia"],["type","text","field","location","display","menu","placeholder","Buscar por localidad"],[3,"value","onClick"],[2,"min-width","12rem"],["colspan","13",1,"text-right"],["colspan","16",1,"text-center"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"click"],["pButton","","label","Nuevo anexo","icon","pi pi-list",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","label","Borrar anexo","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],["type","text","field","tipo","display","menu","placeholder","Buscar por tipo anexo"],["type","text","field","nombre","display","menu","placeholder","Buscar por nombre"],["style","width: 1rem",4,"ngIf"],[2,"width","1rem"],[3,"value"],["style","min-width: 1rem;","class","flex justify-content-center flex-wrap",4,"ngIf"],[1,"flex","justify-content-center","flex-wrap",2,"min-width","1rem"],["icon","pi pi-download","label","","pTooltip","Descargar",1,"w-full",3,"click"],["for","tipoanexo"],["optionLabel","name","filterBy","name","placeholder","Seleccione el tipo del anexo","styleClass","w-full","inputId","tipoanexo",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["name","demo[]","chooseLabel","Seleccionar","cancelLabel","Cancelar","accept",".pdf","styleClass","w-full",1,"w-full",3,"multiple","showUploadButton","maxFileSize","ngClass","disabled","onSelect"],[4,"ngIf"],[4,"ngFor","ngForOf"],["name","demo2[]","chooseLabel","Seleccionar","cancelLabel","Cancelar","accept",".csv,.txt","styleClass","w-full",1,"w-full",3,"multiple","showUploadButton","maxFileSize","ngClass","onSelect"],["mode","indeterminate"],["icon","pi pi-download","label","Descargar plantilla para solped","styleClass","p-button-text",3,"click"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast")(1,"app-breadcrumb",0),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",1)(6,"div",4)(7,"div",5)(8,"label",6),e._uU(9,"Nombre solicitante"),e.qZA(),e.TgZ(10,"input",7),e.NdJ("ngModelChange",function(i){return t.infoUsuario.fullname=i}),e.qZA()(),e.TgZ(11,"div",5)(12,"label",8),e._uU(13,"\xc1rea aprobaci\xf3n"),e.qZA(),e.TgZ(14,"p-dropdown",9),e.NdJ("ngModelChange",function(i){return t.area=i})("onChange",function(){return t.SeleccionarArea()}),e.qZA()(),e.TgZ(15,"div",5)(16,"label",10),e._uU(17,"Clase"),e.qZA(),e.TgZ(18,"p-dropdown",11),e.NdJ("ngModelChange",function(i){return t.clase=i})("onChange",function(){return t.SeleccionarClase()}),e.qZA()()(),e.TgZ(19,"div",4)(20,"div",12)(21,"div",5)(22,"label",13),e._uU(23,"Tipo"),e.qZA(),e.TgZ(24,"p-dropdown",14),e.NdJ("ngModelChange",function(i){return t.serie=i})("onChange",function(){return t.SeleccionarSerie()}),e.qZA()(),e.TgZ(25,"div",5)(26,"label",15),e._uU(27,"C\xf3digo SAP"),e.qZA(),e.TgZ(28,"input",16),e.NdJ("ngModelChange",function(i){return t.codigoSap=i}),e.qZA()()(),e.TgZ(29,"div",12)(30,"div",5)(31,"label",17),e._uU(32,"Fecha contable"),e.qZA(),e.TgZ(33,"p-calendar",18),e.NdJ("ngModelChange",function(i){return t.fechaContable=i})("onSelect",function(){return t.SeleccionarFechaContable()}),e.qZA()(),e.TgZ(34,"div",5)(35,"label",19),e._uU(36,"V\xe1lido hasta"),e.qZA(),e.TgZ(37,"p-calendar",20),e.NdJ("ngModelChange",function(i){return t.fechaCaducidad=i}),e.qZA()()(),e.TgZ(38,"div",12)(39,"div",5)(40,"label",21),e._uU(41,"Fecha documento"),e.qZA(),e.TgZ(42,"p-calendar",22),e.NdJ("ngModelChange",function(i){return t.fechaDocumento=i}),e.qZA()(),e.TgZ(43,"div",5)(44,"label",23),e._uU(45,"Fecha necesaria"),e.qZA(),e.TgZ(46,"p-calendar",24),e.NdJ("ngModelChange",function(i){return t.fechaNecesidad=i}),e.qZA()()()()(),e.TgZ(47,"div",1)(48,"div",4)(49,"div",5)(50,"label",25),e._uU(51,"Comentarios"),e.qZA(),e.TgZ(52,"textarea",26),e.NdJ("ngModelChange",function(i){return t.comentarios=i}),e._uU(53,"                        "),e.qZA()()()(),e._UZ(54,"p-divider"),e.TgZ(55,"div",1)(56,"div",4)(57,"div",27),e.YNc(58,st,2,1,"div",28),e.TgZ(59,"div",29)(60,"button",30),e.NdJ("click",function(){return t.AdicionarLinea()}),e.qZA()(),e.YNc(61,dt,2,2,"div",28),e.TgZ(62,"div",29)(63,"p-button",31),e.NdJ("onClick",function(){return t.verAnexos()}),e.qZA()()()()()()()(),e.TgZ(64,"div",1)(65,"div",2)(66,"div",3)(67,"div",1)(68,"div",4)(69,"button",32),e.NdJ("click",function(){return t.GuardarSolped()}),e.qZA()(),e.TgZ(70,"div",4)(71,"button",33),e.NdJ("click",function(){return t.NuevaSolped()}),e.qZA()()()()()(),e.TgZ(72,"p-dialog",34),e.NdJ("visibleChange",function(i){return t.formularioLinea=i})("onHide",function(){return t.envioLinea=!1}),e.YNc(73,Ut,92,112,"ng-template",35),e.YNc(74,Nt,1,1,"ng-template",36),e.qZA(),e.TgZ(75,"p-dialog",37),e.NdJ("visibleChange",function(i){return t.listadoLineas=i}),e.TgZ(76,"p-table",38,39),e.NdJ("selectionChange",function(i){return t.lineaSeleccionada=i}),e.YNc(78,wt,10,4,"ng-template",40),e.YNc(79,qt,55,0,"ng-template",41),e.YNc(80,Ft,39,33,"ng-template",42),e.YNc(81,Pt,12,12,"ng-template",36),e.YNc(82,Et,3,0,"ng-template",43),e.YNc(83,Jt,3,0,"ng-template",44),e.qZA(),e.YNc(84,It,1,0,"ng-template",36),e.qZA(),e.TgZ(85,"p-dialog",45),e.NdJ("visibleChange",function(i){return t.listadoAnexos=i}),e.TgZ(86,"p-table",46,39),e.NdJ("selectionChange",function(i){return t.lineaAnexoSeleccionada=i}),e.YNc(88,Lt,9,2,"ng-template",40),e.YNc(89,Dt,14,1,"ng-template",41),e.YNc(90,zt,10,5,"ng-template",42),e.YNc(91,Qt,3,0,"ng-template",43),e.YNc(92,Rt,3,0,"ng-template",44),e.qZA(),e.YNc(93,Kt,1,0,"ng-template",36),e.qZA(),e.TgZ(94,"p-dialog",47),e.NdJ("visibleChange",function(i){return t.formularioAnexo=i})("onHide",function(){return t.envioLinea=!1}),e.YNc(95,Vt,12,14,"ng-template",35),e.YNc(96,Xt,1,1,"ng-template",36),e.qZA(),e.TgZ(97,"p-dialog",48),e.NdJ("visibleChange",function(i){return t.formularioCSV=i})("onHide",function(){return t.loadingCargueCSV=!1}),e.YNc(98,ao,60,7,"ng-template",35),e.YNc(99,no,2,1,"ng-template",36),e.qZA()),2&o&&(e.xp6(1),e.Q6J("urlBreadCrumb",t.urlBreadCrumb),e.xp6(9),e.Q6J("ngModel",t.infoUsuario.fullname),e.xp6(4),e.Q6J("options",t.areas)("ngModel",t.area)("required",!0)("readonly",t.lineasSolped.length>0)("ngClass",e.VKq(97,h,t.envioFormulario&&!t.area||t.nuevaLinea&&!t.area)),e.xp6(4),e.Q6J("options",t.clases)("ngModel",t.clase)("disabled","SPB"===t.serieName)("required",!0)("readonly",t.lineasSolped.length>0)("ngClass",e.VKq(99,h,t.envioFormulario&&!t.clase||t.nuevaLinea&&!t.clase)),e.xp6(6),e.Q6J("options",t.series)("ngModel",t.serie)("readonly",t.lineasSolped.length>0)("required",!0)("ngClass",e.VKq(101,h,t.envioFormulario&&!t.serie||t.nuevaLinea&&!t.serie)),e.xp6(4),e.Q6J("ngModel",t.codigoSap),e.xp6(5),e.Q6J("ngModel",t.fechaContable)("showIcon",!0)("required",!0)("readonlyInput",t.lineasSolped.length>0)("ngClass",e.VKq(103,h,t.envioFormulario&&!t.fechaContable||t.nuevaLinea&&!t.fechaContable)),e.xp6(4),e.Q6J("ngModel",t.fechaCaducidad)("showIcon",!0)("required",!0)("ngClass",e.VKq(105,h,t.envioFormulario&&!t.fechaCaducidad||t.nuevaLinea&&!t.fechaCaducidad)),e.xp6(5),e.Q6J("ngModel",t.fechaDocumento)("showIcon",!0)("required",!0)("ngClass",e.VKq(107,h,t.envioFormulario&&!t.fechaDocumento||t.nuevaLinea&&!t.fechaDocumento)),e.xp6(4),e.Q6J("ngModel",t.fechaNecesidad)("showIcon",!0)("required",!0)("ngClass",e.VKq(109,h,t.envioFormulario&&!t.fechaNecesidad||t.nuevaLinea&&!t.fechaNecesidad)),e.xp6(6),e.Q6J("ngModel",t.comentarios),e.xp6(6),e.Q6J("ngIf",0==t.lineasSolped.length),e.xp6(2),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("ngIf",t.lineasSolped.length>0),e.xp6(2),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)("badge",t.anexosSolped.length.toString()),e.xp6(6),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||t.registroSolped||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(2),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.envioFormulario),e.xp6(1),e.Akn(e.DdM(111,D)),e.Q6J("header",t.editarLinea?"Editar l\xednea":"Adicionar L\xednea")("visible",t.formularioLinea)("modal",!0)("breakpoints",e.DdM(112,oe))("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(3),e.Akn(e.DdM(113,D)),e.Q6J("visible",t.listadoLineas)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(1),e.Q6J("value",t.lineasSolped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(114,ro))("selection",t.lineaSeleccionada),e.xp6(9),e.Akn(e.DdM(115,D)),e.Q6J("visible",t.listadoAnexos)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(1),e.Q6J("value",t.anexosSolped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(116,lo))("selection",t.lineaAnexoSeleccionada),e.xp6(8),e.Akn(e.DdM(117,D)),e.Q6J("visible",t.formularioAnexo)("modal",!0)("breakpoints",e.DdM(118,oe))("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(3),e.Akn(e.DdM(119,D)),e.Q6J("visible",t.formularioCSV)("modal",!0)("breakpoints",e.DdM(120,oe))("maximizable",!0)("draggable",!1)("resizable",!1))},dependencies:[m.mk,m.sg,m.O5,m.PC,_.Fj,_.wV,_.JJ,_.Q7,_.On,le.Qc,d.jx,v.Hq,v.zx,M.u,W.f,E.V,se.i,U.Lt,de.p,H.k,pe.Rn,J.g,I.o,S.iA,S.UA,S.xl,x.FN,L.L,m.Zx,m.H9,m.uU],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]});class O{constructor(o,t,a,i,r){this.rutaActiva=o,this.messageService=t,this.authService=a,this.router=i,this.comprasService=r}ngOnInit(){this.solpedSeleccionada=this.rutaActiva.snapshot.params}actualizarSolped(o){this.comprasService.updateSolped(this.authService.getToken(),o).subscribe({next:t=>{501===t.status?this.messageService.add({severity:"error",summary:"!Error",detail:JSON.stringify(t.err)}):(this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:t.message}),setTimeout(()=>{this.router.navigate(["portal/compras/solped"])},2e3))},error:t=>{console.log(t)}})}}O.\u0275fac=function(o){return new(o||O)(e.Y36(f.gz),e.Y36(d.ez),e.Y36(T.e),e.Y36(f.F0),e.Y36(y.K))},O.\u0275cmp=e.Xpm({type:O,selectors:[["app-edit-solped"]],features:[e._Bn([d.ez])],decls:2,vars:1,consts:[[3,"solpedEditar","onNewSolped"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast"),e.TgZ(1,"app-form-solped",0),e.NdJ("onNewSolped",function(i){return t.actualizarSolped(i)}),e.qZA()),2&o&&(e.xp6(1),e.Q6J("solpedEditar",t.solpedSeleccionada.solped))},dependencies:[x.FN,w]});class z{constructor(o,t,a,i){this.messageService=o,this.authService=t,this.router=a,this.comprasService=i,this.registroSolped=!1}ngOnInit(){}registrarSolped(o){this.comprasService.saveSolpedMP(this.authService.getToken(),o).subscribe({next:t=>{console.log(t),501===t.status?this.messageService.add({severity:"error",summary:"!Error",detail:JSON.stringify(t.err)}):(this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:t.message}),setTimeout(()=>{this.router.navigate(["portal/compras/solped/tracking"])},1e3))},error:t=>{console.log(t),this.registroSolped=!1}})}loadFiles(o,t){let a;for(let i of t)a=new FormData,a.append("myFile",i.file,i.file.name),a.append("anexotipo",i.tipo),a.append("solpedID",o),this.comprasService.uploadAnexo(this.authService.getToken(),a).subscribe({next:r=>{this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:r.message})},error:r=>{console.log(r),this.messageService.add({severity:"error",summary:"!Error\xa1",detail:r})}});this.router.navigate(["portal/compras/solped"])}}z.\u0275fac=function(o){return new(o||z)(e.Y36(d.ez),e.Y36(T.e),e.Y36(f.F0),e.Y36(y.K))},z.\u0275cmp=e.Xpm({type:z,selectors:[["app-new-solped-mp"]],features:[e._Bn([d.ez])],decls:3,vars:1,consts:[[3,"registroSolped","onNewSolped"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast"),e.TgZ(1,"app-form-solped-mp",0),e.NdJ("onNewSolped",function(i){return t.registrarSolped(i)}),e.qZA(),e._uU(2,">")),2&o&&(e.xp6(1),e.Q6J("registroSolped",t.registroSolped))},dependencies:[x.FN,N]});class q{constructor(o,t,a,i){this.messageService=o,this.authService=t,this.router=a,this.comprasService=i,this.registroSolped=!1}ngOnInit(){}registrarSolped(o){this.comprasService.saveSolped(this.authService.getToken(),o).subscribe({next:t=>{501===t.status?this.messageService.add({severity:"error",summary:"!Error",detail:JSON.stringify(t.err)}):(this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:t.message}),this.loadFiles(t.solpednum,o.anexos))},error:t=>{console.log(t),this.registroSolped=!1}})}loadFiles(o,t){let a;for(let i of t)a=new FormData,a.append("myFile",i.file,i.file.name),a.append("anexotipo",i.tipo),a.append("solpedID",o),this.comprasService.uploadAnexo(this.authService.getToken(),a).subscribe({next:r=>{this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:r.message})},error:r=>{this.messageService.add({severity:"error",summary:"!Error\xa1",detail:r})}});this.router.navigate(["portal/compras/solped"])}}q.\u0275fac=function(o){return new(o||q)(e.Y36(d.ez),e.Y36(T.e),e.Y36(f.F0),e.Y36(y.K))},q.\u0275cmp=e.Xpm({type:q,selectors:[["app-new-solped"]],features:[e._Bn([d.ez])],decls:3,vars:1,consts:[[3,"registroSolped","onNewSolped"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast"),e.TgZ(1,"app-form-solped",0),e.NdJ("onNewSolped",function(i){return t.registrarSolped(i)}),e.qZA(),e._uU(2,">\n")),2&o&&(e.xp6(1),e.Q6J("registroSolped",t.registroSolped))},dependencies:[x.FN,w]});var $=s(9701),so=s(4327),po=s(1795),co=s(1707);const uo=["filter"];function mo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",16)(1,"div",17),e._UZ(2,"i",18),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",19)(8,"div",20)(9,"button",21),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmCancel())}),e.qZA()(),e.TgZ(10,"div",20)(11,"button",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectCancel())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function _o(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.newSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].create_accion)}}function ho(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.editSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("pTooltip",t.permisosUsuarioPagina[0].update_accion?"Editar":"Consultar")("icon",t.permisosUsuarioPagina[0].update_accion?"pi pi-pencil":"pi pi-search")("disabled",!t.permisosUsuarioPagina[0].update_accion||!t.selectedItem||1!=t.selectedItem.length)}}function go(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.envairSAP())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].create_accion||!t.selectedItem||1!=t.selectedItem.length)}}function fo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",38),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.cancelarSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].delete_accion||!t.selectedItem||0==t.selectedItem.length)}}function Co(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",23)(1,"div")(2,"button",24),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(8);return e.KtG(i.clear(r))}),e.qZA(),e.YNc(3,_o,1,1,"button",25),e.YNc(4,ho,1,3,"button",26),e.YNc(5,go,1,1,"button",27),e.YNc(6,fo,1,1,"button",28),e.TgZ(7,"button",29),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.exportExcel())}),e.qZA(),e._UZ(8,"button",30),e.qZA(),e.TgZ(9,"span",31),e._UZ(10,"i",32),e.TgZ(11,"input",33,34),e.NdJ("input",function(i){e.CHM(t);const r=e.oxw(),l=e.MAs(8);return e.KtG(r.onGlobalFilter(l,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.permisosUsuarioPagina[0].create_accion&&t.showNuevo),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion&&t.showEditar),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].create_accion&&t.showEnvioSAP),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].delete_accion&&t.showDeleteSolped),e.xp6(2),e.Q6J("label",t.titulo)}}function bo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Motonave "),e._UZ(3,"p-columnFilter",51),e.qZA()())}function So(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," N\xfamero pedido "),e._UZ(3,"p-columnFilter",52),e.qZA()())}function vo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Cantidad disponible "),e.qZA()())}function To(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Fecha de Cargue (LDS) "),e._UZ(3,"p-columnFilter",53),e.qZA()())}function yo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Fecha est. de salida (ETS) "),e._UZ(3,"p-columnFilter",54),e.qZA()())}function xo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Motonave "),e._UZ(3,"p-columnFilter",51),e.qZA()())}function Ao(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Puerto llegada "),e._UZ(3,"p-columnFilter",55),e.qZA()())}function Zo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Agente "),e._UZ(3,"p-columnFilter",56),e.qZA()())}function Mo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Incoterms "),e.qZA()())}function Uo(n,o){if(1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",39),e.YNc(2,bo,4,0,"th",40),e.TgZ(3,"th")(4,"div",41),e._uU(5),e._UZ(6,"p-columnFilter",42),e.qZA()(),e.YNc(7,So,4,0,"th",40),e.TgZ(8,"th")(9,"div",41),e._uU(10," Proveedor "),e._UZ(11,"p-columnFilter",43),e.qZA()(),e.TgZ(12,"th")(13,"div",41),e._uU(14," \xcdtem "),e._UZ(15,"p-columnFilter",44),e.qZA()(),e.TgZ(16,"th")(17,"div",41),e._uU(18),e._UZ(19,"p-columnFilter",45),e.qZA()(),e.YNc(20,vo,3,0,"th",40),e.TgZ(21,"th")(22,"div",41),e._uU(23," Unidad "),e.qZA()(),e.TgZ(24,"th")(25,"div",41),e._uU(26," \xbfMP importada? "),e._UZ(27,"p-columnFilter",46),e.qZA()(),e.YNc(28,To,4,0,"th",40),e.YNc(29,yo,4,0,"th",40),e.TgZ(30,"th")(31,"div",41),e._uU(32),e._UZ(33,"p-columnFilter",47),e.qZA()(),e.YNc(34,xo,4,0,"th",40),e.TgZ(35,"th")(36,"div",41),e._uU(37," Puerto salida "),e._UZ(38,"p-columnFilter",48),e.qZA()(),e.YNc(39,Ao,4,0,"th",40),e.YNc(40,Zo,4,0,"th",40),e.YNc(41,Mo,3,0,"th",40),e.TgZ(42,"th")(43,"div",41),e._uU(44," Presentaci\xf3n "),e._UZ(45,"p-columnFilter",49),e.qZA()(),e.TgZ(46,"th")(47,"div",41),e._uU(48," Comentarios "),e._UZ(49,"p-columnFilter",50),e.qZA()()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf","Entrada"==t.documento),e.xp6(3),e.hij(" N\xfamero ",t.documento," "),e.xp6(2),e.Q6J("ngIf","Entrada"==t.documento),e.xp6(11),e.hij(" Cantidad ",t.documento," "),e.xp6(2),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento),e.xp6(8),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento),e.xp6(3),e.hij(" ","Pedido"==t.documento?"Fecha est. de llegada (ETA)":"Fecha Arribo"," "),e.xp6(2),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento),e.xp6(5),e.Q6J("ngIf","Proyecciones"!=t.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento)}}function No(n,o){if(1&n&&(e.TgZ(0,"td",61),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.U_NF_MOTONAVE," ")}}function wo(n,o){if(1&n&&(e.TgZ(0,"td",59),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.pedido," ")}}function qo(n,o){if(1&n&&(e.TgZ(0,"td",64),e._uU(1),e.ALo(2,"number"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.RemainingOpenQuantity)," ")}}function Fo(n,o){if(1&n&&(e.TgZ(0,"td",67),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.Dn7(2,1,t.U_NF_LASTSHIPPPING,"dd/MM/yyyy","+0500")," ")}}function Po(n,o){if(1&n&&(e.TgZ(0,"td",67),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.Dn7(2,1,t.U_NF_DATEOFSHIPPING,"dd/MM/yyyy","+0500")," ")}}function Eo(n,o){if(1&n&&(e.TgZ(0,"td",61),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.U_NF_MOTONAVE," ")}}function Jo(n,o){if(1&n&&(e.TgZ(0,"td",61),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.U_NF_PUERTOSALIDA," ")}}function Io(n,o){if(1&n&&(e.TgZ(0,"td",61),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.U_NF_AGENTE," ")}}function Lo(n,o){if(1&n&&(e.TgZ(0,"td",59),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.U_NT_Incoterms," ")}}function ko(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",57),e.qZA(),e.YNc(3,No,2,1,"td",58),e.TgZ(4,"td",59),e._uU(5),e.qZA(),e.YNc(6,wo,2,1,"td",60),e.TgZ(7,"td",61)(8,"span",62),e._uU(9),e.ALo(10,"tooltips"),e.qZA()(),e.TgZ(11,"td",63)(12,"span",62),e._uU(13),e.ALo(14,"tooltips"),e.qZA()(),e.TgZ(15,"td",64),e._uU(16),e.ALo(17,"number"),e.qZA(),e.YNc(18,qo,3,3,"td",65),e.TgZ(19,"td",64),e._uU(20),e.qZA(),e.TgZ(21,"td",59),e._uU(22),e.qZA(),e.YNc(23,Fo,3,5,"td",66),e.YNc(24,Po,3,5,"td",66),e.TgZ(25,"td",67),e._uU(26),e.ALo(27,"date"),e.qZA(),e.YNc(28,Eo,2,1,"td",58),e.YNc(29,Jo,2,1,"td",58),e.TgZ(30,"td",61),e._uU(31),e.qZA(),e.YNc(32,Io,2,1,"td",58),e.YNc(33,Lo,2,1,"td",60),e.TgZ(34,"td",61),e._uU(35),e.qZA(),e.TgZ(36,"td",61)(37,"span",62),e._uU(38),e.ALo(39,"tooltips"),e.qZA()()()),2&n){const t=o.$implicit,a=e.oxw();e.xp6(2),e.Q6J("value",t),e.xp6(1),e.Q6J("ngIf","Entrada"==a.documento),e.xp6(2),e.hij(" ",t.DocNum," "),e.xp6(1),e.Q6J("ngIf","Entrada"==a.documento),e.xp6(2),e.Q6J("pTooltip",t.ProveedorDS),e.xp6(1),e.hij(" ",e.Dn7(10,23,t.ProveedorDS,15,t.DocNum)," "),e.xp6(3),e.Q6J("pTooltip",t.Description),e.xp6(1),e.hij(" ",e.Dn7(14,27,t.Description,20,t.DocNum)," "),e.xp6(3),e.hij(" ",e.lcZ(17,31,t.Quantity)," "),e.xp6(2),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(2),e.hij(" ",t.MeasureUnit," "),e.xp6(2),e.hij(" ",t.U_NF_PEDMP," "),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(2),e.hij(" ",e.Dn7(27,33,t.RequriedDate,"dd/MM/yyyy","+0500")," "),e.xp6(2),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=a.documento),e.xp6(2),e.hij(" ",t.WarehouseName," "),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(2),e.hij(" ",t.U_NF_TIPOCARGA," "),e.xp6(2),e.Q6J("pTooltip",t.Comments),e.xp6(1),e.hij(" ",e.Dn7(39,37,t.Comments,20,t.DocNum)," ")}}function Do(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",68),e._uU(2,"No se econtraron registros."),e.qZA()())}function Oo(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",68),e._uU(2,"Cargando registros. Por favor espere"),e.qZA()())}const zo=function(){return{height:"6px"}};function Qo(n,o){1&n&&(e.TgZ(0,"div",69),e._UZ(1,"p-progressBar",94),e.qZA()),2&n&&(e.xp6(1),e.Akn(e.DdM(2,zo)))}const V=function(n){return{"ng-invalid ng-dirty":n}};function Ro(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",69)(2,"label",70),e._uU(3,"Estados"),e.qZA(),e.TgZ(4,"p-dropdown",71),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.u_nf_status=i)}),e.qZA()()(),e.TgZ(5,"div",3)(6,"div",69)(7,"label",72),e._uU(8,"Fecha de Cargue (LDS)"),e.qZA(),e.TgZ(9,"p-calendar",73),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.u_nf_lastshippping=i)}),e.qZA()(),e.TgZ(10,"div",69)(11,"label",74),e._uU(12,"Fecha est. de salida (ETS)"),e.qZA(),e.TgZ(13,"p-calendar",75),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.u_nf_dateofshipping=i)}),e.qZA()(),e.TgZ(14,"div",69)(15,"label",76),e._uU(16),e.qZA(),e.TgZ(17,"p-calendar",77),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.RequriedDate=i)}),e.qZA()()(),e.TgZ(18,"div",3)(19,"div",69)(20,"label",78),e._uU(21,"Tipo pago"),e.qZA(),e.TgZ(22,"input",79),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.nf_pago=i)}),e.qZA()(),e.TgZ(23,"div",69)(24,"label",80),e._uU(25,"Tipo carga"),e.qZA(),e.TgZ(26,"p-dropdown",81),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.nf_tipocarga=i)}),e.qZA()()(),e.TgZ(27,"div",3)(28,"div",69)(29,"label",82),e._uU(30,"Agente aduanero"),e.qZA(),e.TgZ(31,"p-dropdown",83),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.nf_agente=i)}),e.qZA()(),e.TgZ(32,"div",69)(33,"label",84),e._uU(34,"Motonave"),e.qZA(),e.TgZ(35,"input",85),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.nf_motonave=i)}),e.qZA()()(),e.TgZ(36,"div",3)(37,"div",69)(38,"label",78),e._uU(39,"Incoterms"),e.qZA(),e.TgZ(40,"p-dropdown",86),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.nf_Incoterms=i)}),e.qZA()()(),e.TgZ(41,"div",3)(42,"div",69)(43,"label",87),e._uU(44,"Puerto salida"),e.qZA(),e.TgZ(45,"input",88),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.nf_puertosalida=i)}),e.qZA()()(),e.TgZ(46,"div",3)(47,"div",89)(48,"div",90)(49,"label",91),e._uU(50,"Comentarios"),e.qZA(),e.TgZ(51,"textarea",92),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.comentarios=i)}),e._uU(52,"                    "),e.qZA()()()(),e.TgZ(53,"div",3),e.YNc(54,Qo,2,3,"div",93),e.qZA()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("options",t.estados)("ngModel",t.u_nf_status)("required",!0)("ngClass",e.VKq(31,V,t.envioFormulario&&!t.u_nf_status)),e.xp6(5),e.Q6J("ngModel",t.u_nf_lastshippping)("showIcon",!0)("required",!0)("ngClass",e.VKq(33,V,t.envioFormulario&&!t.u_nf_lastshippping)),e.xp6(4),e.Q6J("ngModel",t.u_nf_dateofshipping)("showIcon",!0)("required",!0)("ngClass",e.VKq(35,V,t.envioFormulario&&!t.u_nf_dateofshipping)),e.xp6(3),e.Oqu("Pedido"==t.documento?"Fecha est. de llegada (ETA)":"Fecha Necesidad"),e.xp6(1),e.Q6J("ngModel",t.RequriedDate)("showIcon",!0)("required",!0)("ngClass",e.VKq(37,V,t.envioFormulario&&!t.RequriedDate)),e.xp6(5),e.Q6J("ngModel",t.nf_pago),e.xp6(4),e.Q6J("options",t.tiposdecarga)("ngModel",t.nf_tipocarga)("required",!0),e.xp6(5),e.Q6J("options",t.agentes)("ngModel",t.nf_agente)("required",!0),e.xp6(4),e.Q6J("ngModel",t.nf_motonave),e.xp6(5),e.Q6J("options",t.tipo_Incoterms)("ngModel",t.nf_Incoterms)("required",!0),e.xp6(5),e.Q6J("ngModel",t.nf_puertosalida),e.xp6(6),e.Q6J("ngModel",t.comentarios),e.xp6(3),e.Q6J("ngIf",!0===t.loadingSave)}}function Ko(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",95),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.ActualizarPedido())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].update_accion)}}const Bo=function(){return[10,25,50]},Go=function(){return["DocNum","CardName","CardCode","U_NF_STATUS","ItemCode","ItemDescription","U_NF_MOTONAVE","U_NF_LASTSHIPPPING","U_NF_DATEOFSHIPPING","RequriedDate"]},Yo=function(){return{width:"50vw"}},Ho=function(){return{"960px":"75vw","640px":"100vw"}};class Q{constructor(o,t,a,i,r,l,c,u){this.rutaActiva=o,this.adminService=t,this.comprasService=a,this.router=i,this.confirmationService=r,this.messageService=l,this.authService=c,this.sapService=u,this.onChangeTabla=new e.vpe,this.onChangeLoading=new e.vpe,this.selectedItem=[],this.formulario=!1,this.envioFormulario=!1,this.estados=[{name:"Por cargar"},{name:"Cargado"},{name:"Pedidos en puerto"}],this.u_nf_status="",this.nf_tipocarga="",this.agentes=[{tipo:"Multiport"},{tipo:"Pharo"},{tipo:"Deep Blue"},{tipo:"SCS"},{tipo:"TRANSMARES"}],this.nf_agente="",this.nf_motonave="",this.nf_puertosalida="",this.nf_pago="",this.nf_Incoterms="",this.tipo_Incoterms=[{tipo:"CIF"},{tipo:"CFR"},{tipo:"FCA"},{tipo:"FOB"}],this.loadingSave=!1,this.tiposdecarga=[{tipo:"Empacado"},{tipo:"Granel"}],this.tituloFormEditPedido="",this.statuses=[{label:"Abierta",value:"O"},{label:"Cerrada",value:"C"}],this.approves=[{label:"No aprobada",value:"No"},{label:"Aprobada",value:"A"},{label:"Pendiente",value:"P"},{label:"Rechazada",value:"R"}],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSopledARechazada=!1,this.arraySolpedRechazadas=[],this.arrayIdSolped=[],this.arraryErrorTrm=[]}ngOnInit(){this.infoUsuario=this.authService.getInfoUsuario(),this.perfilesUsuario=this.authService.getPerfilesUsuario(),this.permisosUsuario=this.authService.getPermisosUsuario(),this.permisosUsuarioPagina=this.permisosUsuario.filter(o=>o.url===this.router.url)}ngOnChanges(o){o.documentList.currentValue.length>0?this.getSolpedList():setTimeout(()=>{this.getSolpedList()},5e3)}getSolpedList(){this.loading=!1}newSolped(){this.router.navigate(["/portal/compras/solped/nueva-mp"])}editSolped(){("Solped"==this.documento||"Proyecciones"==this.documento)&&this.router.navigate(["/portal/compras/solped/editar-mp",this.selectedItem[0].id]),"Pedido"==this.documento&&(this.formulario=!0,this.loadingSave=!1,this.asignarCampos())}asignarCampos(){console.log(this.selectedItem[0]);let o=36e5;this.tituloFormEditPedido="Editar pedido "+this.selectedItem[0].DocNum,this.u_nf_status="Solicitado"==this.selectedItem[0].U_NF_STATUS?"Por cargar":this.selectedItem[0].U_NF_STATUS,console.log(this.u_nf_status),this.u_nf_lastshippping=new Date(new Date(this.selectedItem[0].U_NF_LASTSHIPPPING).getTime()+5*o),this.u_nf_dateofshipping=new Date(new Date(this.selectedItem[0].U_NF_DATEOFSHIPPING).getTime()+5*o),this.RequriedDate=new Date(new Date(this.selectedItem[0].RequriedDate).getTime()+5*o),this.cantidad=this.selectedItem[0].Quantity,this.cantidadkl=1e3*this.selectedItem[0].Quantity,this.comentarios=this.selectedItem[0].Comments,this.nf_tipocarga=this.selectedItem[0].U_NF_TIPOCARGA,this.nf_agente=this.selectedItem[0].U_NF_AGENTE,this.nf_motonave=this.selectedItem[0].U_NF_MOTONAVE,this.nf_puertosalida=this.selectedItem[0].U_NF_PUERTOSALIDA,this.nf_pago=this.selectedItem[0].U_NF_PAGO,this.nf_Incoterms=this.selectedItem[0].U_NT_Incoterms}calcularCantidadKL(){}ActualizarPedido(){if(this.envioFormulario=!0,""!=this.u_nf_status&&""!=this.u_nf_dateofshipping&&""!=this.u_nf_lastshippping&&""!=this.RequriedDate){this.loadingSave=!0;let o={DocEntry:this.selectedItem[0].DocEntry,DocNum:this.selectedItem[0].DocNum,pedidoData:{U_NF_STATUS:"Por cargar"==this.u_nf_status?"Solicitado":this.u_nf_status,U_NF_LASTSHIPPPING:this.u_nf_lastshippping,U_NF_DATEOFSHIPPING:this.u_nf_dateofshipping,DocDueDate:this.RequriedDate,Comments:this.comentarios,U_NF_TIPOCARGA:this.nf_tipocarga,U_NF_PAGO:this.nf_pago,U_NF_AGENTE:this.nf_agente,U_NF_MOTONAVE:this.nf_motonave,U_NF_PUERTOSALIDA:this.nf_puertosalida,U_NT_Incoterms:this.nf_Incoterms}};console.log(o),this.comprasService.actualizarPedidoSAP(this.authService.getToken(),o).subscribe({next:t=>{console.log(t),this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:t.message}),this.onChangeTabla.emit(this.nombreLista),this.selectedItem=[],this.loading=!0,this.formulario=!1},error:t=>{console.log(t),this.messageService.add({severity:"error",summary:"!Error",detail:t})}})}else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar los campos resaltados en rojo"})}envairSAP(){this.loading=!0,"N"==this.selectedItem[0].approved?this.comprasService.enviarSolpedSAP(this.authService.getToken(),{id:this.selectedItem[0].id}).subscribe({next:o=>{this.messageService.add(o.status?{severity:"success",summary:"!Ok\xa1",detail:o.message}:{severity:"error",summary:"!Ok\xa1",detail:o.err}),this.loading=!1,this.onChangeTabla.emit(this.nombreLista)},error:o=>{console.log(o),this.loading=!1}}):"C"==this.selectedItem[0].approved?(this.messageService.add({severity:"error",summary:"!Error",detail:"La solped seleccionada fue ya fue cancelada."}),this.loading=!1):"A"==this.selectedItem[0].approved&&(this.messageService.add({severity:"error",summary:"!Error",detail:"La solped seleccionada fue ya fue enviada a SAP."}),this.loading=!1)}cancelarSolped(){let o=[];new Date,this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],console.log(this.selectedItem);for(let i of this.selectedItem)"C"===i.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(i.id)),o.push(i.id);this.arrayIdSolped=o;let a="";this.errorSolpedCancelada?(a=this.arrayErrorSolpedCancelada.length>1?`Los documentos ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladaos.`:`El documento ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelado`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSolpedCancelada=!1):(a=o.length>1?"\xbfDesea Continuar con la cancelaci\xf3n de los documentos seleccionados?":"\xbfDesea Continuar con la cancelaci\xf3n del  documento seleccionado?",this.messageService.clear(),this.messageService.add({key:"cdel",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:a}))}onRejectCancel(){this.messageService.clear("cdel")}onConfirmCancel(){this.loading=!0;let o="";this.messageService.clear("cdel"),this.comprasService.cancelacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{"ok"==t.status?(o=this.arrayIdSolped.length>1?"La cancelaci\xf3n de los documentos seleccionados fueron realizados correctamente":"La cancelaci\xf3n del documento seleccionado fue realizado correctamente",this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:o}),this.onChangeTabla.emit(this.nombreLista)):(this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t.message}),this.loading=!1)},error:t=>{console.log(t),this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}exportExcel(){s.e(574).then(s.bind(s,574)).then(o=>{const a={Sheets:{data:o.utils.json_to_sheet(this.documentList)},SheetNames:["data"]},i=o.write(a,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(i,`${this.documento}`)})}saveAsExcelFile(o,t){const r=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});so.saveAs(r,t+"_export_"+(new Date).getTime()+".xlsx")}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}}Q.\u0275fac=function(o){return new(o||Q)(e.Y36(f.gz),e.Y36($.l),e.Y36(y.K),e.Y36(f.F0),e.Y36(d.YP),e.Y36(d.ez),e.Y36(T.e),e.Y36(Z.c))},Q.\u0275cmp=e.Xpm({type:Q,selectors:[["app-table-solped-mp"]],viewQuery:function(o,t){if(1&o&&e.Gf(uo,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},inputs:{documentList:"documentList",color:"color",showNuevo:"showNuevo",showEditar:"showEditar",showEnvioSAP:"showEnvioSAP",showDeleteSolped:"showDeleteSolped",titulo:"titulo",nombreLista:"nombreLista",loading:"loading",documento:"documento"},outputs:{onChangeTabla:"onChangeTabla",onChangeLoading:"onChangeLoading"},features:[e._Bn([d.ez,d.YP]),e.TTD],decls:17,vars:23,consts:[["key","tl"],["key","cdel",3,"baseZIndex","onClose"],["pTemplate","message"],[1,"grid"],[1,"col-12"],[1,"card"],["dataKey","key","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","rowsPerPageOptions","loading","rowHover","styleClass","paginator","globalFilterFields","selection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],[3,"header","visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["pTemplate","content"],["pTemplate","footer"],[1,"flex","flex-column",2,"flex","1"],[1,"text-center"],[1,"pi","pi-exclamation-triangle",2,"font-size","3rem"],[1,"grid","p-fluid"],[1,"col-6"],["type","button","pButton","","label","Si",1,"p-button-success",3,"click"],["type","button","pButton","","label","No",1,"p-button-secondary",3,"click"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","pTooltip","Limpiar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-success p-button-sm","icon","pi pi-plus",3,"disabled","click",4,"ngIf"],["pButton","","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-secondary p-button-sm",3,"pTooltip","icon","disabled","click",4,"ngIf"],["pButton","","pTooltip","Enviar a SAP","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-warning p-button-sm","icon","pi pi-send",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-danger p-button-sm","icon","pi pi-trash",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Exportar a excel","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-file-excel",1,"p-button-outlined","mb-2","mr-2","p-button-success","p-button-sm",3,"click"],["pButton","","pRipple","","type","button",1,"p-button-text","p-button-secondary",3,"label"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar por palabra clave",1,"w-full","p-inputtext-sm",3,"input"],["filter",""],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-plus",1,"p-button-outlined","mb-2","mr-2","p-button-success","p-button-sm",3,"disabled","click"],["pButton","","tooltipPosition","bottom","placeholder","Bottom",1,"p-button-outlined","mb-2","mr-2","p-button-secondary","p-button-sm",3,"pTooltip","icon","disabled","click"],["pButton","","pTooltip","Enviar a SAP","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-send",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],[2,"width","3rem"],[4,"ngIf"],[1,"flex","justify-content-between","align-items-center"],["type","text","field","DocNum","display","menu","placeholder","Buscar por c\xf3digo solped"],["type","text","field","ProveedorDS","display","menu","placeholder","Buscar por \xedtem o nombre \xedtem"],["type","text","field","Description","display","menu","placeholder","Buscar por \xedtem o nombre \xedtem"],["type","text","field","Quantity","display","menu","placeholder","Buscar por cantidad"],["type","text","field","U_NF_PEDMP","display","menu","placeholder","Buscar por"],["type","date","field","RequriedDate","display","menu"],["type","text","field","U_NF_PUERTOSALIDA","display","menu","placeholder","Buscar por puerto salida"],["type","text","field","U_NF_TIPOCARGA","display","menu","placeholder","Buscar por tipo de buque"],["type","text","field","Comments","display","menu","placeholder","Buscar por comentario"],["type","text","field","U_NF_MOTONAVE","display","menu","placeholder","Buscar por motonave"],["type","text","field","pedido","display","menu","placeholder","Buscar por c\xf3digo pedido"],["type","date","field","U_NF_LASTSHIPPPING","display","menu"],["type","date","field","U_NF_DATEOFSHIPPING","display","menu"],["type","text","field","DocumentLines.WarehouseCode","display","menu","placeholder","Buscar por puerto llegada"],["type","text","field","U_NF_AGENTE","display","menu","placeholder","Buscar por agente"],[3,"value"],["style","min-width: 12rem;",4,"ngIf"],[2,"min-width","6rem"],["style","min-width: 6rem;",4,"ngIf"],[2,"min-width","12rem"],["tooltipPosition","top",3,"pTooltip"],[2,"min-width","15rem"],[2,"min-width","8rem"],["style","min-width: 8rem;",4,"ngIf"],["style","min-width: 10rem;",4,"ngIf"],[2,"min-width","10rem"],["colspan","19",1,"text-center"],[1,"field","col"],["for","u_nf_status"],["optionLabel","name","optionValue","name","id","u_nf_status","name","u_nf_status","placeholder","Seleccione una estado","styleClass","p-dropdown-sm w-full",3,"options","ngModel","required","ngClass","ngModelChange"],["for","u_nf_lastshippping"],["inputId","u_nf_lastshippping","styleClass","w-full",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","u_nf_dateofshipping"],["inputId","u_nf_dateofshipping","styleClass","w-full",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","RequriedDate"],["inputId","RequriedDate","styleClass","w-full",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["htmlFor","nf_pago"],["pInputText","","id","nf_pago","name","nf_pago","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm","w-full",3,"ngModel","ngModelChange"],["for","nf_tipocarga"],["optionLabel","tipo","optionValue","tipo","id","nf_tipocarga","name","nf_tipocarga","placeholder","Tipo de carga","styleClass","p-dropdown-sm w-full",3,"options","ngModel","required","ngModelChange"],["for","nf_agente"],["optionLabel","tipo","optionValue","tipo","id","nf_agente","name","nf_agente","placeholder","Agente","styleClass","p-dropdown-sm w-full",3,"options","ngModel","required","ngModelChange"],["for","nf_motonave"],["pInputText","","id","nf_motonave","name","nf_motonave","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm","w-full",3,"ngModel","ngModelChange"],["optionLabel","tipo","optionValue","tipo","id","nf_Incoterms","name","nf_Incoterms","placeholder","Incoterms","styleClass","p-dropdown-sm w-full",3,"options","ngModel","required","ngModelChange"],["htmlFor","nf_puertosalida"],["pInputText","","id","nf_puertosalida","name","nf_puertosalida","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm","w-full",3,"ngModel","ngModelChange"],[1,"col"],[1,"field"],["htmlFor","comentarios"],["rows","3","pInputTextarea","","id","comentarios",1,"w-full",3,"ngModel","ngModelChange"],["class","field col",4,"ngIf"],["mode","indeterminate"],["icon","pi pi-check","label","Actualizar","styleClass","p-button-text",3,"disabled","click"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast")(1,"p-toast",0),e.TgZ(2,"p-toast",1),e.NdJ("onClose",function(){return t.onRejectCancel()}),e.YNc(3,mo,12,2,"ng-template",2),e.qZA(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"p-table",6,7),e.NdJ("selectionChange",function(i){return t.selectedItem=i}),e.YNc(9,Co,13,5,"ng-template",8),e.YNc(10,Uo,50,12,"ng-template",9),e.YNc(11,ko,40,41,"ng-template",10),e.YNc(12,Do,3,0,"ng-template",11),e.YNc(13,Oo,3,0,"ng-template",12),e.qZA()()()(),e.TgZ(14,"p-dialog",13),e.NdJ("visibleChange",function(i){return t.formulario=i})("onHide",function(){return t.envioFormulario=!1}),e.YNc(15,Ro,55,39,"ng-template",14),e.YNc(16,Ko,1,1,"ng-template",15),e.qZA()),2&o&&(e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(5),e.Q6J("value",t.documentList)("rows",10)("rowsPerPageOptions",e.DdM(19,Bo))("loading",t.loading)("rowHover",!0)("styleClass","p-datatable-gridlines p-datatable-sm border-3 "+t.color)("paginator",!0)("globalFilterFields",e.DdM(20,Go))("selection",t.selectedItem),e.xp6(7),e.Akn(e.DdM(21,Yo)),e.Q6J("header",t.tituloFormEditPedido)("visible",t.formulario)("modal",!0)("breakpoints",e.DdM(22,Ho))("maximizable",!0)("draggable",!1)("resizable",!1))},dependencies:[m.mk,m.O5,_.Fj,_.JJ,_.Q7,_.On,d.jx,v.Hq,v.zx,M.u,W.f,E.V,U.Lt,H.k,J.g,I.o,po.H,S.iA,S.UA,S.xl,x.FN,m.JJ,m.uU,co.E]});const jo=["filter"];class R{constructor(o,t,a,i,r,l,c,u){this.rutaActiva=o,this.adminService=t,this.comprasService=a,this.router=i,this.confirmationService=r,this.messageService=l,this.authService=c,this.sapService=u,this.urlBreadCrumb="",this.allSolpedMP=[],this.allSolpedMP2=[],this.proyecciones=[],this.proyeccionesBK=[],this.loadingProyecciones=!1,this.selectedProyecciones=[],this.solpedRequest=[],this.solpedRequestBK=[],this.loadingSR=!0,this.selectedSolpedR=[],this.pedidosPorCargar=[],this.pedidosPorCargarBK=[],this.loadingPxC=!0,this.selectedPedidosPxC=[],this.pedidosCargados=[],this.pedidosCargadosBK=[],this.loadingC=!0,this.selectedPedidosC=[],this.pedidosDocumentacion=[],this.pedidosDocumentacionBK=[],this.loadingD=!0,this.selectedPedidosD=[],this.pedidosDescargados=[],this.pedidosDescargadosBK=[],this.loadingPD=!0,this.selectedPedidosPD=[],this.entradasNT=[],this.entradasNTBK=[],this.loadingNT=!0,this.selectedEntradas=[],this.almacenes=[],this.statuses=[{label:"Abierta",value:"O"},{label:"Cerrada",value:"C"}],this.approves=[{label:"No aprobada",value:"No"},{label:"Aprobada",value:"A"},{label:"Pendiente",value:"P"},{label:"Rechazada",value:"R"}],this.tiposMateriaPrima=[{label:"Importada",value:"SI"},{label:"Nacional",value:"NO"},{label:"Todas",value:""}],this.tipoMateriaPrima="Todas"}ngOnInit(){this.infoUsuario=this.authService.getInfoUsuario(),this.perfilesUsuario=this.authService.getPerfilesUsuario(),this.permisosUsuario=this.authService.getPermisosUsuario(),this.permisosUsuarioPagina=this.permisosUsuario.filter(o=>o.url===this.router.url),this.urlBreadCrumb=this.router.url,this.getAlmacenesMPSL()}getAlmacenesMPSL(){this.sapService.getAlmacenesMPSL(this.authService.getToken()).subscribe({next:o=>{for(let t in o.value)this.almacenes.push({store:o.value[t].WarehouseCode,storename:o.value[t].WarehouseName,zonacode:o.value[t].State});this.getListadosTrackingMP()},error:o=>{console.log(o)}})}getListadosTrackingMP(){this.getSolpedRequest(),this.getPedidosPorCargar(),this.getPedidosCargados(),this.getPedidosConDocumentacion(),this.getPedidosDescargados(),this.getEntradasNacionalizadas()}getSolpedRequest(){this.comprasService.SolpedMP(this.authService.getToken(),"Request").subscribe({next:o=>{let t=[];for(let i of o.proyecciones)i.WarehouseName="",this.almacenes.filter(r=>r.store===i.WarehouseCode).length>0&&(i.WarehouseName=this.almacenes.filter(r=>r.store===i.WarehouseCode)[0].storename),i.U_NF_PEDMP="S"==i.U_NF_PEDMP?"SI":"NO",t.push(i);this.proyecciones=t,this.proyeccionesBK=t;let a=[];for(let i of o.solicitudesSAP)i.WarehouseName="",this.almacenes.filter(r=>r.store===i.WarehouseCode).length>0&&(i.WarehouseName=this.almacenes.filter(r=>r.store===i.WarehouseCode)[0].storename),i.U_NF_PEDMP="S"==i.U_NF_PEDMP?"SI":"NO",a.push(i);this.solpedRequest=a,this.solpedRequestBK=a},error:o=>{console.log(o)}})}getPedidosPorCargar(){var t,o=this;this.comprasService.PedidosdMP(this.authService.getToken(),"Solicitado").subscribe({next:(t=(0,C.Z)(function*(a){a.value&&(o.pedidosPorCargar=yield o.convertirObjetoSLtoArray(a),o.pedidosPorCargarBK=o.pedidosPorCargar)}),function(i){return t.apply(this,arguments)}),error:t=>{console.log(t)}})}getPedidosCargados(){var t,o=this;this.comprasService.PedidosdMP(this.authService.getToken(),"Cargado").subscribe({next:(t=(0,C.Z)(function*(a){a.value&&(o.pedidosCargados=yield o.convertirObjetoSLtoArray(a),o.pedidosCargadosBK=o.pedidosCargados)}),function(i){return t.apply(this,arguments)}),error:t=>{console.log(t)}})}getPedidosConDocumentacion(){}getPedidosDescargados(){var t,o=this;this.comprasService.PedidosdMP(this.authService.getToken(),"Pedidos en puerto").subscribe({next:(t=(0,C.Z)(function*(a){a.value&&(o.pedidosDescargados=yield o.convertirObjetoSLtoArray(a),o.pedidosDescargadosBK=o.pedidosDescargados)}),function(i){return t.apply(this,arguments)}),error:t=>{console.log(t)}})}getEntradasNacionalizadas(){var t,o=this;this.comprasService.EntradasMP(this.authService.getToken()).subscribe({next:(t=(0,C.Z)(function*(a){let i=[];for(let r in a){let l="";o.almacenes.filter(c=>c.store===a[r].WhsCode).length>0&&(l=o.almacenes.filter(c=>c.store===a[r].WhsCode)[0].storename),i.push({Comments:a[r].Comments,DocNum:a[r].DocNum,pedido:a[r].pedido,Incoterms:a[r].Incoterms,ItemCode:a[r].ItemCode,ItemDescription:a[r].Dscription,Description:`${a[r].ItemCode} - ${a[r].Dscription}`,LineNum:a[r].LineNum,Quantity:a[r].Quantity,RequriedDate:a[r].DocDueDate,U_NF_AGENTE:a[r].U_NF_AGENTE,U_NF_DATEOFSHIPPING:a[r].U_NF_DATEOFSHIPPING,U_NF_LASTSHIPPPING:a[r].U_NF_LASTSHIPPPING,U_NF_MOTONAVE:a[r].U_NF_MOTONAVE,U_NF_PAGO:a[r].U_NF_PAGO,U_NF_PUERTOSALIDA:a[r].U_NF_PUERTOSALIDA,U_NF_STATUS:a[r].U_NF_STATUS,U_NF_TIPOCARGA:a[r].U_NF_TIPOCARGA,U_NF_PEDMP:"S"==a[r].U_NF_PEDMP?"SI":"NO",WarehouseCode:a[r].WhsCode,WarehouseName:l,approved:"S",id:a[r].DocEntry,key:a[r].DocNum+"-"+a[r].LineNum,DocEntry:a[r].DocEntry,RemainingOpenQuantity:0,U_NT_Incoterms:a[r].U_NT_Incoterms,MeasureUnit:a[r].unitMsr,CardCode:a[r].CardCode,CardName:a[r].CardName,ProveedorDS:`${a[r].CardCode} - ${a[r].CardName}`})}console.log(i),o.entradasNT=i,o.entradasNTBK=i}),function(i){return t.apply(this,arguments)}),error:t=>{console.log(t)}})}filtrarTablas(){if(this.proyecciones=this.proyeccionesBK,this.solpedRequest=this.solpedRequestBK,this.pedidosPorCargar=this.pedidosPorCargarBK,this.pedidosCargados=this.pedidosCargadosBK,this.pedidosDescargados=this.pedidosDescargadosBK,this.entradasNT=this.entradasNTBK,"Todas"!=this.tipoMateriaPrima){let o=this.tiposMateriaPrima.filter(t=>t.label==this.tipoMateriaPrima)[0].value;this.proyecciones=this.proyecciones.filter(t=>t.U_NF_PEDMP==o),this.solpedRequest=this.solpedRequest.filter(t=>t.U_NF_PEDMP==o),this.pedidosPorCargar=this.pedidosPorCargar.filter(t=>t.U_NF_PEDMP==o),this.pedidosCargados=this.pedidosCargados.filter(t=>t.U_NF_PEDMP==o),this.pedidosDescargados=this.pedidosDescargados.filter(t=>t.U_NF_PEDMP==o),this.entradasNT=this.entradasNT.filter(t=>t.U_NF_PEDMP==o)}}reestablecerFiltro(){this.tipoMateriaPrima="Todas",this.filtrarTablas()}newSolped(){}convertirObjetoSLtoArray(o){let t=[];for(let a of o.value)for(let i of a.DocumentLines){let r="";this.almacenes.filter(l=>l.store===i.WarehouseCode).length>0&&(r=this.almacenes.filter(l=>l.store===i.WarehouseCode)[0].storename),t.push({Comments:a.Comments,DocNum:a.DocNum,Incoterms:i.Incoterms,ItemCode:i.ItemCode,ItemDescription:i.ItemDescription,Description:`${i.ItemCode} - ${i.ItemDescription}`,LineNum:i.LineNum,Quantity:i.Quantity,RequriedDate:a.DocDueDate,U_NF_AGENTE:a.U_NF_AGENTE,U_NF_DATEOFSHIPPING:a.U_NF_DATEOFSHIPPING,U_NF_LASTSHIPPPING:a.U_NF_LASTSHIPPPING,U_NF_MOTONAVE:a.U_NF_MOTONAVE,U_NF_PAGO:a.U_NF_PAGO,U_NF_PUERTOSALIDA:a.U_NF_PUERTOSALIDA,U_NF_STATUS:a.U_NF_STATUS,U_NF_TIPOCARGA:a.U_NF_TIPOCARGA,U_NF_PEDMP:"S"==a.U_NF_PEDMP?"SI":"NO",WarehouseCode:i.WarehouseCode,WarehouseName:r,approved:"S",id:a.DocEntry,key:a.DocNum+"-"+i.LineNum,DocEntry:a.DocEntry,RemainingOpenQuantity:i.RemainingOpenQuantity,U_NT_Incoterms:a.U_NT_Incoterms,MeasureUnit:i.MeasureUnit,CardCode:a.CardCode,CardName:a.CardName,ProveedorDS:`${a.CardCode} - ${a.CardName}`})}return t}updateTable(o){this.getSolpedRequest(),this.getPedidosPorCargar(),this.getPedidosCargados(),this.getPedidosConDocumentacion(),this.getPedidosDescargados(),this.getEntradasNacionalizadas()}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}}R.\u0275fac=function(o){return new(o||R)(e.Y36(f.gz),e.Y36($.l),e.Y36(y.K),e.Y36(f.F0),e.Y36(d.YP),e.Y36(d.ez),e.Y36(T.e),e.Y36(Z.c))},R.\u0275cmp=e.Xpm({type:R,selectors:[["app-tracking-mp"]],viewQuery:function(o,t){if(1&o&&e.Gf(jo,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},features:[e._Bn([d.ez,d.YP])],decls:19,vars:41,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12"],[1,"card"],[1,"field","col-2"],["for","tipoMateriaPrima"],["optionLabel","label","optionValue","label","styleClass","w-full","id","tipoMateriaPrima","name","tipoMateriaPrima",3,"options","ngModel","required","ngModelChange","onChange"],[1,"field","col-2","flex","align-content-end","flex-wrap"],["pButton","","pTooltip","Limpiar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["nombreLista","solpedRequest","color","border-bluegray-200","titulo","Proyecciones",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","showDeleteSolped","onChangeTabla"],["nombreLista","solpedRequest","color","border-bluegray-500","titulo","Solicitudes de compra",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","onChangeTabla"],["nombreLista","pedidosPorCargar","color","border-cyan-500","titulo","Pedidos pendientes x cargar",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","onChangeTabla"],["nombreLista","pedidosCargados","color","border-pink-500","titulo","Pedidos cargados",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","onChangeTabla"],["nombreLista","pedidosDescargados","color","border-yellow-500","titulo","Pedidos en puerto",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","onChangeTabla"],["nombreLista","entradasNT","color","border-teal-500","titulo","Entradas - Nacionalizadas",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","onChangeTabla"]],template:function(o,t){1&o&&(e._UZ(0,"app-breadcrumb",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"h6"),e._uU(5,"Filtros generales"),e.qZA(),e.TgZ(6,"div",1)(7,"div",4)(8,"label",5),e._uU(9,"Tipo Materia prima"),e.qZA(),e.TgZ(10,"p-dropdown",6),e.NdJ("ngModelChange",function(i){return t.tipoMateriaPrima=i})("onChange",function(){return t.filtrarTablas()}),e.qZA()(),e.TgZ(11,"div",7)(12,"button",8),e.NdJ("click",function(){return t.reestablecerFiltro()}),e.qZA()()()()()(),e.TgZ(13,"app-table-solped-mp",9),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA(),e.TgZ(14,"app-table-solped-mp",10),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA(),e.TgZ(15,"app-table-solped-mp",11),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA(),e.TgZ(16,"app-table-solped-mp",12),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA(),e.TgZ(17,"app-table-solped-mp",13),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA(),e.TgZ(18,"app-table-solped-mp",14),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA()),2&o&&(e.Q6J("urlBreadCrumb",t.urlBreadCrumb),e.xp6(10),e.Q6J("options",t.tiposMateriaPrima)("ngModel",t.tipoMateriaPrima)("required",!0),e.xp6(3),e.Q6J("documentList",t.proyecciones)("loading",!0)("documento","Proyecciones")("showNuevo",!0)("showEditar",!0)("showEnvioSAP",!0)("showDeleteSolped",!0),e.xp6(1),e.Q6J("documentList",t.solpedRequest)("loading",!0)("documento","Solped")("showNuevo",!1)("showEditar",!0)("showEnvioSAP",!1),e.xp6(1),e.Q6J("documentList",t.pedidosPorCargar)("loading",!0)("documento","Pedido")("showNuevo",!1)("showEditar",!0)("showEnvioSAP",!1),e.xp6(1),e.Q6J("documentList",t.pedidosCargados)("loading",!0)("documento","Pedido")("showNuevo",!1)("showEditar",!0)("showEnvioSAP",!1),e.xp6(1),e.Q6J("documentList",t.pedidosDescargados)("loading",!0)("documento","Pedido")("showNuevo",!1)("showEditar",!0)("showEnvioSAP",!1),e.xp6(1),e.Q6J("documentList",t.entradasNT)("loading",!0)("documento","Entrada")("showNuevo",!1)("showEditar",!1)("showEnvioSAP",!1))},dependencies:[_.JJ,_.Q7,_.On,v.Hq,M.u,U.Lt,L.L,Q]});var ue=s(7453);const $o=["filter"];function Vo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.newSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].create_accion)}}function Xo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.editSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("pTooltip",t.permisosUsuarioPagina[0].update_accion?"Editar":"Consultar")("icon",t.permisosUsuarioPagina[0].update_accion?"pi pi-pencil":"pi pi-search")("disabled",!t.permisosUsuarioPagina[0].read_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function Wo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.solicitudAprobacion())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].update_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function ei(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.cancelarSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].update_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function ti(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.aprobar())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].aproved_accion||!t.selectedSolped||0==t.selectedSolped.length)}}function oi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.rechazar())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].aproved_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function ii(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",28)(1,"div")(2,"button",29),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(5);return e.KtG(i.clear(r))}),e.qZA(),e.YNc(3,Vo,1,1,"button",30),e.YNc(4,Xo,1,3,"button",31),e.YNc(5,Wo,1,1,"button",32),e.YNc(6,ei,1,1,"button",33),e.YNc(7,ti,1,1,"button",34),e.YNc(8,oi,1,1,"button",35),e.qZA(),e.TgZ(9,"span",36),e._UZ(10,"i",37),e.TgZ(11,"input",38,39),e.NdJ("input",function(i){e.CHM(t);const r=e.oxw(),l=e.MAs(5);return e.KtG(r.onGlobalFilter(l,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.permisosUsuarioPagina[0].create_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].aproved_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].aproved_accion)}}function ai(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function ni(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",59),e.NdJ("onChange",function(i){const l=e.CHM(t).filterCallback;return e.KtG(l(i.value))}),e.YNc(1,ai,2,3,"ng-template",60),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.statuses)}}function ri(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function li(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",59),e.NdJ("onChange",function(i){const l=e.CHM(t).filterCallback;return e.KtG(l(i.value))}),e.YNc(1,ri,2,3,"ng-template",60),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.approves)}}function si(n,o){1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",46),e.TgZ(2,"th")(3,"div",47),e._uU(4," Id "),e._UZ(5,"p-columnFilter",48),e.qZA()(),e.TgZ(6,"th")(7,"div",47),e._uU(8," Tipo "),e._UZ(9,"p-columnFilter",49),e.qZA()(),e.TgZ(10,"th")(11,"div",47),e._uU(12," Fecha contabilizaci\xf3n "),e._UZ(13,"p-columnFilter",50),e.qZA()(),e.TgZ(14,"th")(15,"div",47),e._uU(16," Fecha necesaria "),e._UZ(17,"p-columnFilter",51),e.qZA()(),e.TgZ(18,"th")(19,"div",47),e._uU(20," Comentarios "),e._UZ(21,"p-columnFilter",52),e.qZA()(),e.TgZ(22,"th")(23,"div",47),e._uU(24," \xc1rea "),e._UZ(25,"p-columnFilter",53),e.qZA()(),e.TgZ(26,"th")(27,"div",47),e._uU(28," Estado "),e.TgZ(29,"p-columnFilter",54),e.YNc(30,ni,2,2,"ng-template",55),e.qZA()()(),e.TgZ(31,"th")(32,"div",47),e._uU(33," Aprobada? "),e.TgZ(34,"p-columnFilter",56),e.YNc(35,li,2,2,"ng-template",55),e.qZA()()(),e.TgZ(36,"th")(37,"div",47),e._uU(38," Usuario "),e._UZ(39,"p-columnFilter",57),e.qZA()(),e.TgZ(40,"th")(41,"div",47),e._uU(42," N\xfamero solped SAP "),e._UZ(43,"p-columnFilter",58),e.qZA()(),e._UZ(44,"th")(45,"th"),e.qZA()),2&n&&(e.xp6(29),e.Q6J("showMatchModes",!1)("showOperator",!1),e.xp6(5),e.Q6J("showMatchModes",!1)("showOperator",!1))}function di(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"i",66),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw();return e.KtG(r.mostrarAprobaciones(i.id))}),e.qZA()}}function pi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",61),e.qZA(),e.TgZ(3,"td",62),e._uU(4),e.qZA(),e.TgZ(5,"td",62),e._uU(6),e.qZA(),e.TgZ(7,"td",63),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",63),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"td",63),e._uU(14),e.qZA(),e.TgZ(15,"td",63),e._uU(16),e.qZA(),e.TgZ(17,"td",63),e._uU(18),e.ALo(19,"estados"),e.qZA(),e.TgZ(20,"td",63),e._uU(21),e.ALo(22,"estados"),e.qZA(),e.TgZ(23,"td",63),e._uU(24),e.qZA(),e.TgZ(25,"td",63),e._uU(26),e.qZA(),e.TgZ(27,"td"),e.YNc(28,di,1,0,"i",64),e.qZA(),e.TgZ(29,"td")(30,"i",65),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.mostrarAadjuntos(r.id))}),e.qZA()()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.id," "),e.xp6(2),e.hij(" ",t.serieStr," "),e.xp6(2),e.hij(" ",e.lcZ(9,13,t.docdate)," "),e.xp6(3),e.hij(" ",e.lcZ(12,15,t.reqdate)," "),e.xp6(3),e.hij(" ",t.comments," "),e.xp6(2),e.hij(" ",t.u_nf_depen_solped," "),e.xp6(2),e.hij(" ",e.xi3(19,17,t.status,"solped")," "),e.xp6(3),e.AsE(" ",e.xi3(22,20,t.approved,"aprobacion"),""," "+t.aprobador," "),e.xp6(3),e.hij(" ",t.fullname," "),e.xp6(2),e.hij(" ",t.sapdocnum," "),e.xp6(2),e.Q6J("ngIf","N"!=t.approved)}}function ci(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",67),e._uU(2,"No se econtraron solicitudes de pedido."),e.qZA()())}function ui(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",67),e._uU(2,"Cargando solicitudes de pedido. Por favor espere"),e.qZA()())}function mi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",68)(1,"div",69),e._UZ(2,"i",70),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",71)(8,"div",72)(9,"button",73),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirm())}),e.qZA()(),e.TgZ(10,"div",72)(11,"button",74),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onReject())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function _i(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",68)(1,"div",69),e._UZ(2,"i",70),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",71)(8,"div",72)(9,"button",73),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmAp())}),e.qZA()(),e.TgZ(10,"div",72)(11,"button",74),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectAp())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function hi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",68)(1,"div",69),e._UZ(2,"i",70),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",71)(8,"div",72)(9,"button",73),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmRap())}),e.qZA()(),e.TgZ(10,"div",72)(11,"button",74),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectRap())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function gi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",68)(1,"div",69),e._UZ(2,"i",70),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",71)(8,"div",72)(9,"button",73),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmCancel())}),e.qZA()(),e.TgZ(10,"div",72)(11,"button",74),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectCancel())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function fi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",75),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.rechazarSolped())}),e.qZA()}}function Ci(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",28)(1,"div")(2,"button",29),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(31);return e.KtG(i.clear(r))}),e.qZA()(),e.TgZ(3,"span",36),e._UZ(4,"i",37),e.TgZ(5,"input",38,39),e.NdJ("input",function(i){e.CHM(t);const r=e.oxw(),l=e.MAs(31);return e.KtG(r.onGlobalFilter(l,i))}),e.qZA()()()}}function bi(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function Si(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",76),e.NdJ("onChange",function(i){const l=e.CHM(t).filterCallback;return e.KtG(l(i.value))}),e.YNc(1,bi,2,3,"ng-template",60),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.approves)}}function vi(n,o){1&n&&(e.TgZ(0,"tr")(1,"th")(2,"div",47),e._uU(3," Nivel "),e._UZ(4,"p-columnFilter",48),e.qZA()(),e.TgZ(5,"th")(6,"div",47),e._uU(7," Fecha envio solicitud "),e._UZ(8,"p-columnFilter",50),e.qZA()(),e.TgZ(9,"th")(10,"div",47),e._uU(11," Aprbador "),e._UZ(12,"p-columnFilter",49),e.qZA()(),e.TgZ(13,"th")(14,"div",47),e._uU(15," Estado "),e.TgZ(16,"p-columnFilter",56),e.YNc(17,Si,2,2,"ng-template",55),e.qZA()()(),e.TgZ(18,"th")(19,"div",47),e._uU(20," Fecha aprobaci\xf3n "),e._UZ(21,"p-columnFilter",51),e.qZA()(),e.TgZ(22,"th")(23,"div",47),e._uU(24," Comentarios "),e._UZ(25,"p-columnFilter",52),e.qZA()()()),2&n&&(e.xp6(16),e.Q6J("showMatchModes",!1)("showOperator",!1))}function Ti(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",63),e._uU(2),e.qZA(),e.TgZ(3,"td",63),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td",63),e._uU(7),e.qZA(),e.TgZ(8,"td",63),e._uU(9),e.ALo(10,"estados"),e.qZA(),e.TgZ(11,"td",63),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td",63),e._uU(15),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t.nivel," "),e.xp6(2),e.hij(" ",e.lcZ(5,6,t.created_at)," "),e.xp6(3),e.hij(" ",t.nombreaprobador," "),e.xp6(2),e.hij(" ",e.xi3(10,8,t.estadoap,"aprobacion")," "),e.xp6(3),e.hij(" ","P"!=t.estadoap?e.lcZ(13,11,t.updated_at):""," "),e.xp6(3),e.hij(" ",t.comments," ")}}function yi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",75),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.dialogAprobaciones=!1)}),e.qZA()}}function xi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",28)(1,"div")(2,"button",29),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(31);return e.KtG(i.clear(r))}),e.qZA()(),e.TgZ(3,"span",36),e._UZ(4,"i",37),e.TgZ(5,"input",38,39),e.NdJ("input",function(i){e.CHM(t);const r=e.oxw(),l=e.MAs(31);return e.KtG(r.onGlobalFilter(l,i))}),e.qZA()()()}}function Ai(n,o){1&n&&(e.TgZ(0,"tr")(1,"th")(2,"div",47),e._uU(3," Tipo "),e._UZ(4,"p-columnFilter",77),e.qZA()(),e.TgZ(5,"th")(6,"div",47),e._uU(7," Nombre "),e._UZ(8,"p-columnFilter",78),e.qZA()(),e.TgZ(9,"th")(10,"div",47),e._uU(11," Tama\xf1o "),e.qZA()(),e.TgZ(12,"th")(13,"div",47),e._uU(14," Fecha creaci\xf3n "),e._UZ(15,"p-columnFilter",50),e.qZA()(),e.TgZ(16,"th")(17,"div",79),e._UZ(18,"i",80),e.qZA()()())}function Zi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",63),e._uU(2),e.qZA(),e.TgZ(3,"td",63),e._uU(4),e.qZA(),e.TgZ(5,"td",63),e._uU(6),e.qZA(),e.TgZ(7,"td",63),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",81)(11,"p-button",82),e.NdJ("onClick",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.downloadAnexo(r.id,r.id_solped))}),e.qZA()()()}if(2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t.tipo," "),e.xp6(2),e.hij(" ",t.nombre," "),e.xp6(2),e.hij(" ",t.size," "),e.xp6(2),e.hij(" ",e.lcZ(9,4,t.created_at)," ")}}function Mi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",83),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.dialogAdjuntos=!1)}),e.qZA()}}const Ui=function(){return{height:"6px"}};function Ni(n,o){1&n&&(e.TgZ(0,"div",18),e._UZ(1,"p-progressBar",84),e.qZA()),2&n&&(e.xp6(1),e.Akn(e.DdM(2,Ui)))}const ie=function(){return["serie","status","sapdocnum","approved","u_nf_depen_solped","taxtdate","reqdate","fullname"]},X=function(){return{width:"50vw"}},wi=function(n){return{"ng-invalid ng-dirty":n}};class K{constructor(o,t,a,i,r,l,c,u){this.rutaActiva=o,this.adminService=t,this.sapService=a,this.comprasService=i,this.router=r,this.confirmationService=l,this.messageService=c,this.authService=u,this.solped=[],this.loading=!0,this.errorFechaAprobacion=!1,this.arrayErrorFecha=[],this.errorTrmAprobacion=!1,this.arrayIdSolped=[],this.frmRechazo=!1,this.motivoRechazo="",this.submitRechazo=!1,this.errorUsuarioAprobador=!1,this.arrayErrorUsuarioAprobador=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSopledARechazada=!1,this.arraySolpedRechazadas=[],this.arraryErrorTrm=[],this.selectedSolped=[],this.dialogAprobaciones=!1,this.loadingAp=!0,this.urlBreadCrumb="",this.dialogAdjuntos=!1,this.series=[],this.listaDocumentosSolped=[],this.loadingDocumentos=!0,this.displayModal=!1,this.loadingCargue=!1}ngOnInit(){this.infoUsuario=this.authService.getInfoUsuario(),this.perfilesUsuario=this.authService.getPerfilesUsuario(),this.permisosUsuario=this.authService.getPermisosUsuario(),this.permisosUsuarioPagina=this.permisosUsuario.filter(o=>o.url===this.router.url),this.urlBreadCrumb=this.router.url,this.statuses=[{label:"Abierta",value:"O"},{label:"Cerrada",value:"C"}],this.approves=[{label:"No enviada",value:"N"},{label:"Aprobada",value:"A"},{label:"Pendiente",value:"P"},{label:"Rechazada",value:"R"}],this.getSeries()}getSeries(){this.sapService.seriesDocXEngineSAP(this.authService.getToken(),"1470000113").subscribe({next:o=>{for(let t in o)this.series.push(o[t]);console.log(this.series),this.getListado()},error:o=>{console.log(o)}})}newSolped(){this.router.navigate(["/portal/compras/solped/nueva"])}editSolped(){this.router.navigate(["/portal/compras/solped/editar",this.selectedSolped[0].id])}confirm(){this.confirmationService.confirm({message:"Are you sure that you want to proceed?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{this.messageService.add({severity:"info",summary:"Confirmed",detail:"You have accepted"})},reject:o=>{switch(o){case d.wB.REJECT:this.messageService.add({severity:"error",summary:"Rejected",detail:"You have rejected"});break;case d.wB.CANCEL:this.messageService.add({severity:"warn",summary:"Cancelled",detail:"You have cancelled"})}}})}mostrarAprobaciones(o){this.dialogAprobaciones=!0,this.comprasService.aprobacionesSolped(this.authService.getToken(),o).subscribe({next:t=>{this.listaAprobaciones=t,this.loadingAp=!1},error:t=>{console.log(t)}})}mostrarAadjuntos(o){this.dialogAdjuntos=!0,this.comprasService.solpedById(this.authService.getToken(),o).subscribe({next:t=>{console.log(t.anexos),this.listaDocumentosSolped=t.anexos,this.loadingDocumentos=!1},error:t=>{console.log(t)}})}downloadAnexo(o,t){var a=this;return(0,C.Z)(function*(){let i=a.listaDocumentosSolped.filter(r=>r.id===o)[0];var r;a.comprasService.getAnexoSolped(a.authService.getToken(),o,t).subscribe({next:(r=(0,C.Z)(function*(l){if(""!==l.data){const c=`data:application/pdf;base64,${l.data}`,u=document.createElement("a");u.href=c,u.download=`${i.nombre}`,u.click()}else a.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:"No existe documento cargado en la base de datos"})}),function(c){return r.apply(this,arguments)}),error:r=>{console.log(r)}})})()}base64toBlob(o,t=""){return(0,C.Z)(function*(){const i=atob(o),r=i.length,l=Math.ceil(r/1024),c=new Array(l);for(let u=0;u<l;u+=1){const p=1024*u,g=Math.min(p+1024,r),G=new Array(g-p);for(let A=p,Y=0;A<g;Y+=1,A+=1)G[Y]=i[A].charCodeAt(0);c[u]=new Uint8Array(G)}return new Blob(c,{type:t})})()}cancelarSolped(){let o=[];new Date,this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[];for(let i of this.selectedSolped)"C"===i.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(i.id)),"P"===i.approved&&(this.errorSolpedEnviada=!0,this.arrayErrorSolpedEnviada.push(i.id)),"A"===i.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(i.id)),o.push(i.id);this.arrayIdSolped=o;let a="";this.errorSolpedCancelada?(a=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSolpedCancelada=!1):this.errorSolpedEnviada?(a=this.arrayErrorSolpedEnviada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya han sido enviadas a aprobaci\xf3n.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya ha sido enviada a aprobaci\xf3n`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSolpedEnviada=!1):(a=o.length>1?"\xbfDesea Continuar con la cancelaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la cancelaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"cdel",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:a}))}solicitudAprobacion(){let a,o=[],t=new Date;this.errorFechaAprobacion=!1,this.arrayErrorFecha=[],this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorTrmAprobacion=!1,this.arraryErrorTrm=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[];for(let r of this.selectedSolped)a=new Date(r.docdate),"C"===r.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(r.id)),a.toDateString()!==t.toDateString()&&(this.errorFechaAprobacion=!0,this.arrayErrorFecha.push(r.id)),"P"===r.approved&&(this.errorSolpedEnviada=!0,this.arrayErrorSolpedEnviada.push(r.id)),"A"===r.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(r.id)),0===r.trm&&(this.errorTrmAprobacion=!0,this.arraryErrorTrm.push(r.id)),o.push(r.id);this.arrayIdSolped=o;let i="";this.errorSolpedCancelada?(i=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSolpedCancelada=!1):this.errorTrmAprobacion?(i=this.arraryErrorTrm.length>1?`Las solicitudes ${JSON.stringify(this.arraryErrorTrm)} no poseen TRM, por favor acutalice la TRM en las sulicitudes`:`La solicitud ${JSON.stringify(this.arraryErrorTrm)} no posee TRM, por favor acutalice la TRM de la sulicitud`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorTrmAprobacion=!1):this.errorSopledAprobada?(i=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha fue aprobada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSopledAprobada=!1):this.errorSolpedEnviada?(i=this.arrayErrorSolpedEnviada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya han sido enviadas a aprobaci\xf3n.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya ha fue enviada a aprobaci\xf3n`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSolpedEnviada=!1):(i=this.errorFechaAprobacion?this.arrayErrorFecha.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorFecha)} tienen fechas de contabilizaci\xf3n diferentes a la fecha actual. \n                       Recuerde que la TRM de la aprobaci\xf3n sera basada en la fecha de contabilizaci\xf3n de la solicitud.\n                       \xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas? `:`La fecha de contabilizaci\xf3n de la solicitud ${JSON.stringify(this.arrayErrorFecha)}  es diferente a la fecha actual. \n            Recuerde que la TRM de la aprobaci\xf3n sera basada en la fecha de contabilizaci\xf3n de la solicitud.\n            \xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada? `:o.length>1?"\xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"c",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:i}))}onConfirm(){this.loadingCargue=!0,this.displayModal=!0,this.loading=!0;let o="";this.messageService.clear("c"),this.comprasService.envioAprobacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{this.loadingCargue=!1,this.displayModal=!1,0===t.filter(a=>"error"===a.status).length?(o=this.selectedSolped.length>1?"Las solicitudes seleccionadas, han sido enviadas a aprobaci\xf3n":"Las solicitud seleccionada, ha sido enviada a aprobaci\xf3n",this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:o}),this.getListado()):(this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t[0].message}))},error:t=>{console.log(t),this.loading=!1,this.loadingCargue=!1,this.displayModal=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}rechazar(){this.arrayIdSolped=[];let o=[];this.arraySolpedRechazadas=[],this.arraySolpedAprobadas=[],this.arrayErrorUsuarioAprobador=[],this.errorSopledARechazada=!1,this.errorSopledAprobada=!1,this.errorUsuarioAprobador=!1;for(let a of this.selectedSolped)"R"===a.approved&&(this.errorSopledARechazada=!0,this.arraySolpedRechazadas.push(a.id)),"A"===a.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(a.id)),a.usersapaprobador!==this.infoUsuario.codusersap&&(this.errorUsuarioAprobador=!0,this.arrayErrorUsuarioAprobador.push(a.id)),o.push(a.id);this.arrayIdSolped=o;let t="";this.errorSopledARechazada?(t=this.arraySolpedRechazadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedRechazadas)} ya fueron rechazadas.`:`La solicitud ${JSON.stringify(this.arraySolpedRechazadas)} ya fue rechazada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledARechazada=!1):this.errorSopledAprobada?(t=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha sido aprobada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledAprobada=!1):this.errorUsuarioAprobador?(t=this.arrayErrorUsuarioAprobador.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no pueden ser rechazadas por el usuario por ahora.`:`La solicitud ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no puede ser rechazada por el usuario por ahora.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorUsuarioAprobador=!1):(t=o.length>1?"\xbfDesea Continuar con el rechazo de las solicitudes seleccionadas?":"\xbfDesea Continuar con el rechazo de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"rj",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:t}))}aprobar(){this.arrayIdSolped=[];let o=[];this.arraySolpedRechazadas=[],this.arraySolpedAprobadas=[],this.arrayErrorUsuarioAprobador=[],this.errorSopledARechazada=!1,this.errorSopledAprobada=!1,this.errorUsuarioAprobador=!1,this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[];for(let a of this.selectedSolped)"R"===a.approved&&(this.errorSopledARechazada=!0,this.arraySolpedRechazadas.push(a.id)),"C"===a.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(a.id)),"A"===a.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(a.id)),a.usersapaprobador!==this.infoUsuario.codusersap&&(this.errorUsuarioAprobador=!0,this.arrayErrorUsuarioAprobador.push(a.id)),o.push(a.id);this.arrayIdSolped=o;let t="";this.errorSolpedCancelada?(t=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSolpedCancelada=!1):this.errorSopledARechazada?(t=this.arraySolpedRechazadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedRechazadas)} ya fueron rechazadas.`:`La solicitud ${JSON.stringify(this.arraySolpedRechazadas)} ya fue rechazada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledARechazada=!1):this.errorSopledAprobada?(t=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha sido aprobada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledAprobada=!1):this.errorUsuarioAprobador?(t=this.arrayErrorUsuarioAprobador.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no pueden ser aprobadas por el usuario por ahora.`:`La solicitud ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no puede ser aprobada por el usuario por ahora.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorUsuarioAprobador=!1):(t=o.length>1?"\xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"ap",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:t}))}onReject(){this.messageService.clear("c"),this.errorFechaAprobacion=!1}onRejectAp(){this.messageService.clear("ap"),console.log(this.arrayIdSolped)}onRejectRap(){this.messageService.clear("rj")}onRejectCancel(){this.messageService.clear("cdel")}onConfirmCancel(){this.loadingCargue=!0,this.displayModal=!0,this.loading=!0;let o="";this.messageService.clear("cdel"),this.comprasService.cancelacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{this.loadingCargue=!1,this.displayModal=!1,"ok"==t.status?(o=this.arrayIdSolped.length>1?"La cancelaci\xf3n de las solicitudes seleccionadas fueron realizadas correctamente":"La cancelaci\xf3n de la solicitud seleccionada fue realizada correctamente",this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:o}),this.getListado()):(this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t.message}),this.loading=!1)},error:t=>{console.log(t),this.loading=!1,this.loadingCargue=!1,this.displayModal=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}onConfirmRap(){this.messageService.clear("rj"),this.frmRechazo=!0}rechazarSolped(){this.loadingCargue=!0,this.displayModal=!0,this.submitRechazo=!0,this.motivoRechazo?this.comprasService.aprobacionesSolped(this.authService.getToken(),this.selectedSolped[0].id).subscribe({next:o=>{let t=o.filter(i=>i.usersapaprobador===this.infoUsuario.codusersap&&"A"===i.estadoseccion&&"P"===i.estadoap);this.comprasService.rechazoSolped({autor:{fullname:t[0].nombreautor,email:t[0].emailautor},aprobador:{fullname:t[0].nombreaprobador,email:t[0].emailaprobador,usersap:t[0].usersapaprobador},infoSolped:{id_solped:this.selectedSolped[0].id,idlineap:t[0].id,bdmysql:this.infoUsuario.bdmysql,companysap:this.infoUsuario.dbcompanysap,logo:this.infoUsuario.logoempresa,comments:this.motivoRechazo}}).subscribe({next:i=>{this.loadingCargue=!1,this.displayModal=!1,"ok"===i[0].status?(this.getListado(),this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:i[0].message}),this.frmRechazo=!1):this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i[0].message})},error:i=>{this.loadingCargue=!1,this.displayModal=!1,console.log(i)}})},error:o=>{console.log(o),this.loadingCargue=!1,this.displayModal=!1}}):this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:"Debe diligenciar el motivo por el cual desea rechazar la solicitud seleccionada"})}onConfirmAp(){this.loadingCargue=!0,this.displayModal=!0,this.loading=!0,this.messageService.clear("ap"),this.comprasService.aprobacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{console.log(t),this.loadingCargue=!1,this.displayModal=!1;let a=[];if(t[0].status&&"error"==t[0].status)this.messageService.add({key:"t1",severity:"error",summary:"!Error",detail:t[0].message});else{if(t[0].arrayErrors.length>0){for(let i of t.arrayErrors)a.push({key:"tl",severity:"error",summary:"!Error",detail:i.messageSolped,life:5e3});if(t[0].arrayAproved.length>0){a.push({key:"tl",severity:"warn",summary:"!informaci\xf3n",detail:"Es posible que las siguentes solicitudes no se lograran guardar debido a los errores presentados.",life:5e3});for(let i of t[0].arrayAproved)a.push({key:"tl",severity:"warn",summary:"!informaci\xf3n",detail:i.messageSolped,life:5e3})}}else if(t[0].arrayAproved.length>0)for(let i of t[0].arrayAproved)a.push({key:"tl",severity:"success",summary:"!Ok",detail:i.messageSolped,life:5e3});this.getListado(),this.messageService.addAll(a)}},error:t=>{this.loading=!1,this.loadingCargue=!1,this.displayModal=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}clearToast(){this.messageService.clear()}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}getListado(){this.comprasService.listSolped(this.authService.getToken()).subscribe({next:o=>{this.loading=!1;for(let t of o)console.log(t.serie),console.log(this.series.filter(a=>a.code==t.serie)),""!==t.serie&&(t.serieStr=this.series.filter(a=>a.code==t.serie)[0].name);this.solped=o,console.log(this.solped),this.loading=!1},error:o=>{console.log(o)}})}}K.\u0275fac=function(o){return new(o||K)(e.Y36(f.gz),e.Y36($.l),e.Y36(Z.c),e.Y36(y.K),e.Y36(f.F0),e.Y36(d.YP),e.Y36(d.ez),e.Y36(T.e))},K.\u0275cmp=e.Xpm({type:K,selectors:[["app-solped"]],viewQuery:function(o,t){if(1&o&&e.Gf($o,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},features:[e._Bn([d.ez,d.YP])],decls:49,vars:63,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12"],[1,"card"],["dataKey","id","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["key","tl"],["key","c",3,"baseZIndex","onClose"],["pTemplate","message"],["key","ap",3,"baseZIndex","onClose"],["key","rj",3,"baseZIndex","onClose"],["key","cdel",3,"baseZIndex","onClose"],["header","Motivo rechazo solped",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],[1,"field","col"],["pInputTextarea","","styleClass","w-full","rows","10",1,"w-full","h-full",3,"ngModel","ngClass","ngModelChange"],["pTemplate","footer"],["header","Proceso de aprobaci\xf3n",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","id","styleClass","p-datatable-gridlines p-datatable-sm ","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields"],["dt2",""],["header","Documentos adjuntos de solped",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["header","Cargando",3,"visible","modal","draggable","resizable","visibleChange"],[1,"m-0"],["class","field col",4,"ngIf"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","pTooltip","Limpiar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-success p-button-sm","icon","pi pi-plus",3,"disabled","click",4,"ngIf"],["pButton","","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-secondary p-button-sm",3,"pTooltip","icon","disabled","click",4,"ngIf"],["pButton","","pTooltip","Enviar a aprobaci\xf3n","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-warning p-button-sm","icon","pi pi-send",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-danger p-button-sm","icon","pi pi-trash",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Aprobar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-help p-button-sm","icon","pi pi-check-circle",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Rechazar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-danger p-button-sm","icon","pi pi-times-circle",3,"disabled","click",4,"ngIf"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar por palabra clave",1,"w-full","p-inputtext-sm",3,"input"],["filter",""],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-plus",1,"p-button-outlined","mb-2","mr-2","p-button-success","p-button-sm",3,"disabled","click"],["pButton","","tooltipPosition","bottom","placeholder","Bottom",1,"p-button-outlined","mb-2","mr-2","p-button-secondary","p-button-sm",3,"pTooltip","icon","disabled","click"],["pButton","","pTooltip","Enviar a aprobaci\xf3n","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-send",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Aprobar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-check-circle",1,"p-button-outlined","mb-2","mr-2","p-button-help","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Rechazar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-times-circle",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],[2,"width","3rem"],[1,"flex","justify-content-between","align-items-center"],["type","text","field","id","display","menu","placeholder","Buscar por c\xf3digo solped"],["type","text","field","serie","display","menu","placeholder","Buscar por tipo solped"],["type","date","field","docdate","display","menu"],["type","date","field","reqdate","display","menu"],["type","text","field","comments","display","menu","placeholder","Buscar por comentario"],["type","text","field","u_nf_depen_solped","display","menu","placeholder","Buscar por area"],["field","status","matchMode","equals","display","menu","placeholder","Buscar por estado",3,"showMatchModes","showOperator"],["pTemplate","filter"],["field","approved","display","menu","matchMode","equals","placeholder","Buscar por aprobaci\xf3n",3,"showMatchModes","showOperator"],["type","text","field","fullname","display","menu","placeholder","Buscar por usuario"],["type","text","field","sapsocnum","display","menu","placeholder","Buscar por c\xf3digo SAP"],["placeholder","Cualquiera",3,"ngModel","options","onChange"],["pTemplate","item"],[3,"value"],[2,"min-width","6rem"],[2,"min-width","12rem"],["class","pi pi-check-square","pTooltip","Aprobaciones","tooltipPosition","left",3,"click",4,"ngIf"],["pTooltip","Adjuntos","tooltipPosition","left",1,"pi","pi-file-pdf",3,"click"],["pTooltip","Aprobaciones","tooltipPosition","left",1,"pi","pi-check-square",3,"click"],["colspan","11",1,"text-center"],[1,"flex","flex-column",2,"flex","1"],[1,"text-center"],[1,"pi","pi-exclamation-triangle",2,"font-size","3rem"],[1,"grid","p-fluid"],[1,"col-6"],["type","button","pButton","","label","Si",1,"p-button-success",3,"click"],["type","button","pButton","","label","No",1,"p-button-secondary",3,"click"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"click"],["placeholder","Any",3,"ngModel","options","onChange"],["type","text","field","tipo","display","menu","placeholder","Buscar por tipo documento"],["type","text","field","nombre","display","menu","placeholder","Buscar por nombre documento"],[1,"align-content-center","justify-content-center"],["pTooltip","Adjuntos","tooltipPosition","left",1,"pi","pi-file-pdf"],[2,"min-width","4rem"],["label","Descargar","icon","pi pi-download","iconPos","left",1,"w-full",3,"onClick"],["icon","pi pi-check","label","Cerrar","styleClass","p-button-text",3,"click"],["mode","indeterminate"]],template:function(o,t){1&o&&(e._UZ(0,"app-breadcrumb",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"p-table",4,5),e.NdJ("selectionChange",function(i){return t.selectedSolped=i}),e.YNc(6,ii,13,6,"ng-template",6),e.YNc(7,si,46,4,"ng-template",7),e.YNc(8,pi,31,23,"ng-template",8),e.YNc(9,ci,3,0,"ng-template",9),e.YNc(10,ui,3,0,"ng-template",10),e.qZA()()()(),e._UZ(11,"p-toast",11),e.TgZ(12,"p-toast",12),e.NdJ("onClose",function(){return t.onReject()}),e.YNc(13,mi,12,2,"ng-template",13),e.qZA(),e.TgZ(14,"p-toast",14),e.NdJ("onClose",function(){return t.onRejectAp()}),e.YNc(15,_i,12,2,"ng-template",13),e.qZA(),e.TgZ(16,"p-toast",15),e.NdJ("onClose",function(){return t.onRejectRap()}),e.YNc(17,hi,12,2,"ng-template",13),e.qZA(),e.TgZ(18,"p-toast",16),e.NdJ("onClose",function(){return t.onRejectCancel()}),e.YNc(19,gi,12,2,"ng-template",13),e.qZA(),e.TgZ(20,"p-dialog",17),e.NdJ("visibleChange",function(i){return t.frmRechazo=i}),e.TgZ(21,"div",1)(22,"div",18)(23,"textarea",19),e.NdJ("ngModelChange",function(i){return t.motivoRechazo=i}),e._uU(24,"\t\t\t"),e.qZA()()(),e.YNc(25,fi,1,0,"ng-template",20),e.qZA(),e.TgZ(26,"p-dialog",21),e.NdJ("visibleChange",function(i){return t.dialogAprobaciones=i}),e.TgZ(27,"div",1)(28,"div",2)(29,"div",3)(30,"p-table",22,23),e.YNc(32,Ci,7,0,"ng-template",6),e.YNc(33,vi,26,2,"ng-template",7),e.YNc(34,Ti,16,13,"ng-template",8),e.qZA()()()(),e.YNc(35,yi,1,0,"ng-template",20),e.qZA(),e.TgZ(36,"p-dialog",24),e.NdJ("visibleChange",function(i){return t.dialogAdjuntos=i}),e.TgZ(37,"div",1)(38,"div",2)(39,"div",3)(40,"p-table",22,23),e.YNc(42,xi,7,0,"ng-template",6),e.YNc(43,Ai,19,0,"ng-template",7),e.YNc(44,Zi,12,6,"ng-template",8),e.qZA()()()(),e.YNc(45,Mi,1,0,"ng-template",20),e.qZA(),e.TgZ(46,"p-dialog",25),e.NdJ("visibleChange",function(i){return t.displayModal=i}),e._UZ(47,"p",26),e.YNc(48,Ni,2,3,"div",27),e.qZA()),2&o&&(e.Q6J("urlBreadCrumb",t.urlBreadCrumb),e.xp6(4),e.Q6J("value",t.solped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(54,ie))("selection",t.selectedSolped),e.xp6(8),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Akn(e.DdM(55,X)),e.Q6J("visible",t.frmRechazo)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(3),e.Q6J("ngModel",t.motivoRechazo)("ngClass",e.VKq(56,wi,t.submitRechazo&&!t.motivoRechazo)),e.xp6(3),e.Akn(e.DdM(58,X)),e.Q6J("visible",t.dialogAprobaciones)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(4),e.Q6J("value",t.listaAprobaciones)("rows",10)("loading",t.loadingAp)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(59,ie)),e.xp6(6),e.Akn(e.DdM(60,X)),e.Q6J("visible",t.dialogAdjuntos)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(4),e.Q6J("value",t.listaDocumentosSolped)("rows",10)("loading",t.loadingDocumentos)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(61,ie)),e.xp6(6),e.Akn(e.DdM(62,X)),e.Q6J("visible",t.displayModal)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(2),e.Q6J("ngIf",t.loadingCargue))},dependencies:[m.mk,m.O5,_.Fj,_.JJ,_.On,d.jx,v.Hq,v.zx,M.u,E.V,U.Lt,H.k,J.g,I.o,S.iA,S.UA,S.xl,x.FN,L.L,m.uU,ue.L],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]});const qi=["filter"];function Fi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.newSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].create_accion)}}function Pi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",38),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.editSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("pTooltip",t.permisosUsuarioPagina[0].update_accion?"Editar":"Consultar")("icon",t.permisosUsuarioPagina[0].update_accion?"pi pi-pencil":"pi pi-search")("disabled",!t.permisosUsuarioPagina[0].read_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function Ei(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.solicitudAprobacion())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].update_accion||!t.selectedSolped||0==t.selectedSolped.length)}}function Ji(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.cancelarSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].update_accion||!t.selectedSolped||0==t.selectedSolped.length)}}function Ii(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.aprobar())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].aproved_accion||!t.selectedSolped||0==t.selectedSolped.length)}}function Li(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.rechazar())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].aproved_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function ki(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",25)(1,"div")(2,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(5);return e.KtG(i.clear(r))}),e.qZA(),e.YNc(3,Fi,1,1,"button",27),e.YNc(4,Pi,1,3,"button",28),e.YNc(5,Ei,1,1,"button",29),e.YNc(6,Ji,1,1,"button",30),e.YNc(7,Ii,1,1,"button",31),e.YNc(8,Li,1,1,"button",32),e.qZA(),e.TgZ(9,"span",33),e._UZ(10,"i",34),e.TgZ(11,"input",35,36),e.NdJ("input",function(i){e.CHM(t);const r=e.oxw(),l=e.MAs(5);return e.KtG(r.onGlobalFilter(l,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.permisosUsuarioPagina[0].create_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].aproved_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].aproved_accion)}}function Di(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function Oi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",56),e.NdJ("onChange",function(i){const l=e.CHM(t).filterCallback;return e.KtG(l(i.value))}),e.YNc(1,Di,2,3,"ng-template",57),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.statuses)}}function zi(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function Qi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",56),e.NdJ("onChange",function(i){const l=e.CHM(t).filterCallback;return e.KtG(l(i.value))}),e.YNc(1,zi,2,3,"ng-template",57),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.approves)}}function Ri(n,o){1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",43),e.TgZ(2,"th")(3,"div",44),e._uU(4," Id "),e._UZ(5,"p-columnFilter",45),e.qZA()(),e.TgZ(6,"th")(7,"div",44),e._uU(8," Tipo "),e._UZ(9,"p-columnFilter",46),e.qZA()(),e.TgZ(10,"th")(11,"div",44),e._uU(12," Fecha contabilizaci\xf3n "),e._UZ(13,"p-columnFilter",47),e.qZA()(),e.TgZ(14,"th")(15,"div",44),e._uU(16," Fecha necesaria "),e._UZ(17,"p-columnFilter",48),e.qZA()(),e.TgZ(18,"th")(19,"div",44),e._uU(20," Comentarios "),e._UZ(21,"p-columnFilter",49),e.qZA()(),e.TgZ(22,"th")(23,"div",44),e._uU(24," \xc1rea "),e._UZ(25,"p-columnFilter",50),e.qZA()(),e.TgZ(26,"th")(27,"div",44),e._uU(28," Estado "),e.TgZ(29,"p-columnFilter",51),e.YNc(30,Oi,2,2,"ng-template",52),e.qZA()()(),e.TgZ(31,"th")(32,"div",44),e._uU(33," Aprobada? "),e.TgZ(34,"p-columnFilter",53),e.YNc(35,Qi,2,2,"ng-template",52),e.qZA()()(),e.TgZ(36,"th")(37,"div",44),e._uU(38," Usuario "),e._UZ(39,"p-columnFilter",54),e.qZA()(),e.TgZ(40,"th")(41,"div",44),e._uU(42," N\xfamero solped SAP "),e._UZ(43,"p-columnFilter",55),e.qZA()(),e._UZ(44,"th")(45,"th"),e.qZA()),2&n&&(e.xp6(29),e.Q6J("showMatchModes",!1)("showOperator",!1),e.xp6(5),e.Q6J("showMatchModes",!1)("showOperator",!1))}function Ki(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"i",63),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw();return e.KtG(r.mostrarAprobaciones(i.id))}),e.qZA()}}function Bi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",58),e.qZA(),e.TgZ(3,"td",59),e._uU(4),e.qZA(),e.TgZ(5,"td",59),e._uU(6),e.qZA(),e.TgZ(7,"td",60),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",60),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"td",60),e._uU(14),e.qZA(),e.TgZ(15,"td",60),e._uU(16),e.qZA(),e.TgZ(17,"td",60),e._uU(18),e.ALo(19,"estados"),e.qZA(),e.TgZ(20,"td",60),e._uU(21),e.ALo(22,"estados"),e.qZA(),e.TgZ(23,"td",60),e._uU(24),e.qZA(),e.TgZ(25,"td",60),e._uU(26),e.qZA(),e.TgZ(27,"td"),e.YNc(28,Ki,1,0,"i",61),e.qZA(),e.TgZ(29,"td")(30,"i",62),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.mostrarAadjuntos(r.id))}),e.qZA()()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.id," "),e.xp6(2),e.hij(" ",t.serieStr," "),e.xp6(2),e.hij(" ",e.lcZ(9,13,t.docdate)," "),e.xp6(3),e.hij(" ",e.lcZ(12,15,t.reqdate)," "),e.xp6(3),e.hij(" ",t.comments," "),e.xp6(2),e.hij(" ",t.u_nf_depen_solped," "),e.xp6(2),e.hij(" ",e.xi3(19,17,t.status,"solped")," "),e.xp6(3),e.AsE(" ",e.xi3(22,20,t.approved,"aprobacion"),""," "+t.aprobador," "),e.xp6(3),e.hij(" ",t.fullname," "),e.xp6(2),e.hij(" ",t.sapdocnum," "),e.xp6(2),e.Q6J("ngIf","N"!=t.approved)}}function Gi(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",64),e._uU(2,"No se econtraron solicitudes de pedido."),e.qZA()())}function Yi(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",64),e._uU(2,"Cargando solicitudes de pedido. Por favor espere"),e.qZA()())}function Hi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",65)(1,"div",66),e._UZ(2,"i",67),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",68)(8,"div",69)(9,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirm())}),e.qZA()(),e.TgZ(10,"div",69)(11,"button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onReject())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function ji(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",65)(1,"div",66),e._UZ(2,"i",67),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",68)(8,"div",69)(9,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmAp())}),e.qZA()(),e.TgZ(10,"div",69)(11,"button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectAp())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function $i(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",65)(1,"div",66),e._UZ(2,"i",67),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",68)(8,"div",69)(9,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmRap())}),e.qZA()(),e.TgZ(10,"div",69)(11,"button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectRap())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function Vi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",65)(1,"div",66),e._UZ(2,"i",67),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",68)(8,"div",69)(9,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmCancel())}),e.qZA()(),e.TgZ(10,"div",69)(11,"button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectCancel())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function Xi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",72),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.rechazarSolped())}),e.qZA()}}function Wi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",25)(1,"div")(2,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(31);return e.KtG(i.clear(r))}),e.qZA()(),e.TgZ(3,"span",33),e._UZ(4,"i",34),e.TgZ(5,"input",35,36),e.NdJ("input",function(i){e.CHM(t);const r=e.oxw(),l=e.MAs(31);return e.KtG(r.onGlobalFilter(l,i))}),e.qZA()()()}}function ea(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function ta(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",56),e.NdJ("onChange",function(i){const l=e.CHM(t).filterCallback;return e.KtG(l(i.value))}),e.YNc(1,ea,2,3,"ng-template",57),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.approves)}}function oa(n,o){1&n&&(e.TgZ(0,"tr")(1,"th")(2,"div",44),e._uU(3," Nivel "),e._UZ(4,"p-columnFilter",45),e.qZA()(),e.TgZ(5,"th")(6,"div",44),e._uU(7," Fecha envio solicitud "),e._UZ(8,"p-columnFilter",47),e.qZA()(),e.TgZ(9,"th")(10,"div",44),e._uU(11," Aprbador "),e._UZ(12,"p-columnFilter",46),e.qZA()(),e.TgZ(13,"th")(14,"div",44),e._uU(15," Estado "),e.TgZ(16,"p-columnFilter",53),e.YNc(17,ta,2,2,"ng-template",52),e.qZA()()(),e.TgZ(18,"th")(19,"div",44),e._uU(20," Fecha aprobaci\xf3n "),e._UZ(21,"p-columnFilter",48),e.qZA()(),e.TgZ(22,"th")(23,"div",44),e._uU(24," Comentarios "),e._UZ(25,"p-columnFilter",49),e.qZA()()()),2&n&&(e.xp6(16),e.Q6J("showMatchModes",!1)("showOperator",!1))}function ia(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",60),e._uU(2),e.qZA(),e.TgZ(3,"td",60),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td",60),e._uU(7),e.qZA(),e.TgZ(8,"td",60),e._uU(9),e.ALo(10,"estados"),e.qZA(),e.TgZ(11,"td",60),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td",60),e._uU(15),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t.nivel," "),e.xp6(2),e.hij(" ",e.lcZ(5,6,t.created_at)," "),e.xp6(3),e.hij(" ",t.nombreaprobador," "),e.xp6(2),e.hij(" ",e.xi3(10,8,t.estadoap,"aprobacion")," "),e.xp6(3),e.hij(" ","P"!=t.estadoap?e.lcZ(13,11,t.updated_at):""," "),e.xp6(3),e.hij(" ",t.comments," ")}}function aa(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",72),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.dialogAprobaciones=!1)}),e.qZA()}}function na(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",25)(1,"div")(2,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(31);return e.KtG(i.clear(r))}),e.qZA()(),e.TgZ(3,"span",33),e._UZ(4,"i",34),e.TgZ(5,"input",35,36),e.NdJ("input",function(i){e.CHM(t);const r=e.oxw(),l=e.MAs(31);return e.KtG(r.onGlobalFilter(l,i))}),e.qZA()()()}}function ra(n,o){1&n&&(e.TgZ(0,"tr")(1,"th")(2,"div",44),e._uU(3," Tipo "),e._UZ(4,"p-columnFilter",73),e.qZA()(),e.TgZ(5,"th")(6,"div",44),e._uU(7," Nombre "),e._UZ(8,"p-columnFilter",74),e.qZA()(),e.TgZ(9,"th")(10,"div",44),e._uU(11," Tama\xf1o "),e.qZA()(),e.TgZ(12,"th")(13,"div",44),e._uU(14," Fecha creaci\xf3n "),e._UZ(15,"p-columnFilter",47),e.qZA()(),e.TgZ(16,"th")(17,"div",75),e._UZ(18,"i",76),e.qZA()()())}function la(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",60),e._uU(2),e.qZA(),e.TgZ(3,"td",60),e._uU(4),e.qZA(),e.TgZ(5,"td",60),e._uU(6),e.qZA(),e.TgZ(7,"td",60),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",77)(11,"p-button",78),e.NdJ("onClick",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.downloadAnexo(r.id,r.id_solped))}),e.qZA()()()}if(2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t.tipo," "),e.xp6(2),e.hij(" ",t.nombre," "),e.xp6(2),e.hij(" ",t.size," "),e.xp6(2),e.hij(" ",e.lcZ(9,4,t.created_at)," ")}}function sa(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",79),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.dialogAdjuntos=!1)}),e.qZA()}}const ae=function(){return["serie","status","sapdocnum","approved","u_nf_depen_solped","taxtdate","reqdate","fullname"]},ne=function(){return{width:"50vw"}},da=function(n){return{"ng-invalid ng-dirty":n}};class B{constructor(o,t,a,i,r,l,c,u){this.rutaActiva=o,this.adminService=t,this.sapService=a,this.comprasService=i,this.router=r,this.confirmationService=l,this.messageService=c,this.authService=u,this.solped=[],this.loading=!0,this.errorFechaAprobacion=!1,this.arrayErrorFecha=[],this.errorTrmAprobacion=!1,this.arrayIdSolped=[],this.frmRechazo=!1,this.motivoRechazo="",this.submitRechazo=!1,this.errorUsuarioAprobador=!1,this.arrayErrorUsuarioAprobador=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSopledARechazada=!1,this.arraySolpedRechazadas=[],this.arraryErrorTrm=[],this.selectedSolped=[],this.dialogAprobaciones=!1,this.loadingAp=!0,this.urlBreadCrumb="",this.dialogAdjuntos=!1,this.series=[],this.listaDocumentosSolped=[],this.loadingDocumentos=!0}ngOnInit(){this.infoUsuario=this.authService.getInfoUsuario(),this.perfilesUsuario=this.authService.getPerfilesUsuario(),this.permisosUsuario=this.authService.getPermisosUsuario(),this.permisosUsuarioPagina=this.permisosUsuario.filter(o=>o.url===this.router.url),this.urlBreadCrumb=this.router.url,this.statuses=[{label:"Abierta",value:"O"},{label:"Cerrada",value:"C"}],this.approves=[{label:"No aprobada",value:"N"},{label:"Aprobada",value:"A"},{label:"Pendiente",value:"P"},{label:"Rechazada",value:"R"}],this.getSeries()}getSeries(){this.sapService.seriesDocXEngineSAP(this.authService.getToken(),"1470000113").subscribe({next:o=>{for(let t in o)this.series.push(o[t]);console.log(this.series),this.getListado()},error:o=>{console.log(o)}})}newSolped(){this.router.navigate(["/portal/compras/solped/nueva"])}editSolped(){this.router.navigate(["/portal/compras/solped/editar",this.selectedSolped[0].id])}confirm(){this.confirmationService.confirm({message:"Are you sure that you want to proceed?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{this.messageService.add({severity:"info",summary:"Confirmed",detail:"You have accepted"})},reject:o=>{switch(o){case d.wB.REJECT:this.messageService.add({severity:"error",summary:"Rejected",detail:"You have rejected"});break;case d.wB.CANCEL:this.messageService.add({severity:"warn",summary:"Cancelled",detail:"You have cancelled"})}}})}mostrarAprobaciones(o){this.dialogAprobaciones=!0,this.comprasService.aprobacionesSolped(this.authService.getToken(),o).subscribe({next:t=>{this.listaAprobaciones=t,this.loadingAp=!1},error:t=>{console.log(t)}})}mostrarAadjuntos(o){this.dialogAdjuntos=!0,this.comprasService.solpedById(this.authService.getToken(),o).subscribe({next:t=>{console.log(t.anexos),this.listaDocumentosSolped=t.anexos,this.loadingDocumentos=!1},error:t=>{console.log(t)}})}downloadAnexo(o,t){var a=this;return(0,C.Z)(function*(){let i=a.listaDocumentosSolped.filter(r=>r.id===o)[0];var r;a.comprasService.getAnexoSolped(a.authService.getToken(),o,t).subscribe({next:(r=(0,C.Z)(function*(l){if(""!==l.data){const c=`data:application/pdf;base64,${l.data}`,u=document.createElement("a");u.href=c,u.download=`${i.nombre}`,u.click()}else a.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:"No existe documento cargado en la base de datos"})}),function(c){return r.apply(this,arguments)}),error:r=>{console.log(r)}})})()}base64toBlob(o,t=""){return(0,C.Z)(function*(){const i=atob(o),r=i.length,l=Math.ceil(r/1024),c=new Array(l);for(let u=0;u<l;u+=1){const p=1024*u,g=Math.min(p+1024,r),G=new Array(g-p);for(let A=p,Y=0;A<g;Y+=1,A+=1)G[Y]=i[A].charCodeAt(0);c[u]=new Uint8Array(G)}return new Blob(c,{type:t})})()}cancelarSolped(){let o=[];new Date,this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[];for(let i of this.selectedSolped)"C"===i.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(i.id)),"P"===i.approved&&(this.errorSolpedEnviada=!0,this.arrayErrorSolpedEnviada.push(i.id)),"A"===i.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(i.id)),o.push(i.id);this.arrayIdSolped=o;let a="";this.errorSolpedCancelada?(a=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSolpedCancelada=!1):this.errorSopledAprobada?(a=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha sido aprobada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSopledAprobada=!1):this.errorSolpedEnviada?(a=this.arrayErrorSolpedEnviada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya han sido enviadas a aprobaci\xf3n.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya ha sido enviada a aprobaci\xf3n`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSolpedEnviada=!1):(a=o.length>1?"\xbfDesea Continuar con la cancelaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la cancelaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"cdel",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:a}))}solicitudAprobacion(){let a,o=[],t=new Date;this.errorFechaAprobacion=!1,this.arrayErrorFecha=[],this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorTrmAprobacion=!1,this.arraryErrorTrm=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[];for(let r of this.selectedSolped)a=new Date(r.docdate),"C"===r.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(r.id)),a.toDateString()!==t.toDateString()&&(this.errorFechaAprobacion=!0,this.arrayErrorFecha.push(r.id)),"P"===r.approved&&(this.errorSolpedEnviada=!0,this.arrayErrorSolpedEnviada.push(r.id)),"A"===r.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(r.id)),0===r.trm&&(this.errorTrmAprobacion=!0,this.arraryErrorTrm.push(r.id)),o.push(r.id);this.arrayIdSolped=o;let i="";this.errorSolpedCancelada?(i=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSolpedCancelada=!1):this.errorTrmAprobacion?(i=this.arraryErrorTrm.length>1?`Las solicitudes ${JSON.stringify(this.arraryErrorTrm)} no poseen TRM, por favor acutalice la TRM en las sulicitudes`:`La solicitud ${JSON.stringify(this.arraryErrorTrm)} no posee TRM, por favor acutalice la TRM de la sulicitud`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorTrmAprobacion=!1):this.errorSopledAprobada?(i=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha fue aprobada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSopledAprobada=!1):this.errorSolpedEnviada?(i=this.arrayErrorSolpedEnviada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya han sido enviadas a aprobaci\xf3n.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya ha fue enviada a aprobaci\xf3n`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSolpedEnviada=!1):(i=this.errorFechaAprobacion?this.arrayErrorFecha.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorFecha)} tienen fechas de contabilizaci\xf3n diferentes a la fecha actual. \n                       Recuerde que la TRM de la aprobaci\xf3n sera basada en la fecha de contabilizaci\xf3n de la solicitud.\n                       \xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas? `:`La fecha de contabilizaci\xf3n de la solicitud ${JSON.stringify(this.arrayErrorFecha)}  es diferente a la fecha actual. \n            Recuerde que la TRM de la aprobaci\xf3n sera basada en la fecha de contabilizaci\xf3n de la solicitud.\n            \xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada? `:o.length>1?"\xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"c",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:i}))}onConfirm(){this.loading=!0;let o="";this.messageService.clear("c"),this.comprasService.envioAprobacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{console.log(t),0===t.filter(a=>"error"===a.status).length?(o=this.selectedSolped.length>1?"Las solicitudes seleccionadas, han sido enviadas a aprobaci\xf3n":"Las solicitud seleccionada, ha sido enviada a aprobaci\xf3n",this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:o}),this.getListado()):(this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t[0].message}))},error:t=>{console.log(t),this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}rechazar(){this.arrayIdSolped=[];let o=[];this.arraySolpedRechazadas=[],this.arraySolpedAprobadas=[],this.arrayErrorUsuarioAprobador=[],this.errorSopledARechazada=!1,this.errorSopledAprobada=!1,this.errorUsuarioAprobador=!1;for(let a of this.selectedSolped)"R"===a.approved&&(this.errorSopledARechazada=!0,this.arraySolpedRechazadas.push(a.id)),"A"===a.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(a.id)),a.usersapaprobador!==this.infoUsuario.codusersap&&(this.errorUsuarioAprobador=!0,this.arrayErrorUsuarioAprobador.push(a.id)),o.push(a.id);this.arrayIdSolped=o;let t="";this.errorSopledARechazada?(t=this.arraySolpedRechazadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedRechazadas)} ya fueron rechazadas.`:`La solicitud ${JSON.stringify(this.arraySolpedRechazadas)} ya fue rechazada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledARechazada=!1):this.errorSopledAprobada?(t=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha sido aprobada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledAprobada=!1):this.errorUsuarioAprobador?(t=this.arrayErrorUsuarioAprobador.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no pueden ser rechazadas por el usuario por ahora.`:`La solicitud ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no puede ser rechazada por el usuario por ahora.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorUsuarioAprobador=!1):(t=o.length>1?"\xbfDesea Continuar con el rechazo de las solicitudes seleccionadas?":"\xbfDesea Continuar con el rechazo de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"rj",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:t}))}aprobar(){this.arrayIdSolped=[];let o=[];this.arraySolpedRechazadas=[],this.arraySolpedAprobadas=[],this.arrayErrorUsuarioAprobador=[],this.errorSopledARechazada=!1,this.errorSopledAprobada=!1,this.errorUsuarioAprobador=!1,this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[];for(let a of this.selectedSolped)"R"===a.approved&&(this.errorSopledARechazada=!0,this.arraySolpedRechazadas.push(a.id)),"C"===a.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(a.id)),"A"===a.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(a.id)),a.usersapaprobador!==this.infoUsuario.codusersap&&(this.errorUsuarioAprobador=!0,this.arrayErrorUsuarioAprobador.push(a.id)),o.push(a.id);this.arrayIdSolped=o;let t="";this.errorSolpedCancelada?(t=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSolpedCancelada=!1):this.errorSopledARechazada?(t=this.arraySolpedRechazadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedRechazadas)} ya fueron rechazadas.`:`La solicitud ${JSON.stringify(this.arraySolpedRechazadas)} ya fue rechazada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledARechazada=!1):this.errorSopledAprobada?(t=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha sido aprobada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledAprobada=!1):this.errorUsuarioAprobador?(t=this.arrayErrorUsuarioAprobador.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no pueden ser aprobadas por el usuario por ahora.`:`La solicitud ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no puede ser aprobada por el usuario por ahora.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorUsuarioAprobador=!1):(t=o.length>1?"\xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"ap",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:t}))}onReject(){this.messageService.clear("c"),this.errorFechaAprobacion=!1}onRejectAp(){this.messageService.clear("ap"),console.log(this.arrayIdSolped)}onRejectRap(){this.messageService.clear("rj")}onRejectCancel(){this.messageService.clear("cdel")}onConfirmCancel(){this.loading=!0;let o="";this.messageService.clear("cdel"),this.comprasService.cancelacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{"ok"==t.status?(o=this.arrayIdSolped.length>1?"La cancelaci\xf3n de las solicitudes seleccionadas fueron realizadas correctamente":"La cancelaci\xf3n de la solicitud seleccionada fue realizada correctamente",this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:o}),this.getListado()):(this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t.message}),this.loading=!1)},error:t=>{console.log(t),this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}onConfirmRap(){this.messageService.clear("rj"),this.frmRechazo=!0}rechazarSolped(){this.submitRechazo=!0,this.motivoRechazo?this.comprasService.aprobacionesSolped(this.authService.getToken(),this.selectedSolped[0].id).subscribe({next:o=>{let t=o.filter(i=>i.usersapaprobador===this.infoUsuario.codusersap&&"A"===i.estadoseccion&&"P"===i.estadoap);this.comprasService.rechazoSolped({autor:{fullname:t[0].nombreautor,email:t[0].emailautor},aprobador:{fullname:t[0].nombreaprobador,email:t[0].emailaprobador,usersap:t[0].usersapaprobador},infoSolped:{id_solped:this.selectedSolped[0].id,idlineap:t[0].id,bdmysql:this.infoUsuario.bdmysql,companysap:this.infoUsuario.dbcompanysap,logo:this.infoUsuario.logoempresa,comments:this.motivoRechazo}}).subscribe({next:i=>{"ok"===i[0].status?(this.getListado(),this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:i[0].message}),this.frmRechazo=!1):this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i[0].message})},error:i=>{console.log(i)}})},error:o=>{console.log(o)}}):this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:"Debe diligenciar el motivo por el cual desea rechazar la solicitud seleccionada"})}onConfirmAp(){this.loading=!0,this.messageService.clear("ap"),this.comprasService.aprobacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{let a=[];if(t.arrayErrors.length>0){for(let i of t.arrayErrors)a.push({key:"tl",severity:"error",summary:"!Error",detail:i.messageSolped,life:5e3});if(t.arrayAproved.length>0){a.push({key:"tl",severity:"warn",summary:"!informaci\xf3n",detail:"Es posible que las siguentes solicitudes no se lograran guardar debido a los errores presentados.",life:5e3});for(let i of t.arrayAproved)a.push({key:"tl",severity:"warn",summary:"!informaci\xf3n",detail:i.messageSolped,life:5e3})}}else if(t.arrayAproved.length>0)for(let i of t.arrayAproved)a.push({key:"tl",severity:"success",summary:"!Ok",detail:i.messageSolped,life:5e3});this.getListado(),this.messageService.addAll(a)},error:t=>{this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}clearToast(){this.messageService.clear()}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}getListado(){this.comprasService.listSolpedAprobadas(this.authService.getToken()).subscribe({next:o=>{this.loading=!1;for(let t of o)t.serieStr=this.series.filter(a=>a.code==t.serie)[0].name;this.solped=o,console.log(this.solped),this.loading=!1},error:o=>{console.log(o)}})}}B.\u0275fac=function(o){return new(o||B)(e.Y36(f.gz),e.Y36($.l),e.Y36(Z.c),e.Y36(y.K),e.Y36(f.F0),e.Y36(d.YP),e.Y36(d.ez),e.Y36(T.e))},B.\u0275cmp=e.Xpm({type:B,selectors:[["app-solpeds-aprobadas"]],viewQuery:function(o,t){if(1&o&&e.Gf(qi,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},features:[e._Bn([d.ez,d.YP])],decls:46,vars:55,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12"],[1,"card"],["dataKey","id","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["key","tl"],["key","c",3,"baseZIndex","onClose"],["pTemplate","message"],["key","ap",3,"baseZIndex","onClose"],["key","rj",3,"baseZIndex","onClose"],["key","cdel",3,"baseZIndex","onClose"],["header","Motivo rechazo solped",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],[1,"field","col"],["pInputTextarea","","styleClass","w-full","rows","10",1,"w-full","h-full",3,"ngModel","ngClass","ngModelChange"],["pTemplate","footer"],["header","Proceso de aprobaci\xf3n",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","id","styleClass","p-datatable-gridlines p-datatable-sm ","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields"],["dt2",""],["header","Documentos adjuntos de solped",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","pTooltip","Limpiar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-success p-button-sm","icon","pi pi-plus",3,"disabled","click",4,"ngIf"],["pButton","","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-secondary p-button-sm",3,"pTooltip","icon","disabled","click",4,"ngIf"],["pButton","","pTooltip","Enviar a aprobaci\xf3n","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-warning p-button-sm","icon","pi pi-send",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-danger p-button-sm","icon","pi pi-trash",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Aprobar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-help p-button-sm","icon","pi pi-check-circle",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Rechazar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-danger p-button-sm","icon","pi pi-times-circle",3,"disabled","click",4,"ngIf"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar por palabra clave",1,"w-full","p-inputtext-sm",3,"input"],["filter",""],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-plus",1,"p-button-outlined","mb-2","mr-2","p-button-success","p-button-sm",3,"disabled","click"],["pButton","","tooltipPosition","bottom","placeholder","Bottom",1,"p-button-outlined","mb-2","mr-2","p-button-secondary","p-button-sm",3,"pTooltip","icon","disabled","click"],["pButton","","pTooltip","Enviar a aprobaci\xf3n","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-send",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Aprobar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-check-circle",1,"p-button-outlined","mb-2","mr-2","p-button-help","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Rechazar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-times-circle",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],[2,"width","3rem"],[1,"flex","justify-content-between","align-items-center"],["type","text","field","id","display","menu","placeholder","Buscar por c\xf3digo solped"],["type","text","field","serie","display","menu","placeholder","Buscar por tipo solped"],["type","date","field","docdate","display","menu"],["type","date","field","reqdate","display","menu"],["type","text","field","comments","display","menu","placeholder","Buscar por comentario"],["type","text","field","u_nf_depen_solped","display","menu","placeholder","Buscar por area"],["field","status","matchMode","equals","display","menu","placeholder","Buscar por estado",3,"showMatchModes","showOperator"],["pTemplate","filter"],["field","approved","display","menu","matchMode","equals","placeholder","Buscar por aprobaci\xf3n",3,"showMatchModes","showOperator"],["type","text","field","fullname","display","menu","placeholder","Buscar por usuario"],["type","text","field","sapsocnum","display","menu","placeholder","Buscar por c\xf3digo SAP"],["placeholder","Any",3,"ngModel","options","onChange"],["pTemplate","item"],[3,"value"],[2,"min-width","6rem"],[2,"min-width","12rem"],["class","pi pi-check-square","pTooltip","Aprobaciones","tooltipPosition","left",3,"click",4,"ngIf"],["pTooltip","Adjuntos","tooltipPosition","left",1,"pi","pi-file-pdf",3,"click"],["pTooltip","Aprobaciones","tooltipPosition","left",1,"pi","pi-check-square",3,"click"],["colspan","11",1,"text-center"],[1,"flex","flex-column",2,"flex","1"],[1,"text-center"],[1,"pi","pi-exclamation-triangle",2,"font-size","3rem"],[1,"grid","p-fluid"],[1,"col-6"],["type","button","pButton","","label","Si",1,"p-button-success",3,"click"],["type","button","pButton","","label","No",1,"p-button-secondary",3,"click"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"click"],["type","text","field","tipo","display","menu","placeholder","Buscar por tipo documento"],["type","text","field","nombre","display","menu","placeholder","Buscar por nombre documento"],[1,"align-content-center","justify-content-center"],["pTooltip","Adjuntos","tooltipPosition","left",1,"pi","pi-file-pdf"],[2,"min-width","4rem"],["label","Descargar","icon","pi pi-download","iconPos","left",1,"w-full",3,"onClick"],["icon","pi pi-check","label","Cerrar","styleClass","p-button-text",3,"click"]],template:function(o,t){1&o&&(e._UZ(0,"app-breadcrumb",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"p-table",4,5),e.NdJ("selectionChange",function(i){return t.selectedSolped=i}),e.YNc(6,ki,13,6,"ng-template",6),e.YNc(7,Ri,46,4,"ng-template",7),e.YNc(8,Bi,31,23,"ng-template",8),e.YNc(9,Gi,3,0,"ng-template",9),e.YNc(10,Yi,3,0,"ng-template",10),e.qZA()()()(),e._UZ(11,"p-toast",11),e.TgZ(12,"p-toast",12),e.NdJ("onClose",function(){return t.onReject()}),e.YNc(13,Hi,12,2,"ng-template",13),e.qZA(),e.TgZ(14,"p-toast",14),e.NdJ("onClose",function(){return t.onRejectAp()}),e.YNc(15,ji,12,2,"ng-template",13),e.qZA(),e.TgZ(16,"p-toast",15),e.NdJ("onClose",function(){return t.onRejectRap()}),e.YNc(17,$i,12,2,"ng-template",13),e.qZA(),e.TgZ(18,"p-toast",16),e.NdJ("onClose",function(){return t.onRejectCancel()}),e.YNc(19,Vi,12,2,"ng-template",13),e.qZA(),e.TgZ(20,"p-dialog",17),e.NdJ("visibleChange",function(i){return t.frmRechazo=i}),e.TgZ(21,"div",1)(22,"div",18)(23,"textarea",19),e.NdJ("ngModelChange",function(i){return t.motivoRechazo=i}),e._uU(24,"\t\t\t"),e.qZA()()(),e.YNc(25,Xi,1,0,"ng-template",20),e.qZA(),e.TgZ(26,"p-dialog",21),e.NdJ("visibleChange",function(i){return t.dialogAprobaciones=i}),e.TgZ(27,"div",1)(28,"div",2)(29,"div",3)(30,"p-table",22,23),e.YNc(32,Wi,7,0,"ng-template",6),e.YNc(33,oa,26,2,"ng-template",7),e.YNc(34,ia,16,13,"ng-template",8),e.qZA()()()(),e.YNc(35,aa,1,0,"ng-template",20),e.qZA(),e.TgZ(36,"p-dialog",24),e.NdJ("visibleChange",function(i){return t.dialogAdjuntos=i}),e.TgZ(37,"div",1)(38,"div",2)(39,"div",3)(40,"p-table",22,23),e.YNc(42,na,7,0,"ng-template",6),e.YNc(43,ra,19,0,"ng-template",7),e.YNc(44,la,12,6,"ng-template",8),e.qZA()()()(),e.YNc(45,sa,1,0,"ng-template",20),e.qZA()),2&o&&(e.Q6J("urlBreadCrumb",t.urlBreadCrumb),e.xp6(4),e.Q6J("value",t.solped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(47,ae))("selection",t.selectedSolped),e.xp6(8),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Akn(e.DdM(48,ne)),e.Q6J("visible",t.frmRechazo)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(3),e.Q6J("ngModel",t.motivoRechazo)("ngClass",e.VKq(49,da,t.submitRechazo&&!t.motivoRechazo)),e.xp6(3),e.Akn(e.DdM(51,ne)),e.Q6J("visible",t.dialogAprobaciones)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(4),e.Q6J("value",t.listaAprobaciones)("rows",10)("loading",t.loadingAp)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(52,ae)),e.xp6(6),e.Akn(e.DdM(53,ne)),e.Q6J("visible",t.dialogAdjuntos)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(4),e.Q6J("value",t.listaDocumentosSolped)("rows",10)("loading",t.loadingDocumentos)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(54,ae)))},dependencies:[m.mk,m.O5,_.Fj,_.JJ,_.On,d.jx,v.Hq,v.zx,M.u,E.V,U.Lt,J.g,I.o,S.iA,S.UA,S.xl,x.FN,L.L,m.uU,ue.L],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]});class F{}F.\u0275fac=function(o){return new(o||F)},F.\u0275mod=e.oAB({type:F}),F.\u0275inj=e.cJS({imports:[f.Bz.forChild([{path:"",component:K},{path:"nueva",component:q},{path:"editar/:solped",component:O},{path:"formSolped",component:q},{path:"tracking",component:R},{path:"nueva-mp",component:z},{path:"editar-mp/:solped",component:k},{path:"aprobadas",component:B}]),f.Bz]});var pa=s(931),ca=s(3983),ua=s(3837);class P{}P.\u0275fac=function(o){return new(o||P)},P.\u0275mod=e.oAB({type:P}),P.\u0275inj=e.cJS({imports:[m.ez,F,_.u5,_.UX,pa.W,ca.G,ua.S]})}}]);