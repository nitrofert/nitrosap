"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[350],{2350:(Y,h,n)=>{n.r(h),n.d(h,{PedidosModule:()=>l});var c=n(6895),f=n(931),u=n(9335),m=n(805),e=n(4650),v=n(4931),Z=n(1562),U=n(1922),C=n(5593),b=n(3608),T=n(1740),g=n(99),P=n(2453),x=n(9090);const y=["filter"];function _(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.nuevaEntrada())}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].create_accion||!t.pedidoSeleccionado||1!=t.pedidoSeleccionado.length)}}function A(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"div")(2,"button",12),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(),p=e.MAs(5);return e.KtG(a.clear(p))}),e.qZA(),e.YNc(3,_,1,1,"button",13),e.qZA(),e.TgZ(4,"span",14),e._UZ(5,"i",15),e.TgZ(6,"input",16,17),e.NdJ("input",function(a){e.CHM(t);const p=e.oxw(),J=e.MAs(5);return e.KtG(p.onGlobalFilter(J,a))}),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.permisosUsuarioPagina[0].create_accion)}}function S(i,o){1&i&&(e.TgZ(0,"tr"),e._UZ(1,"th",19),e.TgZ(2,"th")(3,"div",20),e._uU(4," C\xf3digo SAP "),e._UZ(5,"p-columnFilter",21),e.qZA()(),e.TgZ(6,"th")(7,"div",20),e._uU(8," Tipo "),e._UZ(9,"p-columnFilter",22),e.qZA()(),e.TgZ(10,"th")(11,"div",20),e._uU(12," Fecha contabilizaci\xf3n "),e._UZ(13,"p-columnFilter",23),e.qZA()(),e.TgZ(14,"th")(15,"div",20),e._uU(16," C\xf3digo Proveedor "),e._UZ(17,"p-columnFilter",24),e.qZA()(),e.TgZ(18,"th")(19,"div",20),e._uU(20," Nombre proveedor "),e._UZ(21,"p-columnFilter",25),e.qZA()(),e.TgZ(22,"th")(23,"div",20),e._uU(24," Comentario "),e._UZ(25,"p-columnFilter",26),e.qZA()(),e.TgZ(26,"th")(27,"div",20),e._uU(28," Total pedido "),e._UZ(29,"p-columnFilter",27),e.qZA()()())}function F(i,o){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",28),e.qZA(),e.TgZ(3,"td",29),e._uU(4),e.qZA(),e.TgZ(5,"td",29),e._uU(6),e.qZA(),e.TgZ(7,"td",29),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",29),e._uU(11),e.qZA(),e.TgZ(12,"td",29),e._uU(13),e.qZA(),e.TgZ(14,"td",29),e._uU(15),e.qZA(),e.TgZ(16,"td",29),e._uU(17),e.ALo(18,"currency"),e.qZA()()),2&i){const t=o.$implicit;e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.DocNum," "),e.xp6(2),e.hij(" ",t.SeriesName," "),e.xp6(2),e.hij(" ",e.lcZ(9,8,t.DocDate)," "),e.xp6(3),e.hij(" ",t.CardCode," "),e.xp6(2),e.hij(" ",t.CardName," "),e.xp6(2),e.hij(" ",t.Comments," "),e.xp6(2),e.hij(" ",e.xi3(18,10,t.DocTotal,"COP")," ")}}function B(i,o){1&i&&(e.TgZ(0,"tr")(1,"td",30),e._uU(2,"No se econtraron solicitudes de pedido."),e.qZA()())}function N(i,o){1&i&&(e.TgZ(0,"tr")(1,"td",30),e._uU(2,"Cargando solicitudes de pedido. Por favor espere"),e.qZA()())}const D=function(){return["DocNum","Series","DocDate","DocDueDate","CardCode","CardName","Comments","DocTotal"]};class d{constructor(o,t,s,a,p){this.comprasService=o,this.authService=t,this.router=s,this.sapService=a,this.rutaActiva=p,this.perfilesUsuario=[],this.permisosUsuario=[],this.series=[],this.urlBreadCrumb="",this.pedidos=[],this.loading=!0,this.pedidoSeleccionado=[]}ngOnInit(){console.log("pedidos"),this.getInfoUsuario(),this.getPerfilesUsuario(),this.getPermisosUsuario(),this.getPermisosUsuarioPagina(),this.getListado()}getInfoUsuario(){this.infoUsuario=this.authService.getInfoUsuario()}getPerfilesUsuario(){this.perfilesUsuario=this.authService.getPerfilesUsuario()}getPermisosUsuario(){this.permisosUsuario=this.authService.getPermisosUsuario()}getPermisosUsuarioPagina(){let o="";if(this.rutaActiva.snapshot.params.solped){let t=this.rutaActiva.snapshot.params;this.router.url.indexOf("/"+t.solped)>=0&&(o=this.router.url.substring(0,this.router.url.indexOf("/"+t.solped)))}else o=this.router.url;this.urlBreadCrumb=o,this.permisosUsuarioPagina=this.permisosUsuario.filter(t=>t.url===o),console.log(this.permisosUsuario,this.permisosUsuarioPagina)}getListado(){this.comprasService.ordenesAbiertasUsuarioXE(this.authService.getToken()).subscribe({next:o=>{let t=[];for(let s in o)t.push(o[s]);this.pedidos=t,console.log(this.pedidos),this.loading=!1},error:o=>{console.log(o)}})}nuevaEntrada(){console.log(this.pedidos),console.log(this.pedidoSeleccionado),localStorage.setItem("pedidoSeleccionado",JSON.stringify(this.pedidoSeleccionado[0].DocEntry)),this.router.navigate(["/portal/compras/entradas/nueva/"])}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}}d.\u0275fac=function(o){return new(o||d)(e.Y36(v.K),e.Y36(Z.e),e.Y36(u.F0),e.Y36(U.c),e.Y36(u.gz))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-pedidos"]],viewQuery:function(o,t){if(1&o&&e.Gf(y,5),2&o){let s;e.iGM(s=e.CRH())&&(t.filter=s.first)}},features:[e._Bn([m.ez,m.YP])],decls:12,vars:9,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12"],[1,"card"],["dataKey","DocNum","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","pTooltip","Limpiar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["pButton","","pTooltip","Copiar pedido a entrada","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-success p-button-sm","icon","pi pi-copy",3,"disabled","click",4,"ngIf"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar por palabra clave",1,"w-full","p-inputtext-sm",3,"input"],["filter",""],["pButton","","pTooltip","Copiar pedido a entrada","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-copy",1,"p-button-outlined","mb-2","mr-2","p-button-success","p-button-sm",3,"disabled","click"],[2,"width","3rem"],[1,"flex","justify-content-between","align-items-center"],["type","text","field","DocNum","display","menu","placeholder","Buscar por c\xf3digo pedido"],["type","text","field","Series","display","menu","placeholder","Buscar por tipo pedido"],["type","date","field","DocDate","display","menu"],["type","text","field","CardCode","display","menu","placeholder","Buscar por c\xf3digo proveedor"],["type","text","field","CardName","display","menu","placeholder","Buscar por nombre proveedor"],["type","text","field","Comments","display","menu","placeholder","Buscar por comentario"],["type","text","field","DocTotal","display","menu","placeholder","Buscar por total pedido"],[3,"value"],[2,"min-width","12rem"],["colspan","8",1,"text-center"]],template:function(o,t){1&o&&(e._UZ(0,"app-breadcrumb",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"p-table",4,5),e.NdJ("selectionChange",function(a){return t.pedidoSeleccionado=a}),e.YNc(6,A,8,1,"ng-template",6),e.YNc(7,S,30,0,"ng-template",7),e.YNc(8,F,19,13,"ng-template",8),e.YNc(9,B,3,0,"ng-template",9),e.YNc(10,N,3,0,"ng-template",10),e.qZA()()()(),e._UZ(11,"p-toast")),2&o&&(e.Q6J("urlBreadCrumb",t.urlBreadCrumb),e.xp6(4),e.Q6J("value",t.pedidos)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(8,D))("selection",t.pedidoSeleccionado))},dependencies:[c.O5,m.jx,C.Hq,b.u,T.o,g.iA,g.UA,g.xl,P.FN,x.L,c.H9,c.uU],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]});class r{}r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[u.Bz.forChild([{path:"",component:d}]),u.Bz]});var M=n(3983),j=n(3837);class l{}l.\u0275fac=function(o){return new(o||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[c.ez,f.W,r,M.G,j.S]})}}]);