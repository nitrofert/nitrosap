"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[428],{428:(z,c,a)=>{a.r(c),a.d(c,{UserModule:()=>d});var h=a(6895),t=a(4006),f=a(931),p=a(9335),g=a(805),e=a(4650),v=a(9701),U=a(4931),C=a(1562),Z=a(5593),T=a(5108),M=a(1740),b=a(3425),y=a(2453),A=a(9090);function S(r,i){if(1&r&&(e.TgZ(0,"div",26),e._uU(1),e.qZA()),2&r){const s=i.$implicit;e.xp6(1),e.hij(" ",s.perfil," ")}}function J(r,i){if(1&r&&(e.TgZ(0,"div",26),e._uU(1),e.qZA()),2&r){const s=i.$implicit;e.xp6(1),e.hij(" ",s.companyname," ")}}const l=function(r){return{"ng-invalid ng-dirty":r}};class m{constructor(i,s,o,n,w,q,I){this.rutaActiva=i,this.adminService=s,this.comprasService=o,this.router=n,this.confirmationService=w,this.messageService=q,this.authService=I,this.empresasUsuario=[],this.fullname="",this.email="",this.codusersap="",this.username="",this.submitted=!1,this.password="",this.password2="",this.urlBreadCrumb=""}ngOnInit(){this.infoUsuario=this.authService.getInfoUsuario(),this.fullname=this.infoUsuario.fullname,this.email=this.infoUsuario.email,this.codusersap=this.infoUsuario.codusersap,this.username=this.infoUsuario.username,this.perfilesUsuario=this.authService.getPerfilesUsuario(),this.permisosUsuario=this.authService.getPermisosUsuario(),this.permisosUsuarioPagina=this.permisosUsuario.filter(i=>i.url===this.router.url),this.urlBreadCrumb=this.router.url,this.getEmpresasUsuario(),this.getInfoUsuario()}saveUser(){this.submitted=!0;let i={id:this.infoUsuario.id,fullname:this.fullname,email:this.email};this.fullname&&this.email?this.password.length>0||this.password2.length>0?0==this.password.length||0==this.password2.length?this.messageService.add({severity:"error",summary:"!Opps",detail:"Debe diligenciar los campos resaltados en rojo"}):this.password!=this.password2?this.messageService.add({severity:"error",summary:"!Opps",detail:"Las contrase\xf1as ingresadas no coinciden"}):(i.password=this.password,this.actulizarInfoUsuario(i)):this.actulizarInfoUsuario(i):this.messageService.add({severity:"error",summary:"!Opps",detail:"Debe diligenciar los campos resaltados en rojo"})}actulizarInfoUsuario(i){console.log(i),this.submitted=!1,this.authService.actulizarInfoUsuario(this.authService.getToken(),i).subscribe({next:s=>{if(console.log(s),s.affectedRows>0){let o=[];o.push(this.authService.getInfoUsuario()),o[0].fullname=i.fullname,o[0].email=i.email,this.authService.setInfoUsuario(o),this.messageService.add({severity:"success",summary:"OK",detail:"Se acutializo correctamente la informaci\xf3n del usuario"})}},error:s=>{console.log(s),this.messageService.add({severity:"error",summary:"Error",detail:s})}})}getEmpresasUsuario(){this.authService.getEmpresasUsuario(this.authService.getToken()).subscribe({next:i=>{console.log(i),this.empresasUsuario=i},error:i=>{console.log(i)}})}getInfoUsuario(){this.authService.loadInfoUsuario(this.authService.getToken()).subscribe({next:i=>{console.log(i)},error:i=>{console.log(i)}})}}m.\u0275fac=function(i){return new(i||m)(e.Y36(p.gz),e.Y36(v.l),e.Y36(U.K),e.Y36(p.F0),e.Y36(g.YP),e.Y36(g.ez),e.Y36(C.e))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-user"]],features:[e._Bn([g.ez,g.YP])],decls:58,vars:27,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12","md:col-12"],[1,"card","p-fluid"],[1,"field","col"],["htmlFor","fullname"],["pInputText","","id","fullname","name","fullname","type","text","required","","autofocus","",3,"ngModel","ngClass","ngModelChange"],["htmlFor","email"],["pInputText","","id","email","name","email","type","email","required","",3,"ngModel","ngClass","ngModelChange"],["htmlFor","codusersap"],["pInputText","","id","codusersap","name","codusersap","type","text","required","","autofocus","","readonly","",3,"ngModel","ngClass","ngModelChange"],["htmlFor","username"],["pInputText","","id","username","name","username","type","text","required","","autofocus","","readonly","",3,"ngModel","ngClass","ngModelChange"],["align","left"],[1,"inline-flex","align-items-center"],[1,"pi","pi-key","mr-2"],["htmlFor","password"],["id","password","name","password",3,"ngModel","ngClass","ngModelChange"],["htmlFor","password2"],["id","password2","name","password2",3,"ngModel","ngClass","ngModelChange"],[1,"col"],["pButton","","label","Actualizar","icon","pi pi-save",1,"p-button-outlined","mb-2","p-button-success",3,"click"],[1,"pi","pi-id-card","mr-2"],[1,"col-12","md:col-12","pl-5","flex","justify-content-start"],["class","ml-5 flex",4,"ngFor","ngForOf"],[1,"pi","pi-building","mr-2"],[1,"ml-5","flex"]],template:function(i,s){1&i&&(e._UZ(0,"app-breadcrumb",0)(1,"p-toast"),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"h5"),e._uU(6,"Editar usuario"),e.qZA(),e.TgZ(7,"div",1)(8,"div",4)(9,"label",5),e._uU(10,"Nombre completo"),e.qZA(),e.TgZ(11,"input",6),e.NdJ("ngModelChange",function(n){return s.fullname=n}),e.qZA()(),e.TgZ(12,"div",4)(13,"label",7),e._uU(14,"Email"),e.qZA(),e.TgZ(15,"input",8),e.NdJ("ngModelChange",function(n){return s.email=n}),e.qZA()()(),e.TgZ(16,"div",1)(17,"div",4)(18,"label",9),e._uU(19,"Usuario SAP"),e.qZA(),e.TgZ(20,"input",10),e.NdJ("ngModelChange",function(n){return s.codusersap=n}),e.qZA()(),e.TgZ(21,"div",4)(22,"label",11),e._uU(23,"Usuario portal"),e.qZA(),e.TgZ(24,"input",12),e.NdJ("ngModelChange",function(n){return s.username=n}),e.qZA()()(),e.TgZ(25,"p-divider",13)(26,"div",14),e._UZ(27,"i",15),e.TgZ(28,"b"),e._uU(29,"Reestablecer contrase\xf1a"),e.qZA()()(),e.TgZ(30,"div",1)(31,"div",4)(32,"label",16),e._uU(33,"Contrase\xf1a"),e.qZA(),e.TgZ(34,"p-password",17),e.NdJ("ngModelChange",function(n){return s.password=n}),e.qZA()(),e.TgZ(35,"div",4)(36,"label",18),e._uU(37,"Repetir contrase\xf1a"),e.qZA(),e.TgZ(38,"p-password",19),e.NdJ("ngModelChange",function(n){return s.password2=n}),e.qZA()()(),e.TgZ(39,"div",1)(40,"div",20)(41,"button",21),e.NdJ("click",function(){return s.saveUser()}),e.qZA()()(),e.TgZ(42,"p-divider",13)(43,"div",14),e._UZ(44,"i",22),e.TgZ(45,"b"),e._uU(46,"Perfiles"),e.qZA()()(),e.TgZ(47,"div",1)(48,"div",23),e.YNc(49,S,2,1,"div",24),e.qZA()(),e.TgZ(50,"p-divider",13)(51,"div",14),e._UZ(52,"i",25),e.TgZ(53,"b"),e._uU(54,"Empresas"),e.qZA()()(),e.TgZ(55,"div",1)(56,"div",23),e.YNc(57,J,2,1,"div",24),e.qZA()()()()()),2&i&&(e.Q6J("urlBreadCrumb",s.urlBreadCrumb),e.xp6(11),e.Q6J("ngModel",s.fullname)("ngClass",e.VKq(15,l,s.submitted&&!s.fullname)),e.xp6(4),e.Q6J("ngModel",s.email)("ngClass",e.VKq(17,l,s.submitted&&!s.email)),e.xp6(5),e.Q6J("ngModel",s.codusersap)("ngClass",e.VKq(19,l,s.submitted&&!s.codusersap)),e.xp6(4),e.Q6J("ngModel",s.username)("ngClass",e.VKq(21,l,s.submitted&&!s.username)),e.xp6(10),e.Q6J("ngModel",s.password)("ngClass",e.VKq(23,l,s.submitted&&0!=s.password2.length&&0==s.password.length)),e.xp6(4),e.Q6J("ngModel",s.password2)("ngClass",e.VKq(25,l,s.submitted&&0!=s.password.length&&0==s.password2.length)),e.xp6(11),e.Q6J("ngForOf",s.perfilesUsuario),e.xp6(8),e.Q6J("ngForOf",s.empresasUsuario))},dependencies:[h.mk,h.sg,Z.Hq,T.i,M.o,b.ro,y.FN,t.Fj,t.JJ,t.Q7,t.On,A.L]});class u{}u.\u0275fac=function(i){return new(i||u)},u.\u0275mod=e.oAB({type:u}),u.\u0275inj=e.cJS({imports:[p.Bz.forChild([{path:"",component:m}]),p.Bz]});var F=a(3837);class d{}d.\u0275fac=function(i){return new(i||d)},d.\u0275mod=e.oAB({type:d}),d.\u0275inj=e.cJS({imports:[h.ez,f.W,u,t.u5,t.UX,F.S]})}}]);