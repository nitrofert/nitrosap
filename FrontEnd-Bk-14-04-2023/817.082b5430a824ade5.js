"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[817],{817:(wa,se,d)=>{d.r(se),d.d(se,{SolpedModule:()=>k});var _=d(6895),h=d(4006),f=d(9335),u=d(805),e=d(4650),x=d(1562),Z=d(4931),M=d(2453),C=d(5861),w=d(1922),de=d(3631),T=d(5593),q=d(3608),ee=d(585),N=d(1493),pe=d(5108),F=d(2210),ce=d(3388),P=d(8235),ue=d(5047),D=d(3054),O=d(1740),S=d(99),z=d(9090);const fe=["filter"],Ce=function(){return{height:"6px"}};function be(n,o){1&n&&(e.TgZ(0,"div",39),e._UZ(1,"p-progressBar",57),e.qZA()),2&n&&(e.xp6(1),e.Akn(e.DdM(2,Ce)))}function Se(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",39)(1,"p-button",58),e.NdJ("onClick",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.MostrarDetalle())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].read_accion)("badge",t.lineasSolped.length.toString())}}function ve(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.CardCode," - ",t.CardName,"")}}function Te(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.ItemCode," - ",t.ItemName,"")}}function ye(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.viceprecidencia.vicepresidency)}}function xe(n,o){if(1&n&&e.YNc(0,ye,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.viceprecidencia)}}function Ze(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.vicepresidency)}}function Ae(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.dependencia.dependence)}}function Me(n,o){if(1&n&&e.YNc(0,Ae,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.dependencia)}}function Ue(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.dependence)}}function Ne(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.localidad.location)}}function we(n,o){if(1&n&&e.YNc(0,Ne,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.localidad)}}function qe(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.location)}}function Fe(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.almacen.storename)}}function Pe(n,o){if(1&n&&e.YNc(0,Fe,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.almacen)}}function Ee(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.storename)}}function Le(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.impuesto.Code)}}function Je(n,o){if(1&n&&e.YNc(0,Le,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.impuesto)}}function Ie(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.AsE("",t.Code," - ",t.Name,"")}}const b=function(n){return{"ng-invalid ng-dirty":n}},te=function(){return{width:"100%"}};function ke(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",39)(2,"label",59),e._uU(3,"Fecha necesaria"),e.qZA(),e.TgZ(4,"p-calendar",60),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.fechaRequerida=i)}),e.qZA()(),e.TgZ(5,"div",39)(6,"label",61),e._uU(7,"Proveedor"),e.qZA(),e.TgZ(8,"p-autoComplete",62),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.proveedor=i)})("completeMethod",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.filtrarProveedores(i))})("onSelect",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarProveedor())}),e.YNc(9,ve,2,2,"ng-template",63),e.qZA()()(),e.TgZ(10,"div",1)(11,"div",39)(12,"label",64),e._uU(13,"C\xf3digo \xedtem"),e.qZA(),e.TgZ(14,"p-autoComplete",65),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.item=i)})("completeMethod",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.filtrarItems(i))})("onSelect",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarItemCode())})("onClear",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearItemCode())}),e.YNc(15,Te,2,2,"ng-template",63),e.qZA()(),e.TgZ(16,"div",39)(17,"label",66),e._uU(18,"Descripci\xf3n"),e.qZA(),e.TgZ(19,"input",67),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.descripcion=i)}),e.qZA()()(),e.TgZ(20,"div",1)(21,"div",39)(22,"label",68),e._uU(23,"Vicepresidencia"),e.qZA(),e.TgZ(24,"p-dropdown",69,70),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.viceprecidencia=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarVicepresidencia())}),e.YNc(26,xe,1,1,"ng-template",71),e.YNc(27,Ze,3,1,"ng-template",63),e.qZA()(),e.TgZ(28,"div",39)(29,"label",72),e._uU(30,"Dependencia"),e.qZA(),e.TgZ(31,"p-dropdown",73,74),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.dependencia=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarDependencia())}),e.YNc(33,Me,1,1,"ng-template",71),e.YNc(34,Ue,3,1,"ng-template",63),e.qZA()(),e.TgZ(35,"div",39)(36,"label",75),e._uU(37,"Localidad"),e.qZA(),e.TgZ(38,"p-dropdown",76,77),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.localidad=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarLocalidad())}),e.YNc(40,we,1,1,"ng-template",71),e.YNc(41,qe,3,1,"ng-template",63),e.qZA()()(),e.TgZ(42,"div",1)(43,"div",39)(44,"label",78),e._uU(45,"Almacen"),e.qZA(),e.TgZ(46,"p-dropdown",79),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.almacen=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarAlmacen())}),e.YNc(47,Pe,1,1,"ng-template",71),e.YNc(48,Ee,3,1,"ng-template",63),e.qZA()()(),e.TgZ(49,"div",1)(50,"div",39)(51,"label",80),e._uU(52,"Cantidad"),e.qZA(),e.TgZ(53,"input",81),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.cantidad=i)})("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.calcularSubtotalLinea())}),e.qZA()(),e.TgZ(54,"div",39)(55,"label",82),e._uU(56,"Precio"),e.qZA(),e.TgZ(57,"div",16)(58,"p-dropdown",83),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.moneda=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarMoneda())}),e.qZA(),e.TgZ(59,"p-inputNumber",84),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.precio=i)})("ngModelChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.calcularSubtotalLinea())}),e.qZA()()(),e.TgZ(60,"div",39)(61,"label",85),e._uU(62,"Subtotal linea"),e.qZA(),e.TgZ(63,"p-inputNumber",86),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.subtotalLinea=i)}),e.qZA()()(),e.TgZ(64,"div",1)(65,"div",39)(66,"label",87),e._uU(67,"Impuesto"),e.qZA(),e.TgZ(68,"div",16)(69,"p-dropdown",88),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.impuesto=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarImpuesto())}),e.YNc(70,Je,1,1,"ng-template",71),e.YNc(71,Ie,3,2,"ng-template",63),e.qZA(),e.TgZ(72,"p-inputNumber",89),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.prcImpuesto=i)}),e.qZA()()(),e.TgZ(73,"div",39)(74,"label",90),e._uU(75,"Valor impuesto"),e.qZA(),e.TgZ(76,"p-inputNumber",91),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.valorImpuesto=i)}),e.qZA()(),e.TgZ(77,"div",39)(78,"label",92),e._uU(79,"Total linea"),e.qZA(),e.TgZ(80,"p-inputNumber",93),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.totalLinea=i)}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.fechaRequerida)("showIcon",!0)("required",!0)("ngClass",e.VKq(66,b,t.envioLinea&&!t.fechaRequerida)),e.xp6(4),e.Q6J("ngModel",t.proveedor)("showEmptyMessage",!0)("suggestions",t.proveedoresFiltrados)("minLength",1)("delay",1e3),e.xp6(6),e.Q6J("ngModel",t.item)("showEmptyMessage",!0)("suggestions",t.itemsFiltrados)("minLength",1)("delay",1e3)("showClear",!0)("autofocus",!0)("disabled","S"===t.clase)("ngClass",e.VKq(68,b,"I"===t.clase&&t.envioLinea&&!t.item.ItemCode)),e.xp6(5),e.Q6J("ngModel",t.descripcion)("ngClass",e.VKq(70,b,t.envioLinea&&!t.descripcion)),e.xp6(5),e.Q6J("options",t.vicepresidencias)("ngModel",t.viceprecidencia)("filter",!0)("showClear",!0)("ngClass",e.VKq(72,b,t.envioLinea&&!t.viceprecidencia.vicepresidency)),e.xp6(7),e.Q6J("options",t.dependencias)("ngModel",t.dependencia)("filter",!0)("showClear",!0)("ngClass",e.VKq(74,b,t.envioLinea&&!t.dependencia.dependence)),e.xp6(7),e.Q6J("options",t.localidades)("ngModel",t.localidad)("filter",!0)("showClear",!0)("ngClass",e.VKq(76,b,t.envioLinea&&!t.localidad.location)),e.xp6(8),e.Q6J("options",t.almacenes)("ngModel",t.almacen)("filter",!0)("showClear",!0)("ngClass",e.VKq(78,b,t.envioLinea&&!t.almacen.store)),e.xp6(7),e.Q6J("ngModel",t.cantidad)("ngClass",e.VKq(80,b,t.envioLinea&&!t.cantidad)),e.xp6(5),e.Q6J("options",t.monedas)("ngModel",t.moneda)("required",!0)("readonly",t.lineasSolped.length>0),e.xp6(1),e.Q6J("ngModel",t.precio)("ngStyle",e.DdM(82,te)),e.xp6(4),e.Q6J("ngModel",t.subtotalLinea)("ngStyle",e.DdM(83,te))("readonly",!0),e.xp6(6),e.Q6J("options",t.impuestos)("ngModel",t.impuesto)("filter",!0)("showClear",!0)("ngClass",e.VKq(84,b,t.envioLinea&&!t.impuesto)),e.xp6(3),e.Q6J("ngModel",t.prcImpuesto)("readonly",!0)("disabled",!0),e.xp6(4),e.Q6J("ngModel",t.valorImpuesto)("ngStyle",e.DdM(86,te))("readonly",!0)("disabled",!0),e.xp6(4),e.Q6J("ngModel",t.totalLinea)("disabled",!0)("readonly",!0)}}function De(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",97),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.RegistrarLinea())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion)}}function Oe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",98)(1,"div")(2,"button",99),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(99);return e.KtG(i.clear(l))}),e.qZA(),e.TgZ(3,"button",100),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.AdicionarLinea())}),e.qZA(),e.TgZ(4,"button",101),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.EditarLinea())}),e.qZA(),e.TgZ(5,"button",102),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.BorrarLineas())}),e.qZA()(),e.TgZ(6,"span",103),e._UZ(7,"i",104),e.TgZ(8,"input",105,106),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(99);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("label",t.permisosUsuarioPagina.length>0&&t.permisosUsuarioPagina[0].create_accion?"Editar":"Consultar")("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaSeleccionada||1!=t.lineaSeleccionada.length),e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaSeleccionada||0==t.lineaSeleccionada.length||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)}}function ze(n,o){1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",107),e.TgZ(2,"th")(3,"div",108),e._uU(4," Linea detalle "),e._UZ(5,"p-columnFilter",109),e.qZA()(),e.TgZ(6,"th")(7,"div",108),e._uU(8," C\xf3digo Item "),e._UZ(9,"p-columnFilter",110),e.qZA()(),e.TgZ(10,"th")(11,"div",108),e._uU(12," Descripci\xf3n "),e._UZ(13,"p-columnFilter",111),e.qZA()(),e.TgZ(14,"th")(15,"div",108),e._uU(16," Fecha requerida "),e.qZA()(),e.TgZ(17,"th")(18,"div",108),e._uU(19," Proveedor "),e._UZ(20,"p-columnFilter",112),e.qZA()(),e.TgZ(21,"th")(22,"div",108),e._uU(23," Cuenta Mayor "),e._UZ(24,"p-columnFilter",113),e.qZA()(),e.TgZ(25,"th")(26,"div",108),e._uU(27," Vicepresidencia "),e._UZ(28,"p-columnFilter",114),e.qZA()(),e.TgZ(29,"th")(30,"div",108),e._uU(31," Dependencia "),e._UZ(32,"p-columnFilter",115),e.qZA()(),e.TgZ(33,"th")(34,"div",108),e._uU(35," Localidad "),e._UZ(36,"p-columnFilter",116),e.qZA()(),e.TgZ(37,"th")(38,"div",108),e._uU(39," Cantidad "),e.qZA()(),e.TgZ(40,"th")(41,"div",108),e._uU(42," Precio "),e.qZA()(),e.TgZ(43,"th")(44,"div",108),e._uU(45," Impuesto "),e.qZA()(),e.TgZ(46,"th")(47,"div",108),e._uU(48," Valor Impuesto "),e.qZA()(),e.TgZ(49,"th")(50,"div",108),e._uU(51," Subtotal l\xednea "),e.qZA()(),e.TgZ(52,"th")(53,"div",108),e._uU(54," Total l\xednea "),e.qZA()()())}function Qe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"p-tableCheckbox",117),e.NdJ("onClick",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarLinea())}),e.qZA()(),e.TgZ(3,"td",118),e._uU(4),e.qZA(),e.TgZ(5,"td",118),e._uU(6),e.qZA(),e.TgZ(7,"td",118),e._uU(8),e.qZA(),e.TgZ(9,"td",118),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td",118),e._uU(13),e.qZA(),e.TgZ(14,"td",118),e._uU(15),e.qZA(),e.TgZ(16,"td",118),e._uU(17),e.qZA(),e.TgZ(18,"td",118),e._uU(19),e.qZA(),e.TgZ(20,"td",118),e._uU(21),e.qZA(),e.TgZ(22,"td",118),e._uU(23),e.qZA(),e.TgZ(24,"td",118),e._uU(25),e.ALo(26,"currency"),e.qZA(),e.TgZ(27,"td",118),e._uU(28),e.ALo(29,"percent"),e.qZA(),e.TgZ(30,"td",118),e._uU(31),e.ALo(32,"currency"),e.qZA(),e.TgZ(33,"td",118),e._uU(34),e.ALo(35,"currency"),e.qZA(),e.TgZ(36,"td",118),e._uU(37),e.ALo(38,"currency"),e.qZA()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.linenum," "),e.xp6(2),e.hij(" ",t.itemcode," "),e.xp6(2),e.hij(" ",t.dscription," "),e.xp6(2),e.hij(" ",e.lcZ(11,17,t.reqdatedet)," "),e.xp6(3),e.hij(" ",t.linevendor," "),e.xp6(2),e.hij(" ",t.acctcode," "),e.xp6(2),e.hij(" ",t.ocrcode3," "),e.xp6(2),e.hij(" ",t.ocrcode2," "),e.xp6(2),e.hij(" ",t.ocrcode," "),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",e.xi3(26,19,t.price,t.moneda)," "),e.xp6(3),e.AsE(" ",t.tax," ",e.lcZ(29,22,t.linegtotal/t.linetotal-1)," "),e.xp6(3),e.hij(" ",e.xi3(32,24,t.taxvalor,"COP")," "),e.xp6(3),e.hij(" ",e.xi3(35,27,t.linetotal,"COP")," "),e.xp6(3),e.hij(" ",e.xi3(38,30,t.linegtotal,"COP")," ")}}function Be(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",119),e._uU(2,"Total"),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"currency"),e.qZA()()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(e.xi3(5,3,t.totalimpuestos,"COP")),e.xp6(3),e.Oqu(e.xi3(8,6,t.subtotal,"COP")),e.xp6(3),e.Oqu(e.xi3(11,9,t.grantotal,"COP"))}}function Re(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",120),e._uU(2,"No se econtraron lineas asociadas a la solped."),e.qZA()())}function Ke(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",120),e._uU(2,"Cargando solicitudes de pedido. Por favor espere"),e.qZA()())}function Ye(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",121),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.listadoLineas=!1)}),e.qZA()}}function Ge(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",98)(1,"div")(2,"button",99),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(99);return e.KtG(i.clear(l))}),e.qZA(),e.TgZ(3,"button",122),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.AdicionarAnexo())}),e.qZA(),e.TgZ(4,"button",123),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.BorrarAnexo())}),e.qZA()(),e.TgZ(5,"span",103),e._UZ(6,"i",104),e.TgZ(7,"input",105,106),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(99);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaAnexoSeleccionada||0==t.lineaAnexoSeleccionada.length||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)}}function He(n,o){1&n&&(e.TgZ(0,"th",127),e._UZ(1,"div",108),e.qZA())}function je(n,o){if(1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",107),e.TgZ(2,"th")(3,"div",108),e._uU(4," Tipo "),e._UZ(5,"p-columnFilter",124),e.qZA()(),e.TgZ(6,"th")(7,"div",108),e._uU(8," Nombre anexo "),e._UZ(9,"p-columnFilter",125),e.qZA()(),e.TgZ(10,"th")(11,"div",108),e._uU(12," Tama\xf1o anexo "),e.qZA()(),e.YNc(13,He,2,0,"th",126),e.qZA()),2&n){const t=e.oxw();e.xp6(13),e.Q6J("ngIf",t.solpedEditar)}}function $e(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",130)(1,"p-button",131),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw();return e.KtG(l.consultarAnexo(i.url))}),e.qZA()()}}function Ve(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",128),e.qZA(),e.TgZ(3,"td",118),e._uU(4),e.qZA(),e.TgZ(5,"td",118),e._uU(6),e.qZA(),e.TgZ(7,"td",118),e._uU(8),e.qZA(),e.YNc(9,$e,2,0,"td",129),e.qZA()),2&n){const t=o.$implicit,a=e.oxw();e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.tipo," "),e.xp6(2),e.hij(" ",t.file.name," "),e.xp6(2),e.hij(" ",t.file.size," "),e.xp6(1),e.Q6J("ngIf",a.solpedEditar)}}function Xe(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",120),e._uU(2,"No se econtraron anexos asociados a la solped."),e.qZA()())}function We(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",120),e._uU(2,"Cargando anexos asociados a la solicitud de pedido. Por favor espere"),e.qZA()())}function et(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",121),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.listadoAnexos=!1)}),e.qZA()}}function tt(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.tipoanexo.name)}}function ot(n,o){if(1&n&&e.YNc(0,tt,3,1,"div",94),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.tipoanexo)}}function it(n,o){if(1&n&&(e.TgZ(0,"div",96)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.name)}}function at(n,o){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.name," - ",t.size," bytes")}}function nt(n,o){if(1&n&&(e.TgZ(0,"ul"),e.YNc(1,at,2,2,"li",136),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.uploadedFiles)}}function lt(n,o){if(1&n&&e.YNc(0,nt,2,1,"ul",135),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.uploadedFiles.length)}}function rt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",39)(2,"label",132),e._uU(3,"Tipo anexo"),e.qZA(),e.TgZ(4,"p-dropdown",133,70),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.tipoanexo=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.seleccionarTipoAnexo())}),e.YNc(6,ot,1,1,"ng-template",71),e.YNc(7,it,3,1,"ng-template",63),e.qZA()()(),e.TgZ(8,"div",1)(9,"div",39)(10,"p-fileUpload",134),e.NdJ("onSelect",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.onLoad(i))}),e.YNc(11,lt,1,1,"ng-template",44),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("options",t.tiposanexo)("ngModel",t.tipoanexo)("filter",!0)("showClear",!0)("ngClass",e.VKq(10,b,t.envioLineaanexo&&!t.tipoanexo||t.envioLineaanexo&&""==t.tipoanexo)),e.xp6(6),e.Q6J("multiple",!1)("showUploadButton",!1)("maxFileSize",1e6)("ngClass",e.VKq(12,b,t.envioLineaanexo&&!t.fileTmp||t.envioLineaanexo&&""==t.fileTmp))("disabled",!t.tipoanexo)}}function st(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",97),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.adicionarlineaAnexo())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion)}}const V=function(){return{width:"50vw"}},me=function(){return{"960px":"75vw","640px":"100vw"}},dt=function(){return["itemcode","dscription","linevendor","acctcodename","acctcode","ocrcode","ocrcode2","ocrcode3"]},pt=function(){return["tipo","file.name","created_at"]};class E{constructor(o,t,a,i,l,r){this.authService=o,this.sapService=t,this.comprasService=a,this.router=i,this.messageService=l,this.rutaActiva=r,this.onNewSolped=new e.vpe,this.perfilesUsuario=[],this.permisosUsuario=[],this.dependenciasUsuario=[],this.vicepresidencias=[],this.dependencias=[],this.localidades=[],this.series=[],this.areas=[],this.clases=[],this.materiaprima=[{option:"Si",value:"S"},{option:"No",value:"N"}],this.proveedores=[],this.items=[],this.cuentas=[],this.almacenes=[],this.monedas=[],this.trm=0,this.impuestos=[],this.estados=[{name:"Proyectado"},{name:"Solicitado"}],this.nombreusuario="",this.area="",this.clase="I",this.nf_pedmp="",this.serie="",this.serieName="",this.codigoSap="0",this.fechaContable=new Date,this.fechaCaducidad=new Date,this.fechaDocumento=new Date,this.fechaNecesidad=new Date,this.comentarios="",this.currency="COP",this.nf_agente="",this.nf_pago="",this.nf_tipocarga="",this.nf_puertosalida="",this.nf_motonave="",this.nf_lastshippping=new Date,this.nf_dateofshipping=new Date,this.nf_Incoterms="",this.iteradorLinea=0,this.numeroLinea=-1,this.fechaRequerida=new Date,this.descripcion="",this.unidad="",this.almacen="",this.zonacode="",this.nombreCuenta="",this.cantidad=1,this.moneda="",this.precio=0,this.subtotalLinea=0,this.impuesto="",this.prcImpuesto=0,this.valorImpuesto=0,this.totalLinea=0,this.tiposdecarga=[{tipo:"Empacado"},{tipo:"Granel"}],this.totalimpuestos=0,this.subtotal=0,this.grantotal=0,this.lineasSolped=[],this.lineaSeleccionada=[],this.anexosSolped=[],this.lineaAnexoSeleccionada=[],this.envioFormulario=!1,this.nuevaLinea=!1,this.editarLinea=!1,this.formularioLinea=!1,this.formularioAnexo=!1,this.envioLinea=!1,this.envioLineaanexo=!1,this.listadoLineas=!1,this.listadoAnexos=!1,this.uploadedFiles=[],this.tiposanexo=[{name:"Revisi\xf3n presupuestal"},{name:"Especificaci\xf3n t\xe9cnica"},{name:"Otro"}],this.loading=!1,this.solpedAprobada="N",this.urlBreadCrumb="",this.loadingSave=!1,this.proveedoresFiltrados=[],this.itemsFiltrados=[],this.cuentasFiltradas=[]}ngOnInit(){this.getInfoUsuario(),this.getPerfilesUsuario(),this.getPermisosUsuario(),this.getPermisosUsuarioPagina(),this.getDependenciasUsuario()}getInfoUsuario(){this.infoUsuario=this.authService.getInfoUsuario()}getPerfilesUsuario(){this.perfilesUsuario=this.authService.getPerfilesUsuario()}getPermisosUsuario(){this.permisosUsuario=this.authService.getPermisosUsuario()}getPermisosUsuarioPagina(){let o="";if(this.rutaActiva.snapshot.params.solped){let t=this.rutaActiva.snapshot.params;this.router.url.indexOf("/"+t.solped)>=0&&(o=this.router.url.substring(0,this.router.url.indexOf("/"+t.solped)))}else o=this.router.url;this.urlBreadCrumb=o,this.permisosUsuarioPagina=this.permisosUsuario.filter(t=>t.url===o),console.log(this.permisosUsuario,this.permisosUsuarioPagina)}getDependenciasUsuario(){this.authService.getDependeciasUsuarioXE().subscribe({next:o=>{for(let t in o)this.dependenciasUsuario.push(o[t]);console.log("dependencias usuario",this.dependenciasUsuario);for(let t of this.dependenciasUsuario)0===this.vicepresidencias.filter(a=>a.vicepresidency===t.vicepresidency).length&&this.vicepresidencias.push(t);0==this.vicepresidencias.length&&this.vicepresidencias.push({codusersap:this.infoUsuario.codusersap,dependence:"VPCADSU2",location:"SANTAMAR",vicepresidency:"VPCADSUM",id:0}),this.getSeries()},error:o=>{}})}getSeries(){this.sapService.seriesDocXEngineSAP(this.authService.getToken(),"1470000113").subscribe({next:o=>{console.log(o);for(let t in o)"SPMP"==o[t].name&&this.series.push(o[t]);this.serie=this.series[0].code,this.serieName=this.series[0].name,this.clase="I",this.getAreas()},error:o=>{console.log(o)}})}getAreas(){var o=this;return(0,C.Z)(function*(){yield o.authService.getAreasUsuarioXE().subscribe({next:t=>{for(let a in t)o.areas.push(t[a]);console.log("Areas usuario:",o.areas),0==o.areas.length&&o.areas.push({codusersap:o.infoUsuario.username,area:"VPCADSU2"}),o.area="VPCADSU2",o.getClases()},error:t=>{}})})()}getClases(){this.clases=[{code:"I",name:"Art\xedculo"},{code:"S",name:"Servicio"}],this.getProveedores()}getProveedores(){this.sapService.BusinessPartnersXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.proveedores.push(o[t]);this.getItems()},error:o=>{}})}getItems(){this.sapService.itemsSAPXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.items.push(o[t]);this.getAlmacenesMPSL()},error:o=>{}})}getAlmacenesMPSL(){this.sapService.getAlmacenesMPSL(this.authService.getToken()).subscribe({next:o=>{for(let t in o.value)this.almacenes.push({store:o.value[t].WarehouseCode,storename:o.value[t].WarehouseName,zonacode:o.value[t].State});this.getCuentas()},error:o=>{console.log(o)}})}getCuentas(){this.sapService.CuentasSAPXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.cuentas.push(o[t]);this.getMonedas(new Date)},error:o=>{}})}getMonedas(o){this.sapService.monedasXEngineSAP(this.authService.getToken(),o.toISOString()).subscribe({next:t=>{this.monedas=[{Currency:"COP",TRM:1}];for(let a in t)this.monedas.push(t[a]);this.setearTRMSolped("USD"),this.getImpuestos()},error:t=>{}})}getAlmacenes(){this.authService.getAlmacenesUsuarioXE().subscribe({next:o=>{console.log(o);for(let t in o)this.almacenes.push(o[t])},error:o=>{}})}getImpuestos(){this.comprasService.taxesXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.impuestos.push(o[t]);this.SeleccionarImpuesto(),setTimeout(()=>{this.getInformacionSolped()},500),this.resetearFormularioLinea()},error:o=>{}})}getInformacionSolped(){this.solpedEditar&&this.comprasService.solpedById(this.authService.getToken(),this.solpedEditar).subscribe({next:o=>{this.infoSolpedEditar=o,this.lineasSolped=this.infoSolpedEditar.solpedDet,this.serie=this.series.filter(t=>t.code==this.infoSolpedEditar.solped.serie)[0].code,this.codigoSap=this.infoSolpedEditar.solped.sapdocnum||"0",this.clase=this.infoSolpedEditar.solped.doctype||"",this.fechaContable=new Date(this.infoSolpedEditar.solped.docdate.toString().replace("T00","T05")),this.fechaCaducidad=new Date(this.infoSolpedEditar.solped.docduedate.toString().replace("T00","T05")),this.fechaDocumento=new Date(this.infoSolpedEditar.solped.taxdate.toString().replace("T00","T05")),this.fechaNecesidad=new Date(this.infoSolpedEditar.solped.reqdate.toString().replace("T00","T05")),this.comentarios=this.infoSolpedEditar.solped.comments||"",this.trm=this.infoSolpedEditar.solped.trm,this.currency=this.infoSolpedEditar.solped.currency||1===this.trm?"COP":"USD",this.iteradorLinea=this.lineasSolped[this.lineasSolped.length-1].linenum+1,this.solpedAprobada=this.infoSolpedEditar.solped.approved||"N",this.areas.filter(t=>t.area===this.infoSolpedEditar.solped.u_nf_depen_solped).length>0&&(this.area=this.areas.filter(t=>t.area===this.infoSolpedEditar.solped.u_nf_depen_solped)[0].area),this.u_nf_status=this.estados.filter(t=>t.name===this.infoSolpedEditar.solped.u_nf_status)[0].name,this.nf_agente=this.infoSolpedEditar.solped.nf_agente||"",this.nf_lastshippping=new Date(this.infoSolpedEditar.solped.nf_lastshippping||Date.now()),this.nf_dateofshipping=new Date(this.infoSolpedEditar.solped.nf_dateofshipping||Date.now()),this.nf_pago=this.infoSolpedEditar.solped.nf_pago||"",this.nf_tipocarga=this.infoSolpedEditar.solped.nf_tipocarga||"",this.nf_puertosalida=this.infoSolpedEditar.solped.nf_puertosalida||"",this.nf_motonave=this.infoSolpedEditar.solped.nf_motonave||""},error:o=>{console.log(o)}})}SeleccionarArea(){}SeleccionarClase(){}SeleccionarSerie(){this.serieName=this.series.filter(o=>o.code===this.serie)[0].name,this.clase="SPB"==this.serieName?"I":"",this.resetearFormularioLinea()}SeleccionarFechaContable(){this.getMonedas(this.fechaContable)}SeleccionarProveedor(){}SeleccionarItemCode(){console.log(this.item),this.descripcion=this.item.ItemName,this.getUnidadItemSL(),this.impuesto=this.item.ApTaxCode?this.impuestos.filter(o=>o.Code===this.item.ApTaxCode)[0]:this.impuestos.filter(o=>"ID08"===o.Code)[0],this.SeleccionarImpuesto(),this.cuenta={Code:"",Name:""},this.nombreCuenta=""}getUnidadItemSL(){this.sapService.getUnidadItemSL(this.authService.getToken(),this.item.ItemCode).subscribe({next:o=>{this.unidad=o.value[0].PurchaseUnit,console.log(this.unidad)},error:o=>{console.log(o)}})}SeleccionarVicepresidencia(){if(this.viceprecidencia){let o=this.dependenciasUsuario.filter(t=>t.vicepresidency===this.viceprecidencia.vicepresidency);for(let t of o)0===this.dependencias.filter(a=>a.dependence===t.dependence).length&&this.dependencias.push(t);0==this.dependencias.length&&this.dependencias.push({codusersap:this.infoUsuario.codusersap,dependence:"VPCADSU2",location:"SANTAMAR",vicepresidency:"VPCADSUM",id:0})}}SeleccionarDependencia(){if(this.dependencia){let o=this.dependenciasUsuario.filter(t=>t.dependence===this.dependencia.dependence&&t.vicepresidency===this.dependencia.vicepresidency);for(let t of o)0===this.localidades.filter(a=>a.location===t.location).length&&this.localidades.push(t);0==this.localidades.length&&(this.localidades.push({codusersap:this.infoUsuario.codusersap,dependence:"VPCADSU2",location:"SANTAMAR",vicepresidency:"VPCADSUM",id:0}),this.localidades.push({codusersap:this.infoUsuario.codusersap,dependence:"VPCADSU2",location:"BVENTURA",vicepresidency:"VPCADSUM",id:1})),this.cuentasxDependencia()}}SeleccionarLocalidad(){}SeleccionarAlmacen(){console.log(this.almacen),this.zonacode=this.almacen.zonacode,console.log(this.zonacode)}SeleccionarCuenta(){this.nombreCuenta=this.cuenta.Name}SeleccionarMoneda(){this.currency=this.monedas.filter(o=>o.Currency===this.moneda)[0].Currency,this.calcularSubtotalLinea()}SeleccionarImpuesto(){this.impuesto?(this.prcImpuesto=this.impuesto.tax,this.calcularImpuesto()):this.prcImpuesto=0}SeleccionarLinea(){}filtrarProveedores(o){let a,t=[],i=o.query;for(let l=0;l<this.proveedores.length;l++)a=this.proveedores[l],(a.CardCode.toLowerCase().indexOf(i.toLowerCase())>=0||a.CardName.toLowerCase().indexOf(i.toLowerCase())>=0)&&t.push(a);this.proveedoresFiltrados=t}filtrarItems(o){let t=[],a=o.query;for(let i=0;i<this.items.length;i++){let l=this.items[i];null!=l.ItemCode&&null!=l.ItemName&&(l.ItemCode.toLowerCase().indexOf(a.toLowerCase())>=0||l.ItemName.toLowerCase().indexOf(a.toLowerCase())>=0)&&t.push(l)}this.itemsFiltrados=t}clearItemCode(){}cuentasxDependencia(){this.sapService.cuentasPorDependenciaXE(this.authService.getToken(),this.dependencia.dependence).subscribe({next:o=>{let t=[];for(let l in o)t.push(o[l].U_NF_CUENTA);let a,i=[];for(let l=0;l<this.cuentas.length;l++){a=this.cuentas[l];for(let r of t)0==a.Code.indexOf(r)&&i.push(a)}this.cuentasDependencia=i},error:o=>{}})}filtrarCuentas(o){let t=[],a=o.query;for(let i=0;i<this.cuentasDependencia.length;i++){let l=this.cuentasDependencia[i];null!=l.Code&&null!=l.Name&&(l.Code.toLowerCase().indexOf(a.toLowerCase())>=0||l.Name.toLowerCase().indexOf(a.toLowerCase())>=0)&&t.push(l)}this.cuentasFiltradas=t}calcularSubtotalLinea(){this.monedas.filter(t=>t.Currency===this.moneda),this.subtotalLinea=this.cantidad&&this.precio?this.cantidad*this.precio:0,this.calcularImpuesto()}resetearFormularioLinea(){this.numeroLinea=-1,this.fechaRequerida=new Date,this.proveedor={CardCode:"PE821401799",CardName:"NITRON GROUP"},this.proveedoresFiltrados=[],this.item={ApTaxCode:"",ItemCode:"",ItemName:""},this.itemsFiltrados=[],this.descripcion="",this.viceprecidencia={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.dependencia={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.localidad={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.almacen="",this.cuenta={Code:"",Name:""},this.cuentasFiltradas=[],this.nombreCuenta="",this.cantidad=1,this.moneda=this.lineasSolped.length>0?this.lineasSolped[0].moneda||"COP":"USD",this.precio=0,this.subtotalLinea=0,this.impuesto="",this.prcImpuesto=0,this.valorImpuesto=0,this.totalLinea=0}setearTRMSolped(o){this.monedas.filter(t=>t.Currency===o).length>0?(this.trm=this.monedas.filter(t=>t.Currency===o)[0].TRM,this.moneda=o,console.log(this.moneda)):this.trm=0}calcularImpuesto(){this.valorImpuesto=this.impuesto.tax&&0!=this.subtotalLinea?this.subtotalLinea*(this.impuesto.tax/100):0,this.calcularTotalLinea()}calcularTotalLinea(){this.totalLinea=this.subtotalLinea+this.valorImpuesto}calculatTotales(){this.totalimpuestos=0,this.subtotal=0,this.grantotal=0;for(let o of this.lineasSolped)this.totalimpuestos+=o.taxvalor,this.subtotal+=o.linetotal,this.grantotal+=o.linegtotal}verAnexos(){this.listadoAnexos=!0}adicionarlineaAnexo(){this.envioLineaanexo=!0,this.tipoanexo&&""!=this.tipoanexo&&this.fileTmp&&""!=this.fileTmp?(this.solpedEditar?this.loadFile(this.solpedEditar,{tipo:this.tipoanexo.name,file:this.fileTmp.fileRaw,url:"#"}):this.anexosSolped.push({tipo:this.tipoanexo.name,file:this.fileTmp.fileRaw,url:"#"}),this.tipoanexo="",this.fileTmp="",this.formularioAnexo=!1):this.messageService.add({severity:"error",summary:"!Error\xa1",detail:"Debe seleccionar el tipo y el archivo a anexar a la solped"})}loadFile(o,t){let a;a=new FormData,a.append("myFile",t.file,t.file.name),a.append("anexotipo",t.tipo),a.append("solpedID",o),this.comprasService.uploadAnexo(this.authService.getToken(),a).subscribe({next:i=>{this.anexosSolped.push({tipo:t.tipo,file:t.file,url:i.ruta,idanexo:i.idanexo}),this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:i.message})},error:i=>{console.log(i),this.messageService.add({severity:"error",summary:"!Error\xa1",detail:i})}})}AdicionarAnexo(){this.formularioAnexo=!0;let o=[];if(this.anexosSolped.length>0){for(let t of this.tiposanexo)"Otro"!=t.name?0==this.anexosSolped.filter(a=>a.tipo==t.name).length&&o.push({name:t.name}):o.push({name:t.name});this.tiposanexo=o}}BorrarAnexo(){let o=[],t=!1;for(let a of this.anexosSolped){t=!1;for(let i of this.lineaAnexoSeleccionada)a===i&&(t=!0);t||o.push(a)}if(this.anexosSolped=o,this.solpedEditar)for(let a of this.lineaAnexoSeleccionada){let i={ruta:a.url,name:a.file.name,tipo:a.tipo,idsolped:this.infoSolpedEditar.solped.id,idanexo:a.idanexo};this.comprasService.borrarAnexo(this.authService.getToken(),i).subscribe({next:l=>{this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:l.message})},error:l=>{console.log(l),this.messageService.add({severity:"error",summary:"!Error",detail:l})}})}}seleccionarTipoAnexo(){}loadFiles(){let o;for(let t of this.anexosSolped)o=new FormData,o.append("myFile",t.file,t.file.name),o.append("anexotipo",t.tipo),this.comprasService.uploadAnexo(this.authService.getToken(),o).subscribe({next:a=>{},error:a=>{console.log(a)}})}onLoad(o){const[t]=o.currentFiles;this.fileTmp={fileRaw:t,fileName:t.name}}consultarAnexo(o){let t=this.comprasService.downloadAnexo(o);window.open(t,"blank")}AdicionarLinea(){this.nuevaLinea=!0,this.clase&&this.serie&&this.area&&this.fechaContable&&this.fechaCaducidad&&this.fechaDocumento&&this.fechaNecesidad?(this.resetearFormularioLinea(),this.numeroLinea=this.iteradorLinea,this.MostrarFormularioLinea()):this.messageService.add({severity:"error",summary:"!Opps",detail:"Debe diligenciar los campos resaltados en rojo"})}MostrarFormularioLinea(){this.formularioLinea=!0,this.nuevaLinea=!1,this.viceprecidencia=this.vicepresidencias.filter(o=>"VPCADSUM"==o.vicepresidency)[0],this.SeleccionarVicepresidencia(),this.dependencia=this.dependencias.filter(o=>"VPCADSU2"==o.dependence)[0],this.SeleccionarDependencia()}MostrarDetalle(){this.listadoLineas=!0,this.calculatTotales()}GuardarSolped(){if(this.envioFormulario=!0,this.clase&&this.serie&&this.area&&this.fechaContable&&this.fechaCaducidad&&this.fechaDocumento&&this.fechaNecesidad)if(this.lineasSolped.length>0){this.loadingSave=!0;const o={solped:{id_user:this.infoUsuario.id,usersap:this.infoUsuario.codusersap,fullname:this.infoUsuario.fullname,serie:this.serie,doctype:this.clase,docdate:this.fechaContable,docduedate:this.fechaCaducidad,taxdate:this.fechaDocumento,reqdate:this.fechaNecesidad,sapdocnum:this.solpedEditar?this.infoSolpedEditar.solped.sapdocnum:"0",u_nf_depen_solped:this.area,comments:this.comentarios,trm:this.trm,currency:this.currency,nf_lastshippping:this.nf_lastshippping,nf_dateofshipping:this.nf_dateofshipping,nf_agente:this.nf_agente,nf_pago:this.nf_pago,nf_tipocarga:this.nf_tipocarga,nf_puertosalida:this.nf_puertosalida,nf_motonave:this.nf_motonave,u_nf_status:this.solpedEditar?this.u_nf_status:"Proyectado",nf_pedmp:this.nf_pedmp,nf_Incoterms:this.nf_Incoterms},solpedDet:this.lineasSolped};this.solpedEditar&&(o.solped.approved=this.infoSolpedEditar.solped.approved,o.solped.id=this.solpedEditar),this.onNewSolped.emit(o),this.registroSolped=!0,this.envioFormulario=!1}else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar al menos una l\xednea en la solped"});else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar los campos resaltados en rojo"})}NuevaSolped(){}RegistrarLinea(){if(this.envioLinea=!0,this.descripcion&&this.fechaRequerida&&this.cantidad&&this.almacen&&(this.cuenta.Code&&!this.item.ItemCode||!this.cuenta.Code&&this.item.ItemCode)){let o=this.LineaDuplicada();o>=0&&this.lineasSolped[o].linenum!==this.numeroLinea?this.messageService.add({severity:"warn",summary:"!Atenci\xf3n",detail:`Los siguientes datos item: ${this.item.ItemCode}, \n                                            Vicepresidencia: ${this.viceprecidencia.vicepresidency}, \n                                            Dependencia: ${this.dependencia.dependence} y \n                                            localidad: ${this.localidad.location} \n                                            ya se encuentran registrados en la \n                                            linea ${this.lineasSolped[o].linenum} de esta solped`}):(this.editarLinea?(this.asignarCamposLinea(this.lineaSeleccionada[0].linenum),this.lineasSolped.splice(this.lineasSolped.indexOf(this.lineaSeleccionada[0]),1,this.lineaSolped),this.messageService.add({severity:"success",summary:"!OK\xa1",detail:"Se realizo correctamente la actualizaci\xf3n de la l\xednea"}),this.editarLinea=!1):(this.asignarCamposLinea(this.numeroLinea),this.lineasSolped.push(this.lineaSolped),this.iteradorLinea++,this.messageService.add({severity:"success",summary:"!OK\xa1",detail:"Se realizo correctamente el registro de la l\xednea"})),this.formularioLinea=!1,this.calculatTotales(),this.resetearFormularioLinea(),this.envioLinea=!1)}else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar los campos resaltados en rojo"})}asignarCamposLinea(o){this.lineaSolped={id_solped:this.solpedEditar?this.solpedEditar:0,linenum:o,id_user:this.infoUsuario.id,reqdatedet:this.fechaRequerida,linevendor:this.proveedor.CardCode,itemcode:this.item.ItemCode,dscription:this.descripcion,ocrcode3:this.viceprecidencia.vicepresidency,ocrcode2:this.dependencia.dependence,ocrcode:this.localidad.location,whscode:""!=this.almacen?this.almacen.store:"SM_N300",acctcode:this.cuenta.Code,acctcodename:this.nombreCuenta,quantity:this.cantidad,moneda:this.moneda,price:this.precio,trm:this.trm,linetotal:this.subtotalLinea,tax:this.impuesto.Code,taxvalor:this.valorImpuesto,linegtotal:this.totalLinea,unidad:this.unidad,zonacode:this.zonacode}}LineaDuplicada(){let o=this.lineasSolped.filter(t=>t.itemcode===this.item.ItemCode&&t.dscription===this.descripcion&&t.ocrcode===this.localidad.location&&t.ocrcode2===this.dependencia.dependence&&t.ocrcode3===this.viceprecidencia.vicepresidency);return this.lineasSolped.indexOf(o[0])}EditarLinea(){this.lineaSolped=this.lineaSeleccionada[0],this.editarLinea=!0,this.MostrarFormularioLinea(),this.numeroLinea=this.lineaSolped.linenum,this.lineaSolped.itemcode&&(this.item=this.items.filter(o=>o.ItemCode===this.lineaSolped.itemcode)[0]),this.descripcion=this.lineaSolped.dscription,this.lineaSolped.linevendor&&(this.proveedor=this.proveedores.filter(o=>o.CardCode===this.lineaSolped.linevendor)[0]),this.lineaSolped.acctcode&&(this.cuenta=this.cuentas.filter(o=>o.Code===this.lineaSolped.acctcode)[0]),this.lineaSolped.ocrcode3&&(this.viceprecidencia=this.vicepresidencias.filter(o=>o.vicepresidency===this.lineaSolped.ocrcode3)[0],this.SeleccionarVicepresidencia()),this.lineaSolped.ocrcode2&&(this.dependencia=this.dependencias.filter(o=>o.dependence===this.lineaSolped.ocrcode2)[0],this.SeleccionarDependencia()),this.lineaSolped.ocrcode&&(this.localidad=this.localidades.filter(o=>o.location===this.lineaSolped.ocrcode)[0]),this.lineaSolped.whscode&&(this.almacenes.filter(o=>o.store===this.lineaSolped.whscode).length>0?(this.almacen=this.almacenes.filter(o=>o.store===this.lineaSolped.whscode)[0],this.zonacode=this.almacen.zonacode,console.log(this.zonacode)):this.almacen=""),this.lineaSolped.tax&&(this.impuesto=this.impuestos.filter(o=>o.Code===this.lineaSolped.tax)[0]),this.lineaSolped.acctcode&&(this.cuenta=this.cuentas.filter(o=>o.Code===this.lineaSolped.acctcode)[0],this.nombreCuenta=this.cuenta.Name),this.cantidad=this.lineaSolped.quantity||1,console.log(this.monedas,this.lineaSolped.moneda),this.moneda=this.monedas.filter(o=>o.Currency===this.lineaSolped.moneda).length>0?this.monedas.filter(o=>o.Currency===this.lineaSolped.moneda)[0].Currency:"COP",this.precio=this.lineaSolped.price||0,this.subtotalLinea=this.lineaSolped.linetotal,this.prcImpuesto=isNaN(100*(this.lineaSolped.linegtotal/this.lineaSolped.linetotal-1))?0:100*(this.lineaSolped.linegtotal/this.lineaSolped.linetotal-1),this.valorImpuesto=this.lineaSolped.linegtotal*(this.prcImpuesto/100),this.totalLinea=this.lineaSolped.linegtotal}BorrarLineas(){let o=[],t=!1;for(let a of this.lineasSolped){t=!1;for(let i of this.lineaSeleccionada)a===i&&(t=!0);t||o.push(a)}this.lineasSolped=o}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}}E.\u0275fac=function(o){return new(o||E)(e.Y36(x.e),e.Y36(w.c),e.Y36(Z.K),e.Y36(f.F0),e.Y36(u.ez),e.Y36(f.gz))},E.\u0275cmp=e.Xpm({type:E,selectors:[["app-form-solped-mp"]],viewQuery:function(o,t){if(1&o&&e.Gf(fe,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},inputs:{solpedEditar:"solpedEditar",registroSolped:"registroSolped"},outputs:{onNewSolped:"onNewSolped"},features:[e._Bn([u.ez])],decls:119,vars:115,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12"],[1,"card","p-fluid"],[1,"col"],[1,"field"],["htmlFor","nombreusuario"],["pInputText","","id","nombreusuario","name","nombreusuario","type","text","required","","readonly","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["htmlFor","area"],["optionLabel","area","optionValue","area","id","area","name","area","placeholder","Area","styleClass","p-dropdown-sm ",3,"options","ngModel","required","readonly","ngClass","ngModelChange","onChange"],["htmlFor","nf_pedmp"],["optionLabel","option","optionValue","value","id","nf_pedmp","name","nf_pedmp","styleClass","p-dropdown-sm ",3,"options","ngModel","required","ngClass","ngModelChange"],["htmlFor","nf_agente"],["pInputText","","id","nf_agente","name","nf_agente","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["htmlFor","nf_pago"],["pInputText","","id","nf_pago","name","nf_pago","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],[1,"flex"],["htmlFor","serie"],["optionLabel","name","optionValue","code","id","serie","name","serie","placeholder","Tipo","styleClass","w-full p-dropdown-sm p-inputtext-sm",3,"options","ngModel","readonly","required","ngClass","ngModelChange","onChange"],["htmlFor","codigoSap"],["pInputText","","id","codigoSap","name","codigoSap","styleClass","w-full ","type","text","required","","readonly","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["for","fechaContable"],["inputId","fechaContable","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","readonlyInput","ngClass","ngModelChange","onSelect"],["for","nf_lastshippping"],["inputId","nf_lastshippping","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","nf_dateofshipping"],["inputId","nf_dateofshipping","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","fechaNecesidad"],["inputId","fechaNecesidad","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["htmlFor","nf_tipocarga"],["optionLabel","tipo","optionValue","tipo","id","nf_tipocarga","name","nf_tipocarga","placeholder","Tipo de carga","styleClass","p-dropdown-sm ",3,"options","ngModel","required","ngModelChange"],["htmlFor","nf_puertosalida"],["pInputText","","id","nf_puertosalida","name","nf_puertosalida","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["htmlFor","nf_motonave"],["pInputText","","id","nf_motonave","name","nf_motonave","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["htmlFor","comentarios"],["rows","3","pInputTextarea","","id","comments",1,"w-full",3,"ngModel","ngModelChange"],["class","field col",4,"ngIf"],[1,"grid","align-content-center"],[1,"field","col"],["pButton","","label","Nueva L\xednea","icon","pi pi-list",1,"p-button-outlined","mb-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","label","Guardar","icon","pi pi-save",1,"p-button-outlined","mb-2","p-button-success","p-button-sm",3,"disabled","click"],["pButton","","label","Nueva solped","icon","pi pi-list",1,"p-button-outlined","mb-2","p-button-primary","p-button-sm",3,"disabled","click"],[3,"header","visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["pTemplate","content"],["pTemplate","footer"],["header","Detalle de la solicitud de pedido",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","linenum","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["header","Anexos de la solicitud de pedido",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","file.name","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["header","Cargar anexo",3,"visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["mode","indeterminate"],["label","Ver Detalle","icon","pi pi-search","styleClass","p-button-outlined mb-2 p-button-secondary p-button-sm","badgeClass","p-badge-danger",3,"disabled","badge","onClick"],["for","fechaRequerida"],["inputId","fechaRequerida","styleClass","w-full",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","proveedor"],["field","CardCode","panelStyleClass","text-sm sm:ml-2","inputStyleClass","w-full","styleClass","w-full","inputId","proveedor2",3,"ngModel","showEmptyMessage","suggestions","minLength","delay","ngModelChange","completeMethod","onSelect"],["pTemplate","item"],["for","itemCode"],["field","ItemCode","inputStyleClass","w-full","styleClass","w-full","inputId","itemCode","panelStyleClass","text-sm sm:ml-2",3,"ngModel","showEmptyMessage","suggestions","minLength","delay","showClear","autofocus","disabled","ngClass","ngModelChange","completeMethod","onSelect","onClear"],["for","descripcion"],["pInputText","","id","descripcion","name","descripcion","type","text","required","",1,"w-full",3,"ngModel","ngClass","ngModelChange"],["for","viceprecidencia"],["optionLabel","vicepresidency","filterBy","vicepresidency","placeholder","Seleccione una vicepresidencia","styleClass","w-full","inputId","viceprecidencia",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode3",""],["pTemplate","selectedItem"],["for","dependencia"],["optionLabel","dependence","placeholder","Seleccione una dependencia","filterBy","dependence","styleClass","w-full","inputId","dependencia",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode2",""],["for","localidad"],["optionLabel","location","placeholder","Seleccione una localidad","filterBy","location","styleClass","w-full","inputId","localidad",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode",""],["for","almacen"],["optionLabel","storename","placeholder","Seleccione una almacen","filterBy","storename","styleClass","w-full","inputId","almacen",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["for","cantidad"],["pInputText","","type","number","id","cantidad","placeholder","Cantidad","required","",1,"w-full",3,"ngModel","ngClass","ngModelChange","change"],["for","precio"],["optionLabel","Currency","optionValue","Currency","id","moneda","name","moneda",3,"options","ngModel","required","readonly","ngModelChange","onChange"],["inputId","precio","mode","currency","currency","COP","locale","es-CO","placeholder","Precio","styleClass","w-full",3,"ngModel","ngStyle","ngModelChange"],["for","subtotalLinea"],["inputId","subtotalLinea","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",3,"ngModel","ngStyle","readonly","ngModelChange"],["for","impuesto"],["optionLabel","Code","placeholder","Seleccione un impuesto","filterBy","Code","styleClass","w-full","inputId","impuesto",1,"w-full",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["suffix","%","inputStyleClass","text-center w-6","styleClass","text-center",3,"ngModel","readonly","disabled","ngModelChange"],["for","valorImpuesto"],["inputId","valorImpuesto","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",1,"w-full",3,"ngModel","ngStyle","readonly","disabled","ngModelChange"],["for","totalLinea"],["inputId","totalLinea","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",1,"w-full",3,"ngModel","disabled","readonly","ngModelChange"],["class","country-item country-item-value",4,"ngIf"],[1,"country-item","country-item-value"],[1,"country-item"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"disabled","click"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","label","Limpiar","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["pButton","","label","Nueva L\xednea","icon","pi pi-list",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","icon","pi pi-pencil",1,"p-button-outlined","mb-2","mr-2","p-button-secondary","p-button-sm",3,"label","disabled","click"],["pButton","","label","Borrar linea","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar por palabra clave",1,"w-full","p-inputtext-sm",3,"input"],["filter",""],[2,"width","3rem"],[1,"flex","justify-content-between","align-items-center"],["type","text","field","linenum","display","menu","placeholder","Buscar por linea detalle"],["type","text","field","itemcode","display","menu","placeholder","Buscar por c\xf3digo item"],["type","text","field","dscription","display","menu","placeholder","Buscar por descripci\xf3n"],["type","text","field","linevendor","display","menu","placeholder","Buscar por proveedor"],["type","text","field","acctcode","display","menu","placeholder","Buscar por cuenta"],["type","text","field","ocrcode3","display","menu","placeholder","Buscar por vicepresidencia"],["type","text","field","orecode2","display","menu","placeholder","Buscar por dependencia"],["type","text","field","location","display","menu","placeholder","Buscar por localidad"],[3,"value","onClick"],[2,"min-width","12rem"],["colspan","13",1,"text-right"],["colspan","16",1,"text-center"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"click"],["pButton","","label","Nuevo anexo","icon","pi pi-list",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","label","Borrar anexo","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],["type","text","field","tipo","display","menu","placeholder","Buscar por tipo anexo"],["type","text","field","nombre","display","menu","placeholder","Buscar por nombre"],["style","width: 1rem",4,"ngIf"],[2,"width","1rem"],[3,"value"],["style","min-width: 1rem;","class","flex justify-content-center flex-wrap",4,"ngIf"],[1,"flex","justify-content-center","flex-wrap",2,"min-width","1rem"],["icon","pi pi-download","label","","pTooltip","Descargar",1,"w-full",3,"click"],["for","tipoanexo"],["optionLabel","name","filterBy","name","placeholder","Seleccione el tipo del anexo","styleClass","w-full","inputId","tipoanexo",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["name","demo[]","chooseLabel","Seleccionar","cancelLabel","Cancelar","styleClass","w-full",1,"w-full",3,"multiple","showUploadButton","maxFileSize","ngClass","disabled","onSelect"],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast")(1,"app-breadcrumb",0),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",1)(6,"div",4)(7,"div",5)(8,"label",6),e._uU(9,"Nombre Solicitante"),e.qZA(),e.TgZ(10,"input",7),e.NdJ("ngModelChange",function(i){return t.infoUsuario.fullname=i}),e.qZA()(),e.TgZ(11,"div",5)(12,"label",8),e._uU(13,"Area"),e.qZA(),e.TgZ(14,"p-dropdown",9),e.NdJ("ngModelChange",function(i){return t.area=i})("onChange",function(){return t.SeleccionarArea()}),e.qZA()(),e.TgZ(15,"div",5)(16,"label",10),e._uU(17," Materia prima importada"),e.qZA(),e.TgZ(18,"p-dropdown",11),e.NdJ("ngModelChange",function(i){return t.nf_pedmp=i}),e.qZA()(),e.TgZ(19,"div",5)(20,"label",12),e._uU(21,"Agente"),e.qZA(),e.TgZ(22,"input",13),e.NdJ("ngModelChange",function(i){return t.nf_agente=i}),e.qZA()(),e.TgZ(23,"div",5)(24,"label",14),e._uU(25,"Tipo pago"),e.qZA(),e.TgZ(26,"input",15),e.NdJ("ngModelChange",function(i){return t.nf_pago=i}),e.qZA()(),e.TgZ(27,"div",5)(28,"label",14),e._uU(29,"Incoterms"),e.qZA(),e.TgZ(30,"input",15),e.NdJ("ngModelChange",function(i){return t.nf_Incoterms=i}),e.qZA()()(),e.TgZ(31,"div",4)(32,"div",16)(33,"div",5)(34,"label",17),e._uU(35,"Tipo"),e.qZA(),e.TgZ(36,"p-dropdown",18),e.NdJ("ngModelChange",function(i){return t.serie=i})("onChange",function(){return t.SeleccionarSerie()}),e.qZA()(),e.TgZ(37,"div",5)(38,"label",19),e._uU(39,"Codigo SAP"),e.qZA(),e.TgZ(40,"input",20),e.NdJ("ngModelChange",function(i){return t.codigoSap=i}),e.qZA()()(),e.TgZ(41,"div",16)(42,"div",5)(43,"label",21),e._uU(44,"Fecha Documento"),e.qZA(),e.TgZ(45,"p-calendar",22),e.NdJ("ngModelChange",function(i){return t.fechaContable=i})("onSelect",function(){return t.SeleccionarFechaContable()}),e.qZA()(),e.TgZ(46,"div",5)(47,"label",23),e._uU(48,"Fecha Cargue (LDS)"),e.qZA(),e.TgZ(49,"p-calendar",24),e.NdJ("ngModelChange",function(i){return t.nf_lastshippping=i}),e.qZA()()(),e.TgZ(50,"div",16)(51,"div",5)(52,"label",25),e._uU(53,"Fecha Salida (ETS)"),e.qZA(),e.TgZ(54,"p-calendar",26),e.NdJ("ngModelChange",function(i){return t.nf_dateofshipping=i}),e.qZA()(),e.TgZ(55,"div",5)(56,"label",27),e._uU(57,"Fecha Llegada (ETA)"),e.qZA(),e.TgZ(58,"p-calendar",28),e.NdJ("ngModelChange",function(i){return t.fechaNecesidad=i}),e.qZA()()(),e.TgZ(59,"div",5)(60,"label",29),e._uU(61,"Tipo carga"),e.qZA(),e.TgZ(62,"p-dropdown",30),e.NdJ("ngModelChange",function(i){return t.nf_tipocarga=i}),e.qZA()(),e.TgZ(63,"div",5)(64,"label",31),e._uU(65,"Puerto salida"),e.qZA(),e.TgZ(66,"input",32),e.NdJ("ngModelChange",function(i){return t.nf_puertosalida=i}),e.qZA()(),e.TgZ(67,"div",5)(68,"label",33),e._uU(69,"Motonave"),e.qZA(),e.TgZ(70,"input",34),e.NdJ("ngModelChange",function(i){return t.nf_motonave=i}),e.qZA()()()(),e.TgZ(71,"div",1)(72,"div",4)(73,"div",5)(74,"label",35),e._uU(75,"Comentarios"),e.qZA(),e.TgZ(76,"textarea",36),e.NdJ("ngModelChange",function(i){return t.comentarios=i}),e._uU(77,"                        "),e.qZA()()()(),e._UZ(78,"p-divider"),e.YNc(79,be,2,3,"div",37),e.TgZ(80,"div",1)(81,"div",4)(82,"div",38)(83,"div",39)(84,"button",40),e.NdJ("click",function(){return t.AdicionarLinea()}),e.qZA()(),e.YNc(85,Se,2,2,"div",37),e.qZA()()()()()(),e.TgZ(86,"div",1)(87,"div",2)(88,"div",3)(89,"div",1)(90,"div",4)(91,"button",41),e.NdJ("click",function(){return t.GuardarSolped()}),e.qZA()(),e.TgZ(92,"div",4)(93,"button",42),e.NdJ("click",function(){return t.NuevaSolped()}),e.qZA()()()()()(),e.TgZ(94,"p-dialog",43),e.NdJ("visibleChange",function(i){return t.formularioLinea=i})("onHide",function(){return t.envioLinea=!1}),e.YNc(95,ke,81,87,"ng-template",44),e.YNc(96,De,1,1,"ng-template",45),e.qZA(),e.TgZ(97,"p-dialog",46),e.NdJ("visibleChange",function(i){return t.listadoLineas=i}),e.TgZ(98,"p-table",47,48),e.NdJ("selectionChange",function(i){return t.lineaSeleccionada=i}),e.YNc(100,Oe,10,4,"ng-template",49),e.YNc(101,ze,55,0,"ng-template",50),e.YNc(102,Qe,39,33,"ng-template",51),e.YNc(103,Be,12,12,"ng-template",45),e.YNc(104,Re,3,0,"ng-template",52),e.YNc(105,Ke,3,0,"ng-template",53),e.qZA(),e.YNc(106,Ye,1,0,"ng-template",45),e.qZA(),e.TgZ(107,"p-dialog",54),e.NdJ("visibleChange",function(i){return t.listadoAnexos=i}),e.TgZ(108,"p-table",55,48),e.NdJ("selectionChange",function(i){return t.lineaAnexoSeleccionada=i}),e.YNc(110,Ge,9,2,"ng-template",49),e.YNc(111,je,14,1,"ng-template",50),e.YNc(112,Ve,10,5,"ng-template",51),e.YNc(113,Xe,3,0,"ng-template",52),e.YNc(114,We,3,0,"ng-template",53),e.qZA(),e.YNc(115,et,1,0,"ng-template",45),e.qZA(),e.TgZ(116,"p-dialog",56),e.NdJ("visibleChange",function(i){return t.formularioAnexo=i})("onHide",function(){return t.envioLinea=!1}),e.YNc(117,rt,12,14,"ng-template",44),e.YNc(118,st,1,1,"ng-template",45),e.qZA()),2&o&&(e.xp6(1),e.Q6J("urlBreadCrumb",t.urlBreadCrumb),e.xp6(9),e.Q6J("ngModel",t.infoUsuario.fullname),e.xp6(4),e.Q6J("options",t.areas)("ngModel",t.area)("required",!0)("readonly",t.lineasSolped.length>0)("ngClass",e.VKq(93,b,t.envioFormulario&&!t.area||t.nuevaLinea&&!t.area)),e.xp6(4),e.Q6J("options",t.materiaprima)("ngModel",t.nf_pedmp)("required",!0)("ngClass",e.VKq(95,b,t.envioFormulario&&!t.nf_pedmp||t.nuevaLinea&&!t.nf_pedmp)),e.xp6(4),e.Q6J("ngModel",t.nf_agente),e.xp6(4),e.Q6J("ngModel",t.nf_pago),e.xp6(4),e.Q6J("ngModel",t.nf_Incoterms),e.xp6(6),e.Q6J("options",t.series)("ngModel",t.serie)("readonly",t.lineasSolped.length>0)("required",!0)("ngClass",e.VKq(97,b,t.envioFormulario&&!t.serie||t.nuevaLinea&&!t.serie)),e.xp6(4),e.Q6J("ngModel",t.codigoSap),e.xp6(5),e.Q6J("ngModel",t.fechaContable)("showIcon",!0)("required",!0)("readonlyInput",!0)("ngClass",e.VKq(99,b,t.envioFormulario&&!t.fechaContable||t.nuevaLinea&&!t.fechaContable)),e.xp6(4),e.Q6J("ngModel",t.nf_lastshippping)("showIcon",!0)("required",!0)("ngClass",e.VKq(101,b,t.envioFormulario&&!t.nf_lastshippping||t.nuevaLinea&&!t.nf_lastshippping)),e.xp6(5),e.Q6J("ngModel",t.nf_dateofshipping)("showIcon",!0)("required",!0)("ngClass",e.VKq(103,b,t.envioFormulario&&!t.nf_dateofshipping||t.nuevaLinea&&!t.nf_dateofshipping)),e.xp6(4),e.Q6J("ngModel",t.fechaNecesidad)("showIcon",!0)("required",!0)("ngClass",e.VKq(105,b,t.envioFormulario&&!t.fechaNecesidad||t.nuevaLinea&&!t.fechaNecesidad)),e.xp6(4),e.Q6J("options",t.tiposdecarga)("ngModel",t.nf_tipocarga)("required",!0),e.xp6(4),e.Q6J("ngModel",t.nf_puertosalida),e.xp6(4),e.Q6J("ngModel",t.nf_motonave),e.xp6(6),e.Q6J("ngModel",t.comentarios),e.xp6(3),e.Q6J("ngIf",!0===t.loadingSave),e.xp6(5),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("ngIf",t.lineasSolped.length>0),e.xp6(6),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||t.registroSolped),e.xp6(2),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.envioFormulario),e.xp6(1),e.Akn(e.DdM(107,V)),e.Q6J("header",t.editarLinea?"Editar l\xednea":"Adicionar L\xednea")("visible",t.formularioLinea)("modal",!0)("breakpoints",e.DdM(108,me))("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(3),e.Akn(e.DdM(109,V)),e.Q6J("visible",t.listadoLineas)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(1),e.Q6J("value",t.lineasSolped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(110,dt))("selection",t.lineaSeleccionada),e.xp6(9),e.Akn(e.DdM(111,V)),e.Q6J("visible",t.listadoAnexos)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(1),e.Q6J("value",t.anexosSolped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(112,pt))("selection",t.lineaAnexoSeleccionada),e.xp6(8),e.Akn(e.DdM(113,V)),e.Q6J("visible",t.formularioAnexo)("modal",!0)("breakpoints",e.DdM(114,me))("maximizable",!0)("draggable",!1)("resizable",!1))},dependencies:[_.mk,_.sg,_.O5,_.PC,h.Fj,h.wV,h.JJ,h.Q7,h.On,de.Qc,u.jx,T.Hq,T.zx,q.u,ee.f,N.V,pe.i,F.Lt,ce.p,P.k,ue.Rn,D.g,O.o,S.iA,S.UA,S.xl,M.FN,z.L,_.Zx,_.H9,_.uU],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]});class Q{constructor(o,t,a,i,l){this.rutaActiva=o,this.messageService=t,this.authService=a,this.router=i,this.comprasService=l}ngOnInit(){this.solpedSeleccionada=this.rutaActiva.snapshot.params}actualizarSolped(o){this.comprasService.updateSolpedMP(this.authService.getToken(),o).subscribe({next:t=>{501===t.status?this.messageService.add({severity:"error",summary:"!Error",detail:JSON.stringify(t.err)}):(console.log(o.solped.approved),"A"==o.solped.approved?this.comprasService.actualizarSolpedSAP(this.authService.getToken(),o).subscribe({next:a=>{this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:a.message}),setTimeout(()=>{this.router.navigate(["portal/compras/solped/tracking"])},2e3)},error:a=>{console.log(a)}}):(this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:t.message}),setTimeout(()=>{this.router.navigate(["portal/compras/solped/tracking"])},2e3)))},error:t=>{console.log(t)}})}}Q.\u0275fac=function(o){return new(o||Q)(e.Y36(f.gz),e.Y36(u.ez),e.Y36(x.e),e.Y36(f.F0),e.Y36(Z.K))},Q.\u0275cmp=e.Xpm({type:Q,selectors:[["app-edit-solped-mp"]],features:[e._Bn([u.ez])],decls:2,vars:1,consts:[[3,"solpedEditar","onNewSolped"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast"),e.TgZ(1,"app-form-solped-mp",0),e.NdJ("onNewSolped",function(i){return t.actualizarSolped(i)}),e.qZA()),2&o&&(e.xp6(1),e.Q6J("solpedEditar",t.solpedSeleccionada.solped))},dependencies:[M.FN,E]});var ct=d(8639);const ut=["filter"];function mt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",29)(1,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.importarCSV())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)}}function _t(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",29)(1,"p-button",50),e.NdJ("onClick",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.MostrarDetalle())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].read_accion)("badge",t.lineasSolped.length.toString())}}function ht(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.CardCode," - ",t.CardName,"")}}function gt(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.ItemCode," - ",t.ItemName,"")}}function ft(n,o){if(1&n&&(e.TgZ(0,"div",94)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.viceprecidencia.vicepresidency)}}function Ct(n,o){if(1&n&&e.YNc(0,ft,3,1,"div",93),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.viceprecidencia)}}function bt(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.vicepresidency)}}function St(n,o){if(1&n&&(e.TgZ(0,"div",94)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.dependencia.dependence)}}function vt(n,o){if(1&n&&e.YNc(0,St,3,1,"div",93),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.dependencia)}}function Tt(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.dependence)}}function yt(n,o){if(1&n&&(e.TgZ(0,"div",94)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.localidad.location)}}function xt(n,o){if(1&n&&e.YNc(0,yt,3,1,"div",93),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.localidad)}}function Zt(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.location)}}function At(n,o){if(1&n&&(e.TgZ(0,"div",94)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.almacen.store)}}function Mt(n,o){if(1&n&&e.YNc(0,At,3,1,"div",93),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.almacen)}}function Ut(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.store)}}function Nt(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.Code," - ",t.Name,"")}}function wt(n,o){if(1&n&&(e.TgZ(0,"div",94)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.impuesto.Code)}}function qt(n,o){if(1&n&&e.YNc(0,wt,3,1,"div",93),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.impuesto)}}function Ft(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.AsE("",t.Code," - ",t.Name,"")}}const g=function(n){return{"ng-invalid ng-dirty":n}},oe=function(){return{width:"100%"}};function Pt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",29)(2,"label",51),e._uU(3,"Fecha necesaria"),e.qZA(),e.TgZ(4,"p-calendar",52),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.fechaRequerida=i)}),e.qZA()(),e.TgZ(5,"div",29)(6,"label",53),e._uU(7,"Proveedor"),e.qZA(),e.TgZ(8,"p-autoComplete",54),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.proveedor=i)})("completeMethod",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.filtrarProveedores(i))})("onSelect",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarProveedor())}),e.YNc(9,ht,2,2,"ng-template",55),e.qZA()()(),e.TgZ(10,"div",1)(11,"div",29)(12,"label",56),e._uU(13,"C\xf3digo \xedtem"),e.qZA(),e.TgZ(14,"p-autoComplete",57),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.item=i)})("completeMethod",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.filtrarItems(i))})("onSelect",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarItemCode())})("onClear",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearItemCode())}),e.YNc(15,gt,2,2,"ng-template",55),e.qZA()(),e.TgZ(16,"div",29)(17,"label",58),e._uU(18,"Descripci\xf3n"),e.qZA(),e.TgZ(19,"div",59)(20,"input",60),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.descripcion=i)}),e.qZA(),e.TgZ(21,"span",61),e._UZ(22,"p-badge",62),e.qZA()()()(),e.TgZ(23,"div",1)(24,"div",29)(25,"label",63),e._uU(26,"Vicepresidencia"),e.qZA(),e.TgZ(27,"p-dropdown",64,65),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.viceprecidencia=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarVicepresidencia())}),e.YNc(29,Ct,1,1,"ng-template",66),e.YNc(30,bt,3,1,"ng-template",55),e.qZA()(),e.TgZ(31,"div",29)(32,"label",67),e._uU(33,"Dependencia"),e.qZA(),e.TgZ(34,"p-dropdown",68,69),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.dependencia=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarDependencia())}),e.YNc(36,vt,1,1,"ng-template",66),e.YNc(37,Tt,3,1,"ng-template",55),e.qZA()(),e.TgZ(38,"div",29)(39,"label",70),e._uU(40,"Localidad"),e.qZA(),e.TgZ(41,"p-dropdown",71,72),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.localidad=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarLocalidad())}),e.YNc(43,xt,1,1,"ng-template",66),e.YNc(44,Zt,3,1,"ng-template",55),e.qZA()()(),e.TgZ(45,"div",1)(46,"div",29)(47,"label",73),e._uU(48,"Almacen"),e.qZA(),e.TgZ(49,"p-dropdown",74),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.almacen=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarAlmacen())}),e.YNc(50,Mt,1,1,"ng-template",66),e.YNc(51,Ut,3,1,"ng-template",55),e.qZA()()(),e.TgZ(52,"div",1)(53,"div",29)(54,"label",75),e._uU(55,"Cuenta Mayor"),e.qZA(),e.TgZ(56,"p-autoComplete",76),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.cuenta=i)})("completeMethod",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.filtrarCuentas(i))})("onSelect",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarCuenta())}),e.YNc(57,Nt,2,2,"ng-template",55),e.qZA()(),e.TgZ(58,"div",29)(59,"label",77),e._uU(60,"Nombre cuenta"),e.qZA(),e.TgZ(61,"input",78),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.nombreCuenta=i)}),e.qZA()()(),e.TgZ(62,"div",1)(63,"div",29)(64,"label",79),e._uU(65,"Cantidad"),e.qZA(),e.TgZ(66,"input",80),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.cantidad=i)})("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.calcularSubtotalLinea())}),e.qZA()(),e.TgZ(67,"div",29)(68,"label",81),e._uU(69,"Precio"),e.qZA(),e.TgZ(70,"div",12)(71,"p-dropdown",82),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.moneda=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarMoneda())}),e.qZA(),e.TgZ(72,"p-inputNumber",83),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.precio=i)})("ngModelChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.calcularSubtotalLinea())}),e.qZA()()(),e.TgZ(73,"div",29)(74,"label",84),e._uU(75,"Subtotal l\xednea"),e.qZA(),e.TgZ(76,"p-inputNumber",85),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.subtotalLinea=i)}),e.qZA()()(),e.TgZ(77,"div",1)(78,"div",29)(79,"label",86),e._uU(80,"Impuesto"),e.qZA(),e.TgZ(81,"div",12)(82,"p-dropdown",87),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.impuesto=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarImpuesto())}),e.YNc(83,qt,1,1,"ng-template",66),e.YNc(84,Ft,3,2,"ng-template",55),e.qZA(),e.TgZ(85,"p-inputNumber",88),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.prcImpuesto=i)}),e.qZA()()(),e.TgZ(86,"div",29)(87,"label",89),e._uU(88,"Valor impuesto"),e.qZA(),e.TgZ(89,"p-inputNumber",90),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.valorImpuesto=i)}),e.qZA()(),e.TgZ(90,"div",29)(91,"label",91),e._uU(92,"Total linea"),e.qZA(),e.TgZ(93,"p-inputNumber",92),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.totalLinea=i)}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.fechaRequerida)("showIcon",!0)("required",!0)("ngClass",e.VKq(79,g,t.envioLinea&&!t.fechaRequerida)),e.xp6(4),e.Q6J("ngModel",t.proveedor)("showEmptyMessage",!0)("suggestions",t.proveedoresFiltrados)("minLength",1)("delay",1e3),e.xp6(6),e.Q6J("ngModel",t.item)("showEmptyMessage",!0)("suggestions",t.itemsFiltrados)("minLength",1)("delay",1e3)("autofocus",!0)("disabled","S"===t.clase)("ngClass",e.VKq(81,g,"I"===t.clase&&t.envioLinea&&!t.item.ItemCode)),e.xp6(6),e.Q6J("ngModel",t.descripcion)("ngClass",e.VKq(83,g,t.envioLinea&&!t.descripcion)),e.xp6(2),e.Q6J("value",t.descripcion.length.toString()),e.xp6(5),e.Q6J("options",t.vicepresidencias)("ngModel",t.viceprecidencia)("filter",!0)("showClear",!0)("ngClass",e.VKq(85,g,t.envioLinea&&!t.viceprecidencia.vicepresidency)),e.xp6(7),e.Q6J("options",t.dependencias)("ngModel",t.dependencia)("filter",!0)("showClear",!0)("ngClass",e.VKq(87,g,t.envioLinea&&!t.dependencia.dependence)),e.xp6(7),e.Q6J("options",t.localidades)("ngModel",t.localidad)("filter",!0)("showClear",!0)("ngClass",e.VKq(89,g,t.envioLinea&&!t.localidad.location)),e.xp6(8),e.Q6J("options",t.almacenes)("ngModel",t.almacen)("filter",!0)("showClear",!0),e.xp6(7),e.Q6J("ngModel",t.cuenta)("showEmptyMessage",!0)("suggestions",t.cuentasFiltradas)("minLength",1)("delay",1e3)("disabled",!t.validaCuenta)("ngClass",e.VKq(91,g,t.envioLinea&&!t.cuenta.Code&&t.validaCuenta)),e.xp6(5),e.Q6J("ngModel",t.nombreCuenta)("ngClass",e.VKq(93,g,t.envioLinea&&!t.nombreCuenta&&t.validaCuenta)),e.xp6(5),e.Q6J("ngModel",t.cantidad)("ngClass",e.VKq(95,g,t.envioLinea&&!t.cantidad)),e.xp6(5),e.Q6J("options",t.monedas)("ngModel",t.moneda)("required",!0)("readonly",t.lineasSolped.length>0),e.xp6(1),e.Q6J("ngModel",t.precio)("ngStyle",e.DdM(97,oe))("ngClass",e.VKq(98,g,t.envioLinea&&!t.precio)),e.xp6(4),e.Q6J("ngModel",t.subtotalLinea)("ngStyle",e.DdM(100,oe))("readonly",!0)("ngClass",e.VKq(101,g,t.envioLinea&&!t.subtotalLinea)),e.xp6(6),e.Q6J("options",t.impuestos)("ngModel",t.impuesto)("filter",!0)("showClear",!0)("ngClass",e.VKq(103,g,t.envioLinea&&!t.impuesto)),e.xp6(3),e.Q6J("ngModel",t.prcImpuesto)("readonly",!0)("disabled",!0)("ngClass",e.VKq(105,g,t.envioLinea&&!t.prcImpuesto)),e.xp6(4),e.Q6J("ngModel",t.valorImpuesto)("ngStyle",e.DdM(107,oe))("readonly",!0)("disabled",!0)("ngClass",e.VKq(108,g,t.envioLinea&&!t.valorImpuesto)),e.xp6(4),e.Q6J("ngModel",t.totalLinea)("disabled",!0)("readonly",!0)("ngClass",e.VKq(110,g,t.envioLinea&&!t.totalLinea))}}function Et(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",96),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.RegistrarLinea())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion)}}function Lt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",97)(1,"div")(2,"button",98),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(77);return e.KtG(i.clear(l))}),e.qZA(),e.TgZ(3,"button",99),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.AdicionarLinea())}),e.qZA(),e.TgZ(4,"button",100),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.EditarLinea())}),e.qZA(),e.TgZ(5,"button",101),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.BorrarLineas())}),e.qZA()(),e.TgZ(6,"span",102),e._UZ(7,"i",103),e.TgZ(8,"input",104,105),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(77);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("label",t.permisosUsuarioPagina.length>0&&t.permisosUsuarioPagina[0].create_accion?"Editar L\xednea":"Consultar")("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaSeleccionada||1!=t.lineaSeleccionada.length||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaSeleccionada||0==t.lineaSeleccionada.length||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)}}function Jt(n,o){1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",106),e.TgZ(2,"th")(3,"div",107),e._uU(4," L\xednea detalle "),e._UZ(5,"p-columnFilter",108),e.qZA()(),e.TgZ(6,"th")(7,"div",107),e._uU(8," C\xf3digo \xcdtem "),e._UZ(9,"p-columnFilter",109),e.qZA()(),e.TgZ(10,"th")(11,"div",107),e._uU(12," Descripci\xf3n "),e._UZ(13,"p-columnFilter",110),e.qZA()(),e.TgZ(14,"th")(15,"div",107),e._uU(16," Fecha requerida "),e.qZA()(),e.TgZ(17,"th")(18,"div",107),e._uU(19," Proveedor "),e._UZ(20,"p-columnFilter",111),e.qZA()(),e.TgZ(21,"th")(22,"div",107),e._uU(23," Cuenta Mayor "),e._UZ(24,"p-columnFilter",112),e.qZA()(),e.TgZ(25,"th")(26,"div",107),e._uU(27," Vicepresidencia "),e._UZ(28,"p-columnFilter",113),e.qZA()(),e.TgZ(29,"th")(30,"div",107),e._uU(31," Dependencia "),e._UZ(32,"p-columnFilter",114),e.qZA()(),e.TgZ(33,"th")(34,"div",107),e._uU(35," Localidad "),e._UZ(36,"p-columnFilter",115),e.qZA()(),e.TgZ(37,"th")(38,"div",107),e._uU(39," Cantidad "),e.qZA()(),e.TgZ(40,"th")(41,"div",107),e._uU(42," Precio "),e.qZA()(),e.TgZ(43,"th")(44,"div",107),e._uU(45," Impuesto "),e.qZA()(),e.TgZ(46,"th")(47,"div",107),e._uU(48," Valor Impuesto "),e.qZA()(),e.TgZ(49,"th")(50,"div",107),e._uU(51," Subtotal l\xednea "),e.qZA()(),e.TgZ(52,"th")(53,"div",107),e._uU(54," Total l\xednea "),e.qZA()()())}function It(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"p-tableCheckbox",116),e.NdJ("onClick",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.SeleccionarLinea())}),e.qZA()(),e.TgZ(3,"td",117),e._uU(4),e.qZA(),e.TgZ(5,"td",117),e._uU(6),e.qZA(),e.TgZ(7,"td",117),e._uU(8),e.qZA(),e.TgZ(9,"td",117),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td",117),e._uU(13),e.qZA(),e.TgZ(14,"td",117),e._uU(15),e.qZA(),e.TgZ(16,"td",117),e._uU(17),e.qZA(),e.TgZ(18,"td",117),e._uU(19),e.qZA(),e.TgZ(20,"td",117),e._uU(21),e.qZA(),e.TgZ(22,"td",117),e._uU(23),e.qZA(),e.TgZ(24,"td",117),e._uU(25),e.ALo(26,"currency"),e.qZA(),e.TgZ(27,"td",117),e._uU(28),e.ALo(29,"percent"),e.qZA(),e.TgZ(30,"td",117),e._uU(31),e.ALo(32,"currency"),e.qZA(),e.TgZ(33,"td",117),e._uU(34),e.ALo(35,"currency"),e.qZA(),e.TgZ(36,"td",117),e._uU(37),e.ALo(38,"currency"),e.qZA()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.linenum," "),e.xp6(2),e.hij(" ",t.itemcode," "),e.xp6(2),e.hij(" ",t.dscription," "),e.xp6(2),e.hij(" ",e.lcZ(11,17,t.reqdatedet)," "),e.xp6(3),e.hij(" ",t.linevendor," "),e.xp6(2),e.hij(" ",t.acctcode," "),e.xp6(2),e.hij(" ",t.ocrcode3," "),e.xp6(2),e.hij(" ",t.ocrcode2," "),e.xp6(2),e.hij(" ",t.ocrcode," "),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",e.xi3(26,19,t.price,t.moneda)," "),e.xp6(3),e.AsE(" ",t.tax," ",e.lcZ(29,22,t.linegtotal/t.linetotal-1)," "),e.xp6(3),e.hij(" ",e.xi3(32,24,t.taxvalor,"COP")," "),e.xp6(3),e.hij(" ",e.xi3(35,27,t.linetotal,"COP")," "),e.xp6(3),e.hij(" ",e.xi3(38,30,t.linegtotal,"COP")," ")}}function kt(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",118),e._uU(2,"Total"),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"currency"),e.qZA()()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(e.xi3(5,3,t.totalimpuestos,"COP")),e.xp6(3),e.Oqu(e.xi3(8,6,t.subtotal,"COP")),e.xp6(3),e.Oqu(e.xi3(11,9,t.grantotal,"COP"))}}function Dt(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",119),e._uU(2,"No se econtraron lineas asociadas a la solped."),e.qZA()())}function Ot(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",119),e._uU(2,"Cargando solicitudes de pedido. Por favor espere"),e.qZA()())}function zt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",120),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.listadoLineas=!1)}),e.qZA()}}function Qt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",97)(1,"div")(2,"button",98),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(77);return e.KtG(i.clear(l))}),e.qZA(),e.TgZ(3,"button",121),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.AdicionarAnexo())}),e.qZA(),e.TgZ(4,"button",122),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.BorrarAnexo())}),e.qZA()(),e.TgZ(5,"span",102),e._UZ(6,"i",103),e.TgZ(7,"input",104,105),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(77);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.lineaAnexoSeleccionada||0==t.lineaAnexoSeleccionada.length||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)}}function Bt(n,o){1&n&&(e.TgZ(0,"th",126),e._UZ(1,"div",107),e.qZA())}function Rt(n,o){if(1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",106),e.TgZ(2,"th")(3,"div",107),e._uU(4," Tipo "),e._UZ(5,"p-columnFilter",123),e.qZA()(),e.TgZ(6,"th")(7,"div",107),e._uU(8," Nombre anexo "),e._UZ(9,"p-columnFilter",124),e.qZA()(),e.TgZ(10,"th")(11,"div",107),e._uU(12," Tama\xf1o anexo "),e.qZA()(),e.YNc(13,Bt,2,0,"th",125),e.qZA()),2&n){const t=e.oxw();e.xp6(13),e.Q6J("ngIf",t.solpedEditar)}}function Kt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",128)(1,"p-button",129),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw();return e.KtG(l.consultarAnexo3(i.url))}),e.qZA()()}}function Yt(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",62),e.qZA(),e.TgZ(3,"td",117),e._uU(4),e.qZA(),e.TgZ(5,"td",117),e._uU(6),e.qZA(),e.TgZ(7,"td",117),e._uU(8),e.qZA(),e.YNc(9,Kt,2,0,"td",127),e.qZA()),2&n){const t=o.$implicit,a=e.oxw();e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.tipo," "),e.xp6(2),e.hij(" ",t.file.name," "),e.xp6(2),e.hij(" ",t.file.size," "),e.xp6(1),e.Q6J("ngIf",a.solpedEditar)}}function Gt(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",119),e._uU(2,"No se econtraron anexos asociados a la solped."),e.qZA()())}function Ht(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",119),e._uU(2,"Cargando anexos asociados a la solicitud de pedido. Por favor espere"),e.qZA()())}function jt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",120),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.listadoAnexos=!1)}),e.qZA()}}function $t(n,o){if(1&n&&(e.TgZ(0,"div",94)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.tipoanexo.name)}}function Vt(n,o){if(1&n&&e.YNc(0,$t,3,1,"div",93),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.tipoanexo)}}function Xt(n,o){if(1&n&&(e.TgZ(0,"div",95)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.name)}}function Wt(n,o){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.name," - ",t.size," bytes")}}function eo(n,o){if(1&n&&(e.TgZ(0,"ul"),e.YNc(1,Wt,2,2,"li",134),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.uploadedFiles)}}function to(n,o){if(1&n&&e.YNc(0,eo,2,1,"ul",133),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.uploadedFiles.length)}}function oo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",29)(2,"label",130),e._uU(3,"Tipo anexo"),e.qZA(),e.TgZ(4,"p-dropdown",131,65),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.tipoanexo=i)})("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.seleccionarTipoAnexo())}),e.YNc(6,Vt,1,1,"ng-template",66),e.YNc(7,Xt,3,1,"ng-template",55),e.qZA()()(),e.TgZ(8,"div",1)(9,"div",29)(10,"p-fileUpload",132),e.NdJ("onSelect",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.onLoad(i))}),e.YNc(11,to,1,1,"ng-template",35),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("options",t.tiposanexo)("ngModel",t.tipoanexo)("filter",!0)("showClear",!0)("ngClass",e.VKq(10,g,t.envioLineaanexo&&!t.tipoanexo||t.envioLineaanexo&&""==t.tipoanexo)),e.xp6(6),e.Q6J("multiple",!1)("showUploadButton",!1)("maxFileSize",5e7)("ngClass",e.VKq(12,g,t.envioLineaanexo&&!t.fileTmp||t.envioLineaanexo&&""==t.fileTmp))("disabled",!t.tipoanexo)}}function io(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",96),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.adicionarlineaAnexo())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion)}}function ao(n,o){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.name," - ",t.size," bytes")}}function no(n,o){if(1&n&&(e.TgZ(0,"ul"),e.YNc(1,ao,2,2,"li",134),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.uploadedFiles2)}}function lo(n,o){if(1&n&&e.YNc(0,no,2,1,"ul",133),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.uploadedFiles2.length)}}const ro=function(){return{height:"6px"}};function so(n,o){1&n&&(e.TgZ(0,"div",29),e._UZ(1,"p-progressBar",136),e.qZA()),2&n&&(e.xp6(1),e.Akn(e.DdM(2,ro)))}function po(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",29)(2,"p-fileUpload",135),e.NdJ("onSelect",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.onLoad2(i))}),e.YNc(3,lo,1,1,"ng-template",35),e.qZA(),e.YNc(4,so,2,3,"div",28),e.TgZ(5,"div",29)(6,"p"),e._uU(7," Para diligenciar correctamente la plantilla de cargue de la solped, siga las siguentes recomendaciones: "),e.qZA(),e.TgZ(8,"p"),e._uU(9," Columna "),e.TgZ(10,"strong"),e._uU(11,"ITEM"),e.qZA(),e._uU(12,": El c\xf3digo del item debe existir en el maestro de SAP "),e.qZA(),e.TgZ(13,"p"),e._uU(14," Columna "),e.TgZ(15,"strong"),e._uU(16,"DESCITEM"),e.qZA(),e._uU(17,": Es de caracter obligatorio, el n\xfamero m\xe1ximo de caracteres es de "),e.TgZ(18,"strong"),e._uU(19,"200"),e.qZA()(),e.TgZ(20,"p"),e._uU(21," Columna "),e.TgZ(22,"strong"),e._uU(23,"FECHAREQ"),e.qZA(),e._uU(24,": Debe ser una fecha valida "),e.qZA(),e.TgZ(25,"p"),e._uU(26," Columna "),e.TgZ(27,"strong"),e._uU(28,"IDPROVEEDOR"),e.qZA(),e._uU(29,":El c\xf3digo del proveedor debe ser un codigo v\xe1lido en SAP "),e.qZA(),e.TgZ(30,"p"),e._uU(31," Columna "),e.TgZ(32,"strong"),e._uU(33,"IMPUESTO"),e.qZA(),e._uU(34,":El c\xf3digo del impuesto debe ser un codigo v\xe1lido en SAP "),e.qZA(),e.TgZ(35,"p"),e._uU(36," Columna "),e.TgZ(37,"strong"),e._uU(38,"VICEPRESIDENCIA"),e.qZA(),e._uU(39,":Es de caracter obligatorio, el c\xf3digo de la vicepresidencia debe ser un codigo v\xe1lido en SAP y permitido para el usuario creador "),e.qZA(),e.TgZ(40,"p"),e._uU(41," Columna "),e.TgZ(42,"strong"),e._uU(43,"DEPENDENCIA"),e.qZA(),e._uU(44,":Es de caracter obligatorio, el c\xf3digo de la dependencia debe ser un codigo v\xe1lido en SAP y permitido para el usuario creador "),e.qZA(),e.TgZ(45,"p"),e._uU(46," Columna "),e.TgZ(47,"strong"),e._uU(48,"LOCALIDAD"),e.qZA(),e._uU(49,":Es de caracter obligatorio, el c\xf3digo de la localidad debe ser un codigo v\xe1lido en SAP y permitido para el usuario creador "),e.qZA(),e.TgZ(50,"p"),e._uU(51," Columna "),e.TgZ(52,"strong"),e._uU(53,"ALMACEN"),e.qZA(),e._uU(54,":El c\xf3digo del almacen debe ser un codigo v\xe1lido en SAP y permitido para el usuario creador "),e.qZA(),e.TgZ(55,"p"),e._uU(56," Columna "),e.TgZ(57,"strong"),e._uU(58,"CODCUENTA"),e.qZA(),e._uU(59,":El c\xf3digo de la cuenta contable debe ser un codigo v\xe1lido en SAP y permitido para el usuario creador "),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("multiple",!1)("showUploadButton",!1)("maxFileSize",2e7)("ngClass",e.VKq(5,g,!t.fileTmp2)),e.xp6(2),e.Q6J("ngIf",t.loadingCargueCSV)}}function co(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",137),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.descargarCSV())}),e.qZA(),e.TgZ(1,"p-button",96),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.adicionarCSV())}),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.cargueValido)}}const B=function(){return{width:"50vw"}},ie=function(){return{"960px":"75vw","640px":"100vw"}},uo=function(){return["itemcode","dscription","linevendor","acctcodename","acctcode","ocrcode","ocrcode2","ocrcode3"]},mo=function(){return["tipo","file.name","created_at"]};class L{constructor(o,t,a,i,l,r){this.authService=o,this.sapService=t,this.comprasService=a,this.router=i,this.messageService=l,this.rutaActiva=r,this.onNewSolped=new e.vpe,this.perfilesUsuario=[],this.permisosUsuario=[],this.dependenciasUsuario=[],this.vicepresidencias=[],this.dependencias=[],this.localidades=[],this.series=[],this.areas=[],this.clases=[],this.proveedores=[],this.items=[],this.cuentas=[],this.almacenes=[],this.monedas=[],this.trm=0,this.impuestos=[],this.nombreusuario="",this.area="",this.clase="",this.serie="",this.serieName="",this.codigoSap="0",this.fechaContable=new Date,this.fechaCaducidad=new Date,this.fechaDocumento=new Date,this.fechaNecesidad=new Date,this.comentarios="",this.currency="COP",this.iteradorLinea=0,this.numeroLinea=-1,this.fechaRequerida=new Date,this.descripcion="",this.almacen="",this.nombreCuenta="",this.cantidad=1,this.moneda="",this.precio=0,this.subtotalLinea=0,this.impuesto="",this.prcImpuesto=0,this.valorImpuesto=0,this.totalLinea=0,this.totalimpuestos=0,this.subtotal=0,this.grantotal=0,this.lineasSolped=[],this.lineasSolpedCVS=[],this.lineaSeleccionada=[],this.anexosSolped=[],this.lineaAnexoSeleccionada=[],this.envioFormulario=!1,this.nuevaLinea=!1,this.editarLinea=!1,this.formularioLinea=!1,this.formularioAnexo=!1,this.envioLinea=!1,this.formularioCSV=!1,this.envioLineaanexo=!1,this.listadoLineas=!1,this.listadoAnexos=!1,this.uploadedFiles=[],this.uploadedFiles2=[],this.tiposanexoBk=[{name:"Revisi\xf3n presupuestal"},{name:"Especificaci\xf3n t\xe9cnica"},{name:"Otro"}],this.tiposanexo=[{name:"Revisi\xf3n presupuestal"},{name:"Especificaci\xf3n t\xe9cnica"},{name:"Otro"}],this.loading=!1,this.solpedAprobada="N",this.urlBreadCrumb="",this.validaCuenta=!0,this.proveedoresFiltrados=[],this.itemsFiltrados=[],this.cuentasFiltradas=[],this.cargueValido=!1,this.loadingCargueCSV=!1}ngOnInit(){this.getInfoUsuario(),this.getPerfilesUsuario(),this.getPermisosUsuario(),this.getPermisosUsuarioPagina(),this.getDependenciasUsuario(),this.getSeries(),this.getAreas(),this.getClases(),this.getProveedores(),this.getItems(),this.getAlmacenes(),this.getCuentas(),this.getMonedas(new Date),this.getImpuestos(),setTimeout(()=>{this.getInformacionSolped()},500),this.resetearFormularioLinea()}getInfoUsuario(){this.infoUsuario=this.authService.getInfoUsuario()}getPerfilesUsuario(){this.perfilesUsuario=this.authService.getPerfilesUsuario()}getPermisosUsuario(){this.permisosUsuario=this.authService.getPermisosUsuario()}getPermisosUsuarioPagina(){let o="";if(this.rutaActiva.snapshot.params.solped){let t=this.rutaActiva.snapshot.params;this.router.url.indexOf("/"+t.solped)>=0&&(o=this.router.url.substring(0,this.router.url.indexOf("/"+t.solped)))}else o=this.router.url;this.urlBreadCrumb=o,this.permisosUsuarioPagina=this.permisosUsuario.filter(t=>t.url===o)}getDependenciasUsuario(){this.authService.getDependeciasUsuarioXE().subscribe({next:o=>{for(let t in o)this.dependenciasUsuario.push(o[t]);for(let t of this.dependenciasUsuario)0===this.vicepresidencias.filter(a=>a.vicepresidency===t.vicepresidency).length&&this.vicepresidencias.push(t)},error:o=>{}})}getSeries(){this.sapService.seriesDocXEngineSAP(this.authService.getToken(),"1470000113").subscribe({next:o=>{for(let t in o)"SPMP"!=o[t].name&&"N"==o[t].Estado&&this.series.push(o[t]);this.serie=this.series[0].code,this.serieName=this.series[0].name,this.clase="I"},error:o=>{}})}getAreas(){var o=this;return(0,C.Z)(function*(){yield o.authService.getAreasUsuarioXE().subscribe({next:t=>{for(let a in t)o.areas.push(t[a])},error:t=>{}})})()}getClases(){this.clases=[{code:"I",name:"Art\xedculo"},{code:"S",name:"Servicio"}]}getProveedores(){this.sapService.BusinessPartnersXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.proveedores.push(o[t])},error:o=>{}})}getItems(){this.sapService.itemsSolpedSAPXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.items.push(o[t])},error:o=>{}})}getCuentas(){this.sapService.CuentasSAPXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.cuentas.push(o[t])},error:o=>{}})}getAlmacenes(){this.authService.getAlmacenesUsuarioXE().subscribe({next:o=>{for(let t in o)this.almacenes.push(o[t])},error:o=>{}})}getMonedas(o){this.sapService.monedasXEngineSAP(this.authService.getToken(),o.toISOString()).subscribe({next:t=>{this.monedas=[{Currency:"COP",TRM:1}];for(let a in t)this.monedas.push(t[a]);this.setearTRMSolped("USD")},error:t=>{}})}getImpuestos(){this.comprasService.taxesXE(this.authService.getToken()).subscribe({next:o=>{for(let t in o)this.impuestos.push(o[t])},error:o=>{}})}getInformacionSolped(){this.solpedEditar&&this.comprasService.solpedById(this.authService.getToken(),this.solpedEditar).subscribe({next:o=>{this.infoSolpedEditar=o,this.lineasSolped=this.infoSolpedEditar.solpedDet;for(let a of this.infoSolpedEditar.anexos)this.anexosSolped.push({tipo:a.tipo,file:{name:a.nombre,size:a.size},url:a.ruta,idanexo:a.id});this.serie=this.series.filter(a=>a.code==this.infoSolpedEditar.solped.serie)[0].code,this.codigoSap=this.infoSolpedEditar.solped.sapdocnum||"0",this.clase=this.infoSolpedEditar.solped.doctype||"";let t=36e5;this.fechaContable=new Date(new Date(this.infoSolpedEditar.solped.docdate).getTime()+5*t),this.fechaCaducidad=new Date(new Date(this.infoSolpedEditar.solped.docduedate).getTime()+5*t),this.fechaDocumento=new Date(new Date(this.infoSolpedEditar.solped.taxdate).getTime()+5*t),this.fechaNecesidad=new Date(new Date(this.infoSolpedEditar.solped.reqdate).getTime()+5*t),this.comentarios=this.infoSolpedEditar.solped.comments||"",this.trm=this.infoSolpedEditar.solped.trm,this.currency=this.infoSolpedEditar.solped.currency||1===this.trm?"COP":"USD",this.iteradorLinea=this.lineasSolped[this.lineasSolped.length-1].linenum+1,this.solpedAprobada=this.infoSolpedEditar.solped.approved||"N",this.areas.length>0&&this.areas.filter(a=>a.area===this.infoSolpedEditar.solped.u_nf_depen_solped).length>0&&(this.area=this.areas.filter(a=>a.area===this.infoSolpedEditar.solped.u_nf_depen_solped)[0].area)},error:o=>{}})}SeleccionarArea(){}SeleccionarClase(){}SeleccionarSerie(){this.serieName=this.series.filter(o=>o.code===this.serie)[0].name,this.clase="SPB"==this.serieName?"I":"",this.resetearFormularioLinea()}SeleccionarFechaContable(){this.getMonedas(this.fechaContable)}SeleccionarProveedor(){}SeleccionarItemCode(){console.log(this.item),this.descripcion=this.item.ItemName,this.item.ApTaxCode&&(this.impuesto=this.impuestos.filter(o=>o.Code===this.item.ApTaxCode)[0],this.SeleccionarImpuesto()),this.cuenta={Code:"",Name:""},this.nombreCuenta="","987654321"!=this.item.Cuenta?(this.validaCuenta=!0,this.cuenta={Code:this.item.Cuenta||"",Name:this.item.Nombre_Cuenta||""},this.nombreCuenta=this.item.Nombre_Cuenta||""):this.validaCuenta=!1}SeleccionarVicepresidencia(){if(this.viceprecidencia){let o=this.dependenciasUsuario.filter(t=>t.vicepresidency===this.viceprecidencia.vicepresidency);for(let t of o)0===this.dependencias.filter(a=>a.dependence===t.dependence).length&&this.dependencias.push(t)}}SeleccionarDependencia(){if(this.dependencia){let o=this.dependenciasUsuario.filter(t=>t.dependence===this.dependencia.dependence&&t.vicepresidency===this.dependencia.vicepresidency);for(let t of o)0===this.localidades.filter(a=>a.location===t.location).length&&this.localidades.push(t);this.cuentasxDependencia()}}SeleccionarLocalidad(){}SeleccionarAlmacen(){}SeleccionarCuenta(){this.nombreCuenta=this.cuenta.Name}SeleccionarMoneda(){this.currency=this.monedas.filter(o=>o.Currency===this.moneda)[0].Currency,this.calcularSubtotalLinea()}SeleccionarImpuesto(){this.impuesto?(this.prcImpuesto=this.impuesto.tax,this.calcularImpuesto()):this.prcImpuesto=0}SeleccionarLinea(){}filtrarProveedores(o){let a,t=[],i=o.query;for(let l=0;l<this.proveedores.length;l++)a=this.proveedores[l],(a.CardCode.toLowerCase().indexOf(i.toLowerCase())>=0||a.CardName.toLowerCase().indexOf(i.toLowerCase())>=0)&&t.push(a);this.proveedoresFiltrados=t}filtrarItems(o){let t=[],a=o.query;for(let i=0;i<this.items.length;i++){let l=this.items[i];null!=l.ItemCode&&null!=l.ItemName&&(l.ItemCode.toLowerCase().indexOf(a.toLowerCase())>=0||l.ItemName.toLowerCase().indexOf(a.toLowerCase())>=0)&&t.push(l)}this.itemsFiltrados=t}clearItemCode(){}descargarPlantilla(){}cuentasxDependencia(){this.sapService.cuentasPorDependenciaXE(this.authService.getToken(),this.dependencia.dependence).subscribe({next:o=>{let t=[];for(let l in o)t.push(o[l].U_NF_CUENTA);let a,i=[];for(let l=0;l<this.cuentas.length;l++){a=this.cuentas[l];for(let r of t)0==a.Code.indexOf(r)&&i.push(a)}this.cuentasDependencia=i},error:o=>{}})}filtrarCuentas(o){let t=[],a=o.query;for(let i=0;i<this.cuentasDependencia.length;i++){let l=this.cuentasDependencia[i];null!=l.Code&&null!=l.Name&&(l.Code.toLowerCase().indexOf(a.toLowerCase())>=0||l.Name.toLowerCase().indexOf(a.toLowerCase())>=0)&&t.push(l)}this.cuentasFiltradas=t}calcularSubtotalLinea(){let o=this.monedas.filter(t=>t.Currency===this.moneda)[0].TRM;this.subtotalLinea=this.cantidad&&this.precio?this.cantidad*(this.precio*(o||0)):0,this.calcularImpuesto()}resetearFormularioLinea(){this.numeroLinea=-1,this.fechaRequerida=new Date,this.proveedor={CardCode:"",CardName:""},this.proveedoresFiltrados=[],this.item={ApTaxCode:"",ItemCode:"",ItemName:""},this.itemsFiltrados=[],this.descripcion="",this.viceprecidencia={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.dependencia={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.localidad={codusersap:"",dependence:"",id:0,location:"",vicepresidency:""},this.almacen="",this.cuenta={Code:"",Name:""},this.cuentasFiltradas=[],this.nombreCuenta="",this.cantidad=1,this.moneda=this.lineasSolped.length>0&&this.lineasSolped[0].moneda||"COP",this.precio=0,this.subtotalLinea=0,this.impuesto="",this.prcImpuesto=0,this.valorImpuesto=0,this.totalLinea=0,this.validaCuenta=!0}setearTRMSolped(o){this.trm=this.monedas.filter(t=>t.Currency===o).length>0?this.monedas.filter(t=>t.Currency===o)[0].TRM:0}calcularImpuesto(){this.valorImpuesto=this.impuesto.tax&&0!=this.subtotalLinea?this.subtotalLinea*(this.impuesto.tax/100):0,this.calcularTotalLinea()}calcularTotalLinea(){this.totalLinea=this.subtotalLinea+this.valorImpuesto}calculatTotales(){this.totalimpuestos=0,this.subtotal=0,this.grantotal=0;for(let o of this.lineasSolped)this.totalimpuestos+=o.taxvalor,this.subtotal+=o.linetotal,this.grantotal+=o.linegtotal}verAnexos(){this.listadoAnexos=!0}adicionarlineaAnexo(){console.log(this.tipoanexo,this.fileTmp,this.uploadedFiles),this.envioLineaanexo=!0,this.tipoanexo&&""!=this.tipoanexo&&this.fileTmp&&""!=this.fileTmp?(this.solpedEditar?this.loadFile(this.solpedEditar,{tipo:this.tipoanexo.name,file:this.fileTmp.fileRaw,url:"#"}):this.anexosSolped.push({tipo:this.tipoanexo.name,file:this.fileTmp.fileRaw,url:"#"}),this.tipoanexo="",this.fileTmp="",this.formularioAnexo=!1):this.messageService.add({severity:"error",summary:"!Error\xa1",detail:"Debe seleccionar el tipo y el archivo a anexar a la solped"})}loadFile(o,t){let a;a=new FormData,a.append("myFile",t.file,t.file.name),a.append("anexotipo",t.tipo),a.append("solpedID",o),this.comprasService.uploadAnexo(this.authService.getToken(),a).subscribe({next:i=>{this.anexosSolped.push({tipo:t.tipo,file:t.file,url:i.ruta,idanexo:i.idanexo}),this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:i.message})},error:i=>{this.messageService.add({severity:"error",summary:"!Error\xa1",detail:i})}})}AdicionarAnexo(){this.formularioAnexo=!0;let o=[];for(let t of this.tiposanexoBk)"Otro"!=t.name?0==this.anexosSolped.filter(a=>a.tipo==t.name).length&&o.push({name:t.name}):o.push({name:t.name});this.tiposanexo=o}BorrarAnexo(){let o=[],t=!1;for(let a of this.anexosSolped){t=!1;for(let i of this.lineaAnexoSeleccionada)a===i&&(t=!0);t||o.push(a)}if(this.anexosSolped=o,this.solpedEditar)for(let a of this.lineaAnexoSeleccionada){let i={ruta:a.url,name:a.file.name,tipo:a.tipo,idsolped:this.infoSolpedEditar.solped.id,idanexo:a.idanexo};this.comprasService.borrarAnexo(this.authService.getToken(),i).subscribe({next:l=>{this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:l.message})},error:l=>{this.messageService.add({severity:"error",summary:"!Error",detail:l})}})}}seleccionarTipoAnexo(){}loadFiles(){let o;for(let t of this.anexosSolped)o=new FormData,o.append("myFile",t.file,t.file.name),o.append("anexotipo",t.tipo),this.comprasService.uploadAnexo(this.authService.getToken(),o).subscribe({next:a=>{},error:a=>{}})}onLoad(o){const[t]=o.currentFiles;console.log(t),this.fileTmp={fileRaw:t,fileName:t.name}}consultarAnexo(o){let t=this.comprasService.downloadAnexo(o);window.open(t,"blank")}consultarAnexo3(o){this.comprasService.downloadAnexo3(this.authService.getToken(),o).subscribe({next:t=>{},error:t=>{}})}consultarAnexo2(o){let t={ruta:o.url,name:o.file.name,tipo:o.tipo,idsolped:this.infoSolpedEditar.solped.id,idanexo:o.idanexo};this.comprasService.downloadAnexo2(this.authService.getToken(),t).subscribe({next:a=>{},error:a=>{}})}AdicionarLinea(){this.nuevaLinea=!0,this.clase&&this.serie&&this.area&&this.fechaContable&&this.fechaCaducidad&&this.fechaDocumento&&this.fechaNecesidad?(this.resetearFormularioLinea(),this.numeroLinea=this.iteradorLinea,this.MostrarFormularioLinea()):this.messageService.add({severity:"error",summary:"!Opps",detail:"Debe diligenciar los campos resaltados en rojo"})}MostrarFormularioLinea(){this.formularioLinea=!0,this.nuevaLinea=!1}MostrarDetalle(){this.listadoLineas=!0,this.calculatTotales()}importarCSV(){this.nuevaLinea=!0,this.clase&&this.serie&&this.area&&this.fechaContable&&this.fechaCaducidad&&this.fechaDocumento&&this.fechaNecesidad?this.formularioCSV=!0:this.messageService.add({severity:"error",summary:"!Opps",detail:"Debe diligenciar los campos resaltados en rojo"})}onLoad2(o){this.loadingCargueCSV=!0;const[t]=o.currentFiles;this.fileTmp2={fileRaw:t,fileName:t.name},console.log(this.fileTmp2),this.readDocument(t)}readDocument(o){let t=new FileReader,a=[];t.onload=i=>{var r=t.result.split("\n");for(let s of r)a.push(this.reemplazarCaracteresEspeciales(s));this.validarArchivoDetalle(a)},t.readAsText(o,"ISO-8859-1")}reemplazarCaracteresEspeciales(o){return o.replace("\r","").replace("\t","")}validarArchivoDetalle(o){var t=this;return(0,C.Z)(function*(){t.validarEncabezado(o[0].split(","))?(t.cargueValido=yield t.validarContenidoCSV(o,","),console.log(t.cargueValido),t.cargueValido&&t.messageService.add({severity:"success",summary:"!Ok",detail:"El archivo cargado cumple con la estructura b\xe1sica requerida"})):t.validarEncabezado(o[0].split(";"))?(t.cargueValido=yield t.validarContenidoCSV(o,";"),t.cargueValido&&t.messageService.add({severity:"success",summary:"!Ok",detail:"El archivo cargado cumple con la estructura b\xe1sica requerida"})):t.messageService.add({severity:"error",summary:"!Error",detail:"El archivo cargado no cumple con la estructura b\xe1sica requerida"}),t.loadingCargueCSV=!1})()}validarEncabezado(o){let t=["CODITEM","DESCITEM","FECHAREQ","IDPROVEEDOR","CANTIDAD","MONEDA","PRECIO","IMPUESTO","VICEPRESIDENCIA","DEPENDENCIA","LOCALIDAD","ALMACEN","CODCUENTA"],a=!0;return o.length!=t.length?a=!1:this.encabezadosValidos(t,o)||(a=!1),a}encabezadosValidos(o,t){let a=!0;for(let i of t)if(!o.includes(i)){a=!1;break}return a}validarDependencia(o,t){var a=this;return(0,C.Z)(function*(){let i=!1;return a.dependenciasUsuario.filter(r=>r.vicepresidency===o).filter(r=>r.dependence===t).length>0&&(i=!0),i})()}validarLocalidad(o,t,a){var i=this;return(0,C.Z)(function*(){let l=!1;return i.dependenciasUsuario.filter(s=>s.vicepresidency===o&&s.dependence===t).filter(s=>s.location===a).length>0&&(l=!0),l})()}validarCuentaContable(o){var t=this;return(0,C.Z)(function*(){let a=!1;return t.cuentas.filter(i=>i.Code===o).length>0&&(a=!0),a})()}validarContenidoCSV(o,t){var a=this;return(0,C.Z)(function*(){let l,i=!0;a.lineasSolpedCVS=[];let s,c,r=0;for(let p=1;p<o.length;p++)l=o[p].split(t),13==l.length?("I"==a.clase&&""==l[0]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo del item de la linea ${p}, es obligatorio para solicitudes de bienes`}),i=!1):""!=l[0]&&0==a.items.filter(m=>m.ItemCode==l[0]).length?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo del item  de la linea ${p}, no existe en el listado de items de SAP`}),i=!1):""==l[1]?(a.messageService.add({severity:"error",summary:"!Error",detail:`La descripci\xf3n del articulo o servicio de la linea ${p} es obligatoria`}),i=!1):""==l[2]?(a.messageService.add({severity:"error",summary:"!Error",detail:`La fecha requerida de la linea ${p} es obligatoria`}),i=!1):""!=l[2]&&isNaN(Date.parse(l[2]))?(a.messageService.add({severity:"error",summary:"!Error",detail:`La fecha requerida de la linea ${p} no es valida`}),i=!1):""!=l[3]&&0==a.proveedores.filter(m=>m.CardCode==l[3].trim()).length?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo del proveedor de la linea ${p}, no existe en el listado de proveedores de SAP`}),i=!1):""==l[4]?(a.messageService.add({severity:"error",summary:"!Error",detail:`La cantidad de la linea ${p} es obligatoria`}),i=!1):""!=l[4]&&isNaN(l[4])?(a.messageService.add({severity:"error",summary:"!Error",detail:`La cantidad de la linea ${p} no es un n\xfamero`}),i=!1):""!=l[5]&&0==a.monedas.filter(m=>m.Currency==l[5].trim()).length?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la moneda de la linea ${p}, no existe en el listado de monedas de SAP ${JSON.stringify(a.monedas)}`}),i=!1):""==l[6]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El precio de la linea ${p} es obligatorio`}),i=!1):""!=l[6]&&isNaN(l[6])?(a.messageService.add({severity:"error",summary:"!Error",detail:`La precio de la linea ${p} no es un n\xfamero`}),i=!1):""==l[7]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo del impuesto de la linea ${p} es obligatorio`}),i=!1):""!=l[7]&&0==a.impuestos.filter(m=>m.Code==l[7].trim()).length?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de impuesto de la linea ${p}, no existe en el listado de impuestos de SAP`}),i=!1):""==l[8]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la viceprecidencia de la linea ${p} es obligatorio`}),i=!1):""!=l[8]&&0==a.vicepresidencias.filter(m=>m.vicepresidency==l[8].trim()).length?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la viceprecidencia ${l[8]} de la linea ${p}, no existe en el listado de viceprecidencias asociadas al usuario`}),i=!1):""==l[9]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la dependencia de la linea ${p} es obligatorio`}),i=!1):""==l[9]||(yield a.validarDependencia(l[8].trim(),l[9].trim()))?""==l[10]?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la localidad de la linea ${p} es obligatorio`}),i=!1):""==l[10]||(yield a.validarLocalidad(l[8].trim(),l[9].trim(),l[10].trim()))?""==l[12]&&"S"==a.clase?(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la cuenta contable de la linea ${p} es obligatorio`}),i=!1):""==l[12]||(yield a.validarCuentaContable(l[12]))?("COP"==l[5]?(s=l[4]*l[6],c=l[4]*l[6]*(a.impuestos.filter(m=>m.Code==l[7])[0].tax/100)):(s=l[4]*l[6]*a.monedas.filter(m=>m.Currency==l[5])[0].TRM,c=l[4]*l[6]*a.monedas.filter(m=>m.Currency==l[5])[0].TRM*(a.impuestos.filter(m=>m.Code==l[7])[0].tax/100)),a.lineasSolpedCVS.push({itemcode:l[0],dscription:l[1],reqdatedet:l[2],linevendor:l[3],quantity:l[4],moneda:l[5],price:l[6],tax:l[7],ocrcode3:l[8],ocrcode2:l[9],ocrcode:l[10],whscode:l[11],acctcode:l[12],acctcodename:""!=l[12]?yield a.cuentas.filter(m=>m.Code===l[12])[0].Name:"",id_user:a.infoUsuario.id,id_solped:0,linenum:p-1,linetotal:s,linestatus:"O",taxvalor:c,trm:a.trm,linegtotal:s+c})):(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la cuenta contable de la linea ${p}, no existe en el listado de cuentas asociadas a la dependencia seleccionada`}),i=!1):(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la localidad de la linea ${p}, no existe en el listado de localidades asociadas al usuario`}),i=!1):(a.messageService.add({severity:"error",summary:"!Error",detail:`El c\xf3digo de la dependencia de la linea ${p}, no existe en el listado de dependencias asociadas al usuario`}),i=!1),r++):l.length>1&&(r++,a.messageService.add({severity:"error",summary:"!Error",detail:`La l\xedena ${p} del archivo a cargar, no posee la estructura b\xe1sica requerida`}),i=!1);return 0==r&&(a.messageService.add({severity:"error",summary:"!Error",detail:"El archivo seleccionado no posse lineas para agregar a la solped"}),i=!1),i})()}adicionarCSV(){this.lineasSolped=this.lineasSolpedCVS,this.formularioCSV=!1}descargarCSV(){return(0,C.Z)(function*(){const t=document.createElement("a");t.target="_blank",t.href="https://nitrofert.com.co/wp-content/uploads/2023/02/plantilla-cargue-detalle-solped.csv",t.click()})()}GuardarSolped(){if(this.registroSolped=!0,this.envioFormulario=!0,this.clase&&this.serie&&this.area&&this.fechaContable&&this.fechaCaducidad&&this.fechaDocumento&&this.fechaNecesidad)if(this.lineasSolped.length>0)if(this.anexosSolped.length>0)if(this.anexosSolped.filter(o=>"Especificaci\xf3n t\xe9cnica"==o.tipo).length>0){const o={solped:{id_user:this.infoUsuario.id,usersap:this.infoUsuario.codusersap,fullname:this.infoUsuario.fullname,serie:this.serie,doctype:this.clase,docdate:this.fechaContable,docduedate:this.fechaCaducidad,taxdate:this.fechaDocumento,reqdate:this.fechaNecesidad,sapdocnum:"0",u_nf_depen_solped:this.area,comments:this.comentarios,trm:this.trm,currency:this.currency},solpedDet:this.lineasSolped,anexos:this.anexosSolped};this.solpedEditar&&(o.solped.id=this.solpedEditar),this.onNewSolped.emit(o),this.envioFormulario=!1}else this.messageService.add({severity:"error",summary:"!Error",detail:"El anexo de revisi\xf3n t\xe9cnica es obligatorio"}),this.registroSolped=!1;else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe adjuntar los anexos requeridos"}),this.registroSolped=!1;else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar al menos una l\xednea en la solped"}),this.registroSolped=!1;else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar los campos resaltados en rojo"}),this.registroSolped=!1}NuevaSolped(){}RegistrarLinea(){this.envioLinea=!0,this.descripcion&&this.fechaRequerida&&this.viceprecidencia.vicepresidency&&this.dependencia.dependence&&this.localidad.location&&this.cantidad&&this.precio&&this.impuesto&&(this.cuenta.Code&&this.validaCuenta||!this.cuenta.Code&&!this.validaCuenta)?(this.LineaDuplicada(),this.editarLinea?(this.asignarCamposLinea(this.lineaSeleccionada[0].linenum),this.lineasSolped.splice(this.lineasSolped.indexOf(this.lineaSeleccionada[0]),1,this.lineaSolped),this.messageService.add({severity:"success",summary:"!OK\xa1",detail:"Se realizo correctamente la actualizaci\xf3n de la l\xednea"}),this.editarLinea=!1):(this.asignarCamposLinea(this.numeroLinea),this.lineasSolped.push(this.lineaSolped),this.iteradorLinea++,this.messageService.add({severity:"success",summary:"!OK\xa1",detail:"Se realizo correctamente el registro de la l\xednea"})),this.formularioLinea=!1,this.calculatTotales(),this.resetearFormularioLinea(),this.envioLinea=!1):this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar los campos resaltados en rojo"})}asignarCamposLinea(o){this.lineaSolped={id_solped:this.solpedEditar?this.solpedEditar:0,linenum:o,id_user:this.infoUsuario.id,reqdatedet:this.fechaRequerida,linevendor:this.proveedor.CardCode,itemcode:this.item.ItemCode,dscription:this.descripcion,ocrcode3:this.viceprecidencia.vicepresidency,ocrcode2:this.dependencia.dependence,ocrcode:this.localidad.location,whscode:""!=this.almacen?this.almacen.store:"SM_N300",acctcode:this.cuenta.Code,acctcodename:this.nombreCuenta,quantity:this.cantidad,moneda:this.moneda,price:this.precio,trm:this.trm,linetotal:this.subtotalLinea,tax:this.impuesto.Code,taxvalor:this.valorImpuesto,linegtotal:this.totalLinea}}LineaDuplicada(){let o=this.lineasSolped.filter(t=>t.itemcode===this.item.ItemCode&&t.dscription===this.descripcion&&t.ocrcode===this.localidad.location&&t.ocrcode2===this.dependencia.dependence&&t.ocrcode3===this.viceprecidencia.vicepresidency);return this.lineasSolped.indexOf(o[0])}EditarLinea(){this.lineaSolped=this.lineaSeleccionada[0],this.editarLinea=!0,this.MostrarFormularioLinea(),this.numeroLinea=this.lineaSolped.linenum,this.lineaSolped.itemcode&&(this.item=this.items.filter(o=>o.ItemCode===this.lineaSolped.itemcode)[0]),this.descripcion=this.lineaSolped.dscription,this.lineaSolped.linevendor&&(this.proveedor=this.proveedores.filter(o=>o.CardCode===this.lineaSolped.linevendor)[0]),this.lineaSolped.acctcode&&(this.cuenta=this.cuentas.filter(o=>o.Code===this.lineaSolped.acctcode)[0]),this.lineaSolped.ocrcode3&&(this.viceprecidencia=this.vicepresidencias.filter(o=>o.vicepresidency===this.lineaSolped.ocrcode3)[0],this.SeleccionarVicepresidencia()),this.lineaSolped.ocrcode2&&(this.dependencia=this.dependencias.filter(o=>o.dependence===this.lineaSolped.ocrcode2)[0],this.SeleccionarDependencia()),this.lineaSolped.ocrcode&&(this.localidad=this.localidades.filter(o=>o.location===this.lineaSolped.ocrcode)[0]),this.lineaSolped.whscode&&(this.almacen=this.almacenes.filter(o=>o.store===this.lineaSolped.whscode).length>0?this.almacenes.filter(o=>o.store===this.lineaSolped.whscode)[0]:""),this.lineaSolped.tax&&(this.impuesto=this.impuestos.filter(o=>o.Code===this.lineaSolped.tax)[0]),this.lineaSolped.acctcode&&(this.cuenta=this.cuentas.filter(o=>o.Code===this.lineaSolped.acctcode)[0],this.nombreCuenta=this.cuenta.Name),this.cantidad=this.lineaSolped.quantity||1,this.moneda=this.monedas.filter(o=>o.Currency===this.lineaSolped.moneda)[0].Currency,this.precio=this.lineaSolped.price||0,this.subtotalLinea=this.lineaSolped.linetotal,this.prcImpuesto=100*(this.lineaSolped.linegtotal/this.lineaSolped.linetotal-1),this.valorImpuesto=this.lineaSolped.linegtotal*(this.prcImpuesto/100),this.totalLinea=this.lineaSolped.linegtotal}BorrarLineas(){let o=[],t=!1;for(let a of this.lineasSolped){t=!1;for(let i of this.lineaSeleccionada)a===i&&(t=!0);t||o.push(a)}this.lineasSolped=o}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}}L.\u0275fac=function(o){return new(o||L)(e.Y36(x.e),e.Y36(w.c),e.Y36(Z.K),e.Y36(f.F0),e.Y36(u.ez),e.Y36(f.gz))},L.\u0275cmp=e.Xpm({type:L,selectors:[["app-form-solped"]],viewQuery:function(o,t){if(1&o&&e.Gf(ut,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},inputs:{solpedEditar:"solpedEditar",registroSolped:"registroSolped"},outputs:{onNewSolped:"onNewSolped"},features:[e._Bn([u.ez])],decls:100,vars:121,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12"],[1,"card","p-fluid"],[1,"col"],[1,"field"],["htmlFor","nombreusuario"],["pInputText","","id","nombreusuario","name","nombreusuario","type","text","required","","readonly","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["htmlFor","area"],["optionLabel","area","optionValue","area","id","area","name","area","placeholder","\xc1rea","styleClass","p-dropdown-sm ",3,"options","ngModel","required","readonly","ngClass","ngModelChange","onChange"],["htmlFor","clase"],["optionLabel","name","optionValue","code","id","clase","name","clase","placeholder","Clase solped","styleClass","p-dropdown-sm ",3,"options","ngModel","disabled","required","readonly","ngClass","ngModelChange","onChange"],[1,"flex"],["htmlFor","serie"],["optionLabel","name","optionValue","code","id","serie","name","serie","placeholder","Tipo","styleClass","w-full p-dropdown-sm p-inputtext-sm",3,"options","ngModel","readonly","required","ngClass","ngModelChange","onChange"],["htmlFor","codigoSap"],["pInputText","","id","codigoSap","name","codigoSap","styleClass","w-full ","type","text","required","","readonly","",1,"p-inputtext-sm",3,"ngModel","ngModelChange"],["for","fechaContable"],["inputId","fechaContable","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","readonlyInput","ngClass","ngModelChange","onSelect"],["for","fechaCaducidad"],["inputId","fechaCaducidad","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","fechaDocumento"],["inputId","fechaDocumento","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","fechaNecesidad"],["inputId","fechaNecesidad","styleClass","p-calendar-sm p-inputtext-sm","dateFormat","dd/mm/yy",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["htmlFor","comentarios"],["rows","3","pInputTextarea","","id","comments","maxlength","200",1,"w-full",3,"ngModel","ngModelChange"],[1,"grid","align-content-center"],["class","field col",4,"ngIf"],[1,"field","col"],["pButton","","label","Nueva L\xednea","icon","pi pi-list",1,"p-button-outlined","mb-2","p-button-warning","p-button-sm",3,"disabled","click"],["label","Anexos","icon","pi pi-list","styleClass","p-button-outlined mb-2 p-button-primary p-button-sm","badgeClass","p-badge-danger",3,"disabled","badge","onClick"],["pButton","","label","Guardar","icon","pi pi-save",1,"p-button-outlined","mb-2","p-button-success","p-button-sm",3,"disabled","click"],["pButton","","label","Nueva solped","icon","pi pi-list",1,"p-button-outlined","mb-2","p-button-primary","p-button-sm",3,"disabled","click"],[3,"header","visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["pTemplate","content"],["pTemplate","footer"],["header","Detalle de la solicitud de pedido",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","linenum","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["header","Anexos de la solicitud de pedido",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","file.name","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["header","Cargar anexo",3,"visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["header","Cargar detalle solped",3,"visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["pButton","","label","Importar detalle","icon","pi pi-list",1,"p-button-outlined","mb-2","p-button-warning","p-button-sm",3,"disabled","click"],["label","Ver Detalle","icon","pi pi-search","styleClass","p-button-outlined mb-2 p-button-secondary p-button-sm","badgeClass","p-badge-danger",3,"disabled","badge","onClick"],["for","fechaRequerida"],["inputId","fechaRequerida","styleClass","w-full",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","proveedor"],["field","CardCode","panelStyleClass","text-sm sm:ml-2","inputStyleClass","w-full","styleClass","w-full","inputId","proveedor2",3,"ngModel","showEmptyMessage","suggestions","minLength","delay","ngModelChange","completeMethod","onSelect"],["pTemplate","item"],["for","itemCode"],["field","ItemCode","inputStyleClass","w-full","styleClass","w-full","inputId","itemCode","panelStyleClass","text-sm sm:ml-2",3,"ngModel","showEmptyMessage","suggestions","minLength","delay","autofocus","disabled","ngClass","ngModelChange","completeMethod","onSelect","onClear"],["for","descripcion"],[1,"p-inputgroup"],["pInputText","","id","descripcion","name","descripcion","type","text","required","","maxlength","200",1,"w-full",3,"ngModel","ngClass","ngModelChange"],[1,"p-inputgroup-addon"],[3,"value"],["for","viceprecidencia"],["optionLabel","vicepresidency","filterBy","vicepresidency","placeholder","Seleccione una vicepresidencia","styleClass","w-full","inputId","viceprecidencia",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode3",""],["pTemplate","selectedItem"],["for","dependencia"],["optionLabel","dependence","placeholder","Seleccione una dependencia","filterBy","dependence","styleClass","w-full","inputId","dependencia",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode2",""],["for","localidad"],["optionLabel","location","placeholder","Seleccione una localidad","filterBy","location","styleClass","w-full","inputId","localidad",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["ocrcode",""],["for","almacen"],["optionLabel","store","placeholder","Seleccione una almacen","filterBy","store","styleClass","w-full","inputId","almacen",3,"options","ngModel","filter","showClear","ngModelChange","onChange"],["for","cuenta"],["field","Code","inputStyleClass","w-full","styleClass","w-full","inputId","cuenta","panelStyleClass","text-sm sm:ml-2",3,"ngModel","showEmptyMessage","suggestions","minLength","delay","disabled","ngClass","ngModelChange","completeMethod","onSelect"],["for","nombreCuenta"],["type","text","pInputText","","id","nombreCuenta","disabled","",1,"w-full",3,"ngModel","ngClass","ngModelChange"],["for","cantidad"],["pInputText","","type","number","id","cantidad","placeholder","Cantidad","required","",1,"w-full",3,"ngModel","ngClass","ngModelChange","change"],["for","precio"],["optionLabel","Currency","optionValue","Currency","id","moneda","name","moneda",3,"options","ngModel","required","readonly","ngModelChange","onChange"],["inputId","precio","mode","currency","currency","COP","locale","es-CO","placeholder","Precio","styleClass","w-full",3,"ngModel","ngStyle","ngClass","ngModelChange"],["for","subtotalLinea"],["inputId","subtotalLinea","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",3,"ngModel","ngStyle","readonly","ngClass","ngModelChange"],["for","impuesto"],["optionLabel","Code","placeholder","Seleccione un impuesto","filterBy","Code","styleClass","w-full","inputId","impuesto",1,"w-full",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["suffix","%","inputStyleClass","text-center w-6","styleClass","text-center",3,"ngModel","readonly","disabled","ngClass","ngModelChange"],["for","valorImpuesto"],["inputId","valorImpuesto","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",1,"w-full",3,"ngModel","ngStyle","readonly","disabled","ngClass","ngModelChange"],["for","totalLinea"],["inputId","totalLinea","mode","currency","currency","COP","locale","es-CO","placeholder","","styleClass","w-full",1,"w-full",3,"ngModel","disabled","readonly","ngClass","ngModelChange"],["class","country-item country-item-value",4,"ngIf"],[1,"country-item","country-item-value"],[1,"country-item"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"disabled","click"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","label","Limpiar","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["pButton","","label","Nueva L\xednea","icon","pi pi-list",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","icon","pi pi-pencil",1,"p-button-outlined","mb-2","mr-2","p-button-secondary","p-button-sm",3,"label","disabled","click"],["pButton","","label","Borrar L\xednea","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar por palabra clave",1,"w-full","p-inputtext-sm",3,"input"],["filter",""],[2,"width","3rem"],[1,"flex","justify-content-between","align-items-center"],["type","text","field","linenum","display","menu","placeholder","Buscar por linea detalle"],["type","text","field","itemcode","display","menu","placeholder","Buscar por c\xf3digo item"],["type","text","field","dscription","display","menu","placeholder","Buscar por descripci\xf3n"],["type","text","field","linevendor","display","menu","placeholder","Buscar por proveedor"],["type","text","field","acctcode","display","menu","placeholder","Buscar por cuenta"],["type","text","field","ocrcode3","display","menu","placeholder","Buscar por vicepresidencia"],["type","text","field","orecode2","display","menu","placeholder","Buscar por dependencia"],["type","text","field","location","display","menu","placeholder","Buscar por localidad"],[3,"value","onClick"],[2,"min-width","12rem"],["colspan","13",1,"text-right"],["colspan","16",1,"text-center"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"click"],["pButton","","label","Nuevo anexo","icon","pi pi-list",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","label","Borrar anexo","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],["type","text","field","tipo","display","menu","placeholder","Buscar por tipo anexo"],["type","text","field","nombre","display","menu","placeholder","Buscar por nombre"],["style","width: 1rem",4,"ngIf"],[2,"width","1rem"],["style","min-width: 1rem;","class","flex justify-content-center flex-wrap",4,"ngIf"],[1,"flex","justify-content-center","flex-wrap",2,"min-width","1rem"],["icon","pi pi-download","label","","pTooltip","Descargar",1,"w-full",3,"click"],["for","tipoanexo"],["optionLabel","name","filterBy","name","placeholder","Seleccione el tipo del anexo","styleClass","w-full","inputId","tipoanexo",3,"options","ngModel","filter","showClear","ngClass","ngModelChange","onChange"],["name","demo[]","chooseLabel","Seleccionar","cancelLabel","Cancelar","accept",".pdf","styleClass","w-full",1,"w-full",3,"multiple","showUploadButton","maxFileSize","ngClass","disabled","onSelect"],[4,"ngIf"],[4,"ngFor","ngForOf"],["name","demo2[]","chooseLabel","Seleccionar","cancelLabel","Cancelar","accept",".csv,.txt","styleClass","w-full",1,"w-full",3,"multiple","showUploadButton","maxFileSize","ngClass","onSelect"],["mode","indeterminate"],["icon","pi pi-download","label","Descargar plantilla para solped","styleClass","p-button-text",3,"click"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast")(1,"app-breadcrumb",0),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",1)(6,"div",4)(7,"div",5)(8,"label",6),e._uU(9,"Nombre solicitante"),e.qZA(),e.TgZ(10,"input",7),e.NdJ("ngModelChange",function(i){return t.infoUsuario.fullname=i}),e.qZA()(),e.TgZ(11,"div",5)(12,"label",8),e._uU(13,"\xc1rea aprobaci\xf3n"),e.qZA(),e.TgZ(14,"p-dropdown",9),e.NdJ("ngModelChange",function(i){return t.area=i})("onChange",function(){return t.SeleccionarArea()}),e.qZA()(),e.TgZ(15,"div",5)(16,"label",10),e._uU(17,"Clase"),e.qZA(),e.TgZ(18,"p-dropdown",11),e.NdJ("ngModelChange",function(i){return t.clase=i})("onChange",function(){return t.SeleccionarClase()}),e.qZA()()(),e.TgZ(19,"div",4)(20,"div",12)(21,"div",5)(22,"label",13),e._uU(23,"Tipo"),e.qZA(),e.TgZ(24,"p-dropdown",14),e.NdJ("ngModelChange",function(i){return t.serie=i})("onChange",function(){return t.SeleccionarSerie()}),e.qZA()(),e.TgZ(25,"div",5)(26,"label",15),e._uU(27,"C\xf3digo SAP"),e.qZA(),e.TgZ(28,"input",16),e.NdJ("ngModelChange",function(i){return t.codigoSap=i}),e.qZA()()(),e.TgZ(29,"div",12)(30,"div",5)(31,"label",17),e._uU(32,"Fecha contable"),e.qZA(),e.TgZ(33,"p-calendar",18),e.NdJ("ngModelChange",function(i){return t.fechaContable=i})("onSelect",function(){return t.SeleccionarFechaContable()}),e.qZA()(),e.TgZ(34,"div",5)(35,"label",19),e._uU(36,"V\xe1lido hasta"),e.qZA(),e.TgZ(37,"p-calendar",20),e.NdJ("ngModelChange",function(i){return t.fechaCaducidad=i}),e.qZA()()(),e.TgZ(38,"div",12)(39,"div",5)(40,"label",21),e._uU(41,"Fecha documento"),e.qZA(),e.TgZ(42,"p-calendar",22),e.NdJ("ngModelChange",function(i){return t.fechaDocumento=i}),e.qZA()(),e.TgZ(43,"div",5)(44,"label",23),e._uU(45,"Fecha necesaria"),e.qZA(),e.TgZ(46,"p-calendar",24),e.NdJ("ngModelChange",function(i){return t.fechaNecesidad=i}),e.qZA()()()()(),e.TgZ(47,"div",1)(48,"div",4)(49,"div",5)(50,"label",25),e._uU(51,"Comentarios"),e.qZA(),e.TgZ(52,"textarea",26),e.NdJ("ngModelChange",function(i){return t.comentarios=i}),e._uU(53,"                        "),e.qZA()()()(),e._UZ(54,"p-divider"),e.TgZ(55,"div",1)(56,"div",4)(57,"div",27),e.YNc(58,mt,2,1,"div",28),e.TgZ(59,"div",29)(60,"button",30),e.NdJ("click",function(){return t.AdicionarLinea()}),e.qZA()(),e.YNc(61,_t,2,2,"div",28),e.TgZ(62,"div",29)(63,"p-button",31),e.NdJ("onClick",function(){return t.verAnexos()}),e.qZA()()()()()()()(),e.TgZ(64,"div",1)(65,"div",2)(66,"div",3)(67,"div",1)(68,"div",4)(69,"button",32),e.NdJ("click",function(){return t.GuardarSolped()}),e.qZA()(),e.TgZ(70,"div",4)(71,"button",33),e.NdJ("click",function(){return t.NuevaSolped()}),e.qZA()()()()()(),e.TgZ(72,"p-dialog",34),e.NdJ("visibleChange",function(i){return t.formularioLinea=i})("onHide",function(){return t.envioLinea=!1}),e.YNc(73,Pt,94,112,"ng-template",35),e.YNc(74,Et,1,1,"ng-template",36),e.qZA(),e.TgZ(75,"p-dialog",37),e.NdJ("visibleChange",function(i){return t.listadoLineas=i}),e.TgZ(76,"p-table",38,39),e.NdJ("selectionChange",function(i){return t.lineaSeleccionada=i}),e.YNc(78,Lt,10,4,"ng-template",40),e.YNc(79,Jt,55,0,"ng-template",41),e.YNc(80,It,39,33,"ng-template",42),e.YNc(81,kt,12,12,"ng-template",36),e.YNc(82,Dt,3,0,"ng-template",43),e.YNc(83,Ot,3,0,"ng-template",44),e.qZA(),e.YNc(84,zt,1,0,"ng-template",36),e.qZA(),e.TgZ(85,"p-dialog",45),e.NdJ("visibleChange",function(i){return t.listadoAnexos=i}),e.TgZ(86,"p-table",46,39),e.NdJ("selectionChange",function(i){return t.lineaAnexoSeleccionada=i}),e.YNc(88,Qt,9,2,"ng-template",40),e.YNc(89,Rt,14,1,"ng-template",41),e.YNc(90,Yt,10,5,"ng-template",42),e.YNc(91,Gt,3,0,"ng-template",43),e.YNc(92,Ht,3,0,"ng-template",44),e.qZA(),e.YNc(93,jt,1,0,"ng-template",36),e.qZA(),e.TgZ(94,"p-dialog",47),e.NdJ("visibleChange",function(i){return t.formularioAnexo=i})("onHide",function(){return t.envioLinea=!1}),e.YNc(95,oo,12,14,"ng-template",35),e.YNc(96,io,1,1,"ng-template",36),e.qZA(),e.TgZ(97,"p-dialog",48),e.NdJ("visibleChange",function(i){return t.formularioCSV=i})("onHide",function(){return t.loadingCargueCSV=!1}),e.YNc(98,po,60,7,"ng-template",35),e.YNc(99,co,2,1,"ng-template",36),e.qZA()),2&o&&(e.xp6(1),e.Q6J("urlBreadCrumb",t.urlBreadCrumb),e.xp6(9),e.Q6J("ngModel",t.infoUsuario.fullname),e.xp6(4),e.Q6J("options",t.areas)("ngModel",t.area)("required",!0)("readonly",t.lineasSolped.length>0)("ngClass",e.VKq(97,g,t.envioFormulario&&!t.area||t.nuevaLinea&&!t.area)),e.xp6(4),e.Q6J("options",t.clases)("ngModel",t.clase)("disabled","SPB"===t.serieName)("required",!0)("readonly",t.lineasSolped.length>0)("ngClass",e.VKq(99,g,t.envioFormulario&&!t.clase||t.nuevaLinea&&!t.clase)),e.xp6(6),e.Q6J("options",t.series)("ngModel",t.serie)("readonly",t.lineasSolped.length>0)("required",!0)("ngClass",e.VKq(101,g,t.envioFormulario&&!t.serie||t.nuevaLinea&&!t.serie)),e.xp6(4),e.Q6J("ngModel",t.codigoSap),e.xp6(5),e.Q6J("ngModel",t.fechaContable)("showIcon",!0)("required",!0)("readonlyInput",t.lineasSolped.length>0)("ngClass",e.VKq(103,g,t.envioFormulario&&!t.fechaContable||t.nuevaLinea&&!t.fechaContable)),e.xp6(4),e.Q6J("ngModel",t.fechaCaducidad)("showIcon",!0)("required",!0)("ngClass",e.VKq(105,g,t.envioFormulario&&!t.fechaCaducidad||t.nuevaLinea&&!t.fechaCaducidad)),e.xp6(5),e.Q6J("ngModel",t.fechaDocumento)("showIcon",!0)("required",!0)("ngClass",e.VKq(107,g,t.envioFormulario&&!t.fechaDocumento||t.nuevaLinea&&!t.fechaDocumento)),e.xp6(4),e.Q6J("ngModel",t.fechaNecesidad)("showIcon",!0)("required",!0)("ngClass",e.VKq(109,g,t.envioFormulario&&!t.fechaNecesidad||t.nuevaLinea&&!t.fechaNecesidad)),e.xp6(6),e.Q6J("ngModel",t.comentarios),e.xp6(6),e.Q6J("ngIf",0==t.lineasSolped.length),e.xp6(2),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(1),e.Q6J("ngIf",t.lineasSolped.length>0),e.xp6(2),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada)("badge",t.anexosSolped.length.toString()),e.xp6(6),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||t.registroSolped||"N"!==t.solpedAprobada&&"R"!==t.solpedAprobada),e.xp6(2),e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].create_accion||!t.envioFormulario),e.xp6(1),e.Akn(e.DdM(111,B)),e.Q6J("header",t.editarLinea?"Editar l\xednea":"Adicionar L\xednea")("visible",t.formularioLinea)("modal",!0)("breakpoints",e.DdM(112,ie))("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(3),e.Akn(e.DdM(113,B)),e.Q6J("visible",t.listadoLineas)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(1),e.Q6J("value",t.lineasSolped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(114,uo))("selection",t.lineaSeleccionada),e.xp6(9),e.Akn(e.DdM(115,B)),e.Q6J("visible",t.listadoAnexos)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(1),e.Q6J("value",t.anexosSolped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(116,mo))("selection",t.lineaAnexoSeleccionada),e.xp6(8),e.Akn(e.DdM(117,B)),e.Q6J("visible",t.formularioAnexo)("modal",!0)("breakpoints",e.DdM(118,ie))("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(3),e.Akn(e.DdM(119,B)),e.Q6J("visible",t.formularioCSV)("modal",!0)("breakpoints",e.DdM(120,ie))("maximizable",!0)("draggable",!1)("resizable",!1))},dependencies:[_.mk,_.sg,_.O5,_.PC,h.Fj,h.wV,h.JJ,h.Q7,h.nD,h.On,de.Qc,u.jx,ct.Ct,T.Hq,T.zx,q.u,ee.f,N.V,pe.i,F.Lt,ce.p,P.k,ue.Rn,D.g,O.o,S.iA,S.UA,S.xl,M.FN,z.L,_.Zx,_.H9,_.uU],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]});const _o=function(){return{height:"6px"}};function ho(n,o){1&n&&(e.TgZ(0,"div",4),e._UZ(1,"p-progressBar",5),e.qZA()),2&n&&(e.xp6(1),e.Akn(e.DdM(2,_o)))}const go=function(){return{width:"50vw"}};class R{constructor(o,t,a,i,l){this.rutaActiva=o,this.messageService=t,this.authService=a,this.router=i,this.comprasService=l,this.displayModal=!1,this.loadingCargue=!0,this.percentProgressBar=0}ngOnInit(){this.solpedSeleccionada=this.rutaActiva.snapshot.params}actualizarSolped(o){console.log(o);const a=200,l=Math.ceil(o.solpedDet.length/a),r=100/(l+1);let s=0,c=a;this.displayModal=!0;const p={anexos:o.anexos,solped:o.solped};console.log(p),this.comprasService.updateSolped(this.authService.getToken(),p).subscribe({next:m=>{if(501===m.status)this.messageService.add({severity:"error",summary:"!Error",detail:JSON.stringify(m.err)});else{this.percentProgressBar+=r;let y=o.solped.id;for(let v=1;v<=l;v++){console.log(o.solpedDet.slice(s,c));let re={id:y,solpedDet:o.solpedDet.slice(s,c)};this.comprasService.saveDetailSolped(this.authService.getToken(),re).subscribe({next:A=>{this.percentProgressBar+=r,v==l&&(this.displayModal=!1,this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:A.message}),setTimeout(()=>{this.router.navigate(["portal/compras/solped"])},2e3))},error:A=>{console.error(A),this.displayModal=!1,this.messageService.add({severity:"error",summary:"!Error",detail:A})}}),s+=a,c+=a}this.loadFiles(y,o.anexos)}},error:m=>{console.log(m)}})}loadFiles(o,t){let a;for(let i of t)a=new FormData,a.append("myFile",i.file,i.file.name),a.append("anexotipo",i.tipo),a.append("solpedID",o),this.comprasService.uploadAnexo(this.authService.getToken(),a).subscribe({next:l=>{this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:l.message})},error:l=>{this.messageService.add({severity:"error",summary:"!Error\xa1",detail:l})}})}}R.\u0275fac=function(o){return new(o||R)(e.Y36(f.gz),e.Y36(u.ez),e.Y36(x.e),e.Y36(f.F0),e.Y36(Z.K))},R.\u0275cmp=e.Xpm({type:R,selectors:[["app-edit-solped"]],features:[e._Bn([u.ez])],decls:5,vars:9,consts:[[3,"solpedEditar","onNewSolped"],["header","Cargando",3,"visible","modal","draggable","resizable","visibleChange"],[1,"m-0"],["class","field col",4,"ngIf"],[1,"field","col"],["mode","indeterminate"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast"),e.TgZ(1,"app-form-solped",0),e.NdJ("onNewSolped",function(i){return t.actualizarSolped(i)}),e.qZA(),e.TgZ(2,"p-dialog",1),e.NdJ("visibleChange",function(i){return t.displayModal=i}),e._UZ(3,"p",2),e.YNc(4,ho,2,3,"div",3),e.qZA()),2&o&&(e.xp6(1),e.Q6J("solpedEditar",t.solpedSeleccionada.solped),e.xp6(1),e.Akn(e.DdM(8,go)),e.Q6J("visible",t.displayModal)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(2),e.Q6J("ngIf",t.loadingCargue))},dependencies:[_.O5,N.V,P.k,M.FN,L]});class K{constructor(o,t,a,i){this.messageService=o,this.authService=t,this.router=a,this.comprasService=i,this.registroSolped=!1}ngOnInit(){}registrarSolped(o){this.comprasService.saveSolpedMP(this.authService.getToken(),o).subscribe({next:t=>{console.log(t),501===t.status?this.messageService.add({severity:"error",summary:"!Error",detail:JSON.stringify(t.err)}):(this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:t.message}),setTimeout(()=>{this.router.navigate(["portal/compras/solped/tracking"])},1e3))},error:t=>{console.log(t),this.registroSolped=!1}})}loadFiles(o,t){let a;for(let i of t)a=new FormData,a.append("myFile",i.file,i.file.name),a.append("anexotipo",i.tipo),a.append("solpedID",o),this.comprasService.uploadAnexo(this.authService.getToken(),a).subscribe({next:l=>{this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:l.message})},error:l=>{console.log(l),this.messageService.add({severity:"error",summary:"!Error\xa1",detail:l})}});this.router.navigate(["portal/compras/solped"])}}K.\u0275fac=function(o){return new(o||K)(e.Y36(u.ez),e.Y36(x.e),e.Y36(f.F0),e.Y36(Z.K))},K.\u0275cmp=e.Xpm({type:K,selectors:[["app-new-solped-mp"]],features:[e._Bn([u.ez])],decls:3,vars:1,consts:[[3,"registroSolped","onNewSolped"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast"),e.TgZ(1,"app-form-solped-mp",0),e.NdJ("onNewSolped",function(i){return t.registrarSolped(i)}),e.qZA(),e._uU(2,">")),2&o&&(e.xp6(1),e.Q6J("registroSolped",t.registroSolped))},dependencies:[M.FN,E]});const fo=function(){return{height:"6px"}};function Co(n,o){1&n&&(e.TgZ(0,"div",4),e._UZ(1,"p-progressBar",5),e.qZA()),2&n&&(e.xp6(1),e.Akn(e.DdM(2,fo)))}const bo=function(){return{width:"50vw"}};class J{constructor(o,t,a,i){this.messageService=o,this.authService=t,this.router=a,this.comprasService=i,this.registroSolped=!1,this.displayModal=!1,this.loadingCargue=!0,this.percentProgressBar=0}ngOnInit(){}registrarSolped(o){console.log(o);const a=200,l=Math.ceil(o.solpedDet.length/a),r=100/(l+1);let s=0,c=a;this.displayModal=!0;const p={anexos:o.anexos,solped:o.solped};console.log(p),this.comprasService.saveSolped(this.authService.getToken(),p).subscribe({next:m=>{if(501===m.status)this.messageService.add({severity:"error",summary:"!Error",detail:JSON.stringify(m.err)});else{this.percentProgressBar+=r;let y=m.solpednum;for(let v=1;v<=l;v++){console.log(o.solpedDet.slice(s,c));let re={id:y,solpedDet:o.solpedDet.slice(s,c)};this.comprasService.saveDetailSolped(this.authService.getToken(),re).subscribe({next:A=>{console.log(A),this.percentProgressBar+=r,v==l&&(this.displayModal=!1,this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:A.message}),setTimeout(()=>{this.router.navigate(["portal/compras/solped"])},2e3))},error:A=>{console.error(A),this.displayModal=!1,this.messageService.add({severity:"error",summary:"!Error",detail:A})}}),s+=a,c+=a}this.loadFiles(y,o.anexos)}},error:m=>{console.log(m),this.registroSolped=!1}})}loadFiles(o,t){let a;for(let i of t)a=new FormData,a.append("myFile",i.file,i.file.name),a.append("anexotipo",i.tipo),a.append("solpedID",o),this.comprasService.uploadAnexo(this.authService.getToken(),a).subscribe({next:l=>{this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:l.message})},error:l=>{this.messageService.add({severity:"error",summary:"!Error\xa1",detail:l})}})}}J.\u0275fac=function(o){return new(o||J)(e.Y36(u.ez),e.Y36(x.e),e.Y36(f.F0),e.Y36(Z.K))},J.\u0275cmp=e.Xpm({type:J,selectors:[["app-new-solped"]],features:[e._Bn([u.ez])],decls:6,vars:9,consts:[[3,"registroSolped","onNewSolped"],["header","Cargando",3,"visible","modal","draggable","resizable","visibleChange"],[1,"m-0"],["class","field col",4,"ngIf"],[1,"field","col"],["mode","indeterminate"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast"),e.TgZ(1,"app-form-solped",0),e.NdJ("onNewSolped",function(i){return t.registrarSolped(i)}),e.qZA(),e._uU(2,">\n"),e.TgZ(3,"p-dialog",1),e.NdJ("visibleChange",function(i){return t.displayModal=i}),e._UZ(4,"p",2),e.YNc(5,Co,2,3,"div",3),e.qZA()),2&o&&(e.xp6(1),e.Q6J("registroSolped",t.registroSolped),e.xp6(2),e.Akn(e.DdM(8,bo)),e.Q6J("visible",t.displayModal)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(2),e.Q6J("ngIf",t.loadingCargue))},dependencies:[_.O5,N.V,P.k,M.FN,L]});var X=d(9701),_e=d(4327),So=d(1795),he=d(1707);const vo=["filter"];function To(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",16)(1,"div",17),e._UZ(2,"i",18),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",19)(8,"div",20)(9,"button",21),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmCancel())}),e.qZA()(),e.TgZ(10,"div",20)(11,"button",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectCancel())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function yo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.newSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].create_accion)}}function xo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.editSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("pTooltip",t.permisosUsuarioPagina[0].update_accion?"Editar":"Consultar")("icon",t.permisosUsuarioPagina[0].update_accion?"pi pi-pencil":"pi pi-search")("disabled",!t.permisosUsuarioPagina[0].update_accion||!t.selectedItem||1!=t.selectedItem.length)}}function Zo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.envairSAP())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].create_accion||!t.selectedItem||1!=t.selectedItem.length)}}function Ao(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",38),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.cancelarSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].delete_accion||!t.selectedItem||0==t.selectedItem.length)}}function Mo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",23)(1,"div")(2,"button",24),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(8);return e.KtG(i.clear(l))}),e.qZA(),e.YNc(3,yo,1,1,"button",25),e.YNc(4,xo,1,3,"button",26),e.YNc(5,Zo,1,1,"button",27),e.YNc(6,Ao,1,1,"button",28),e.TgZ(7,"button",29),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.exportExcel())}),e.qZA(),e._UZ(8,"button",30),e.qZA(),e.TgZ(9,"span",31),e._UZ(10,"i",32),e.TgZ(11,"input",33,34),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(8);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.permisosUsuarioPagina[0].create_accion&&t.showNuevo),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion&&t.showEditar),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].create_accion&&t.showEnvioSAP),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].delete_accion&&t.showDeleteSolped),e.xp6(2),e.Q6J("label",t.titulo)}}function Uo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Motonave "),e._UZ(3,"p-columnFilter",51),e.qZA()())}function No(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," N\xfamero pedido "),e._UZ(3,"p-columnFilter",52),e.qZA()())}function wo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Cantidad disponible "),e.qZA()())}function qo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Fecha de Cargue (LDS) "),e._UZ(3,"p-columnFilter",53),e.qZA()())}function Fo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Fecha est. de salida (ETS) "),e._UZ(3,"p-columnFilter",54),e.qZA()())}function Po(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Motonave "),e._UZ(3,"p-columnFilter",51),e.qZA()())}function Eo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Puerto llegada "),e._UZ(3,"p-columnFilter",55),e.qZA()())}function Lo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Agente "),e._UZ(3,"p-columnFilter",56),e.qZA()())}function Jo(n,o){1&n&&(e.TgZ(0,"th")(1,"div",41),e._uU(2," Incoterms "),e.qZA()())}function Io(n,o){if(1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",39),e.YNc(2,Uo,4,0,"th",40),e.TgZ(3,"th")(4,"div",41),e._uU(5),e._UZ(6,"p-columnFilter",42),e.qZA()(),e.YNc(7,No,4,0,"th",40),e.TgZ(8,"th")(9,"div",41),e._uU(10," Proveedor "),e._UZ(11,"p-columnFilter",43),e.qZA()(),e.TgZ(12,"th")(13,"div",41),e._uU(14," \xcdtem "),e._UZ(15,"p-columnFilter",44),e.qZA()(),e.TgZ(16,"th")(17,"div",41),e._uU(18),e._UZ(19,"p-columnFilter",45),e.qZA()(),e.YNc(20,wo,3,0,"th",40),e.TgZ(21,"th")(22,"div",41),e._uU(23," Unidad "),e.qZA()(),e.TgZ(24,"th")(25,"div",41),e._uU(26," \xbfMP importada? "),e._UZ(27,"p-columnFilter",46),e.qZA()(),e.YNc(28,qo,4,0,"th",40),e.YNc(29,Fo,4,0,"th",40),e.TgZ(30,"th")(31,"div",41),e._uU(32),e._UZ(33,"p-columnFilter",47),e.qZA()(),e.YNc(34,Po,4,0,"th",40),e.TgZ(35,"th")(36,"div",41),e._uU(37," Puerto salida "),e._UZ(38,"p-columnFilter",48),e.qZA()(),e.YNc(39,Eo,4,0,"th",40),e.YNc(40,Lo,4,0,"th",40),e.YNc(41,Jo,3,0,"th",40),e.TgZ(42,"th")(43,"div",41),e._uU(44," Presentaci\xf3n "),e._UZ(45,"p-columnFilter",49),e.qZA()(),e.TgZ(46,"th")(47,"div",41),e._uU(48," Comentarios "),e._UZ(49,"p-columnFilter",50),e.qZA()()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf","Entrada"==t.documento),e.xp6(3),e.hij(" N\xfamero ",t.documento," "),e.xp6(2),e.Q6J("ngIf","Entrada"==t.documento),e.xp6(11),e.hij(" Cantidad ",t.documento," "),e.xp6(2),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento),e.xp6(8),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento),e.xp6(3),e.hij(" ","Pedido"==t.documento?"Fecha est. de llegada (ETA)":"Fecha Arribo"," "),e.xp6(2),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento),e.xp6(5),e.Q6J("ngIf","Proyecciones"!=t.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=t.documento&&"Entrada"!=t.documento)}}function ko(n,o){if(1&n&&(e.TgZ(0,"td",61),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.U_NF_MOTONAVE," ")}}function Do(n,o){if(1&n&&(e.TgZ(0,"td",59),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.pedido," ")}}function Oo(n,o){if(1&n&&(e.TgZ(0,"td",64),e._uU(1),e.ALo(2,"number"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.RemainingOpenQuantity)," ")}}function zo(n,o){if(1&n&&(e.TgZ(0,"td",67),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.Dn7(2,1,t.U_NF_LASTSHIPPPING,"dd/MM/yyyy","+0500")," ")}}function Qo(n,o){if(1&n&&(e.TgZ(0,"td",67),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.Dn7(2,1,t.U_NF_DATEOFSHIPPING,"dd/MM/yyyy","+0500")," ")}}function Bo(n,o){if(1&n&&(e.TgZ(0,"td",61),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.U_NF_MOTONAVE," ")}}function Ro(n,o){if(1&n&&(e.TgZ(0,"td",61),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.U_NF_PUERTOSALIDA," ")}}function Ko(n,o){if(1&n&&(e.TgZ(0,"td",61),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.U_NF_AGENTE," ")}}function Yo(n,o){if(1&n&&(e.TgZ(0,"td",59),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.U_NT_Incoterms," ")}}function Go(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",57),e.qZA(),e.YNc(3,ko,2,1,"td",58),e.TgZ(4,"td",59),e._uU(5),e.qZA(),e.YNc(6,Do,2,1,"td",60),e.TgZ(7,"td",61)(8,"span",62),e._uU(9),e.ALo(10,"tooltips"),e.qZA()(),e.TgZ(11,"td",63)(12,"span",62),e._uU(13),e.ALo(14,"tooltips"),e.qZA()(),e.TgZ(15,"td",64),e._uU(16),e.ALo(17,"number"),e.qZA(),e.YNc(18,Oo,3,3,"td",65),e.TgZ(19,"td",64),e._uU(20),e.qZA(),e.TgZ(21,"td",59),e._uU(22),e.qZA(),e.YNc(23,zo,3,5,"td",66),e.YNc(24,Qo,3,5,"td",66),e.TgZ(25,"td",67),e._uU(26),e.ALo(27,"date"),e.qZA(),e.YNc(28,Bo,2,1,"td",58),e.YNc(29,Ro,2,1,"td",58),e.TgZ(30,"td",61),e._uU(31),e.qZA(),e.YNc(32,Ko,2,1,"td",58),e.YNc(33,Yo,2,1,"td",60),e.TgZ(34,"td",61),e._uU(35),e.qZA(),e.TgZ(36,"td",61)(37,"span",62),e._uU(38),e.ALo(39,"tooltips"),e.qZA()()()),2&n){const t=o.$implicit,a=e.oxw();e.xp6(2),e.Q6J("value",t),e.xp6(1),e.Q6J("ngIf","Entrada"==a.documento),e.xp6(2),e.hij(" ",t.DocNum," "),e.xp6(1),e.Q6J("ngIf","Entrada"==a.documento),e.xp6(2),e.Q6J("pTooltip",t.ProveedorDS),e.xp6(1),e.hij(" ",e.Dn7(10,23,t.ProveedorDS,15,t.DocNum)," "),e.xp6(3),e.Q6J("pTooltip",t.Description),e.xp6(1),e.hij(" ",e.Dn7(14,27,t.Description,20,t.DocNum)," "),e.xp6(3),e.hij(" ",e.lcZ(17,31,t.Quantity)," "),e.xp6(2),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(2),e.hij(" ",t.MeasureUnit," "),e.xp6(2),e.hij(" ",t.U_NF_PEDMP," "),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(2),e.hij(" ",e.Dn7(27,33,t.RequriedDate,"dd/MM/yyyy","+0500")," "),e.xp6(2),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=a.documento),e.xp6(2),e.hij(" ",t.WarehouseName," "),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(1),e.Q6J("ngIf","Proyecciones"!=a.documento&&"Entrada"!=a.documento),e.xp6(2),e.hij(" ",t.U_NF_TIPOCARGA," "),e.xp6(2),e.Q6J("pTooltip",t.Comments),e.xp6(1),e.hij(" ",e.Dn7(39,37,t.Comments,20,t.DocNum)," ")}}function Ho(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",68),e._uU(2,"No se econtraron registros."),e.qZA()())}function jo(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",68),e._uU(2,"Cargando registros. Por favor espere"),e.qZA()())}const $o=function(){return{height:"6px"}};function Vo(n,o){1&n&&(e.TgZ(0,"div",69),e._UZ(1,"p-progressBar",94),e.qZA()),2&n&&(e.xp6(1),e.Akn(e.DdM(2,$o)))}const W=function(n){return{"ng-invalid ng-dirty":n}};function Xo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",69)(2,"label",70),e._uU(3,"Estados"),e.qZA(),e.TgZ(4,"p-dropdown",71),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.u_nf_status=i)}),e.qZA()()(),e.TgZ(5,"div",3)(6,"div",69)(7,"label",72),e._uU(8,"Fecha de Cargue (LDS)"),e.qZA(),e.TgZ(9,"p-calendar",73),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.u_nf_lastshippping=i)}),e.qZA()(),e.TgZ(10,"div",69)(11,"label",74),e._uU(12,"Fecha est. de salida (ETS)"),e.qZA(),e.TgZ(13,"p-calendar",75),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.u_nf_dateofshipping=i)}),e.qZA()(),e.TgZ(14,"div",69)(15,"label",76),e._uU(16),e.qZA(),e.TgZ(17,"p-calendar",77),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.RequriedDate=i)}),e.qZA()()(),e.TgZ(18,"div",3)(19,"div",69)(20,"label",78),e._uU(21,"Tipo pago"),e.qZA(),e.TgZ(22,"input",79),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.nf_pago=i)}),e.qZA()(),e.TgZ(23,"div",69)(24,"label",80),e._uU(25,"Tipo carga"),e.qZA(),e.TgZ(26,"p-dropdown",81),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.nf_tipocarga=i)}),e.qZA()()(),e.TgZ(27,"div",3)(28,"div",69)(29,"label",82),e._uU(30,"Agente aduanero"),e.qZA(),e.TgZ(31,"p-dropdown",83),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.nf_agente=i)}),e.qZA()(),e.TgZ(32,"div",69)(33,"label",84),e._uU(34,"Motonave"),e.qZA(),e.TgZ(35,"input",85),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.nf_motonave=i)}),e.qZA()()(),e.TgZ(36,"div",3)(37,"div",69)(38,"label",78),e._uU(39,"Incoterms"),e.qZA(),e.TgZ(40,"p-dropdown",86),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.nf_Incoterms=i)}),e.qZA()()(),e.TgZ(41,"div",3)(42,"div",69)(43,"label",87),e._uU(44,"Puerto salida"),e.qZA(),e.TgZ(45,"input",88),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.nf_puertosalida=i)}),e.qZA()()(),e.TgZ(46,"div",3)(47,"div",89)(48,"div",90)(49,"label",91),e._uU(50,"Comentarios"),e.qZA(),e.TgZ(51,"textarea",92),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.comentarios=i)}),e._uU(52,"                    "),e.qZA()()()(),e.TgZ(53,"div",3),e.YNc(54,Vo,2,3,"div",93),e.qZA()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("options",t.estados)("ngModel",t.u_nf_status)("required",!0)("ngClass",e.VKq(31,W,t.envioFormulario&&!t.u_nf_status)),e.xp6(5),e.Q6J("ngModel",t.u_nf_lastshippping)("showIcon",!0)("required",!0)("ngClass",e.VKq(33,W,t.envioFormulario&&!t.u_nf_lastshippping)),e.xp6(4),e.Q6J("ngModel",t.u_nf_dateofshipping)("showIcon",!0)("required",!0)("ngClass",e.VKq(35,W,t.envioFormulario&&!t.u_nf_dateofshipping)),e.xp6(3),e.Oqu("Pedido"==t.documento?"Fecha est. de llegada (ETA)":"Fecha Necesidad"),e.xp6(1),e.Q6J("ngModel",t.RequriedDate)("showIcon",!0)("required",!0)("ngClass",e.VKq(37,W,t.envioFormulario&&!t.RequriedDate)),e.xp6(5),e.Q6J("ngModel",t.nf_pago),e.xp6(4),e.Q6J("options",t.tiposdecarga)("ngModel",t.nf_tipocarga)("required",!0),e.xp6(5),e.Q6J("options",t.agentes)("ngModel",t.nf_agente)("required",!0),e.xp6(4),e.Q6J("ngModel",t.nf_motonave),e.xp6(5),e.Q6J("options",t.tipo_Incoterms)("ngModel",t.nf_Incoterms)("required",!0),e.xp6(5),e.Q6J("ngModel",t.nf_puertosalida),e.xp6(6),e.Q6J("ngModel",t.comentarios),e.xp6(3),e.Q6J("ngIf",!0===t.loadingSave)}}function Wo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",95),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.ActualizarPedido())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",0==t.permisosUsuarioPagina.length||!t.permisosUsuarioPagina[0].update_accion)}}const ei=function(){return[10,25,50]},ti=function(){return["DocNum","CardName","CardCode","U_NF_STATUS","ItemCode","ItemDescription","U_NF_MOTONAVE","U_NF_LASTSHIPPPING","U_NF_DATEOFSHIPPING","RequriedDate"]},oi=function(){return{width:"50vw"}},ii=function(){return{"960px":"75vw","640px":"100vw"}};class Y{constructor(o,t,a,i,l,r,s,c){this.rutaActiva=o,this.adminService=t,this.comprasService=a,this.router=i,this.confirmationService=l,this.messageService=r,this.authService=s,this.sapService=c,this.onChangeTabla=new e.vpe,this.onChangeLoading=new e.vpe,this.selectedItem=[],this.formulario=!1,this.envioFormulario=!1,this.estados=[{name:"Por cargar"},{name:"Cargado"},{name:"Pedidos en puerto"}],this.u_nf_status="",this.nf_tipocarga="",this.agentes=[{tipo:"Multiport"},{tipo:"Pharo"},{tipo:"Deep Blue"},{tipo:"SCS"},{tipo:"TRANSMARES"}],this.nf_agente="",this.nf_motonave="",this.nf_puertosalida="",this.nf_pago="",this.nf_Incoterms="",this.tipo_Incoterms=[{tipo:"CIF"},{tipo:"CFR"},{tipo:"FCA"},{tipo:"FOB"}],this.loadingSave=!1,this.tiposdecarga=[{tipo:"Empacado"},{tipo:"Granel"}],this.tituloFormEditPedido="",this.statuses=[{label:"Abierta",value:"O"},{label:"Cerrada",value:"C"}],this.approves=[{label:"No aprobada",value:"No"},{label:"Aprobada",value:"A"},{label:"Pendiente",value:"P"},{label:"Rechazada",value:"R"}],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSopledARechazada=!1,this.arraySolpedRechazadas=[],this.arrayIdSolped=[],this.arraryErrorTrm=[]}ngOnInit(){this.infoUsuario=this.authService.getInfoUsuario(),this.perfilesUsuario=this.authService.getPerfilesUsuario(),this.permisosUsuario=this.authService.getPermisosUsuario(),this.permisosUsuarioPagina=this.permisosUsuario.filter(o=>o.url===this.router.url)}ngOnChanges(o){o.documentList.currentValue.length>0?this.getSolpedList():setTimeout(()=>{this.getSolpedList()},5e3)}getSolpedList(){this.loading=!1}newSolped(){this.router.navigate(["/portal/compras/solped/nueva-mp"])}editSolped(){("Solped"==this.documento||"Proyecciones"==this.documento)&&this.router.navigate(["/portal/compras/solped/editar-mp",this.selectedItem[0].id]),"Pedido"==this.documento&&(this.formulario=!0,this.loadingSave=!1,this.asignarCampos())}asignarCampos(){console.log(this.selectedItem[0]);let o=36e5;this.tituloFormEditPedido="Editar pedido "+this.selectedItem[0].DocNum,this.u_nf_status="Solicitado"==this.selectedItem[0].U_NF_STATUS?"Por cargar":this.selectedItem[0].U_NF_STATUS,console.log(this.u_nf_status),this.u_nf_lastshippping=new Date(new Date(this.selectedItem[0].U_NF_LASTSHIPPPING).getTime()+5*o),this.u_nf_dateofshipping=new Date(new Date(this.selectedItem[0].U_NF_DATEOFSHIPPING).getTime()+5*o),this.RequriedDate=new Date(new Date(this.selectedItem[0].RequriedDate).getTime()+5*o),this.cantidad=this.selectedItem[0].Quantity,this.cantidadkl=1e3*this.selectedItem[0].Quantity,this.comentarios=this.selectedItem[0].Comments,this.nf_tipocarga=this.selectedItem[0].U_NF_TIPOCARGA,this.nf_agente=this.selectedItem[0].U_NF_AGENTE,this.nf_motonave=this.selectedItem[0].U_NF_MOTONAVE,this.nf_puertosalida=this.selectedItem[0].U_NF_PUERTOSALIDA,this.nf_pago=this.selectedItem[0].U_NF_PAGO,this.nf_Incoterms=this.selectedItem[0].U_NT_Incoterms}calcularCantidadKL(){}ActualizarPedido(){if(this.envioFormulario=!0,""!=this.u_nf_status&&""!=this.u_nf_dateofshipping&&""!=this.u_nf_lastshippping&&""!=this.RequriedDate){this.loadingSave=!0;let o={DocEntry:this.selectedItem[0].DocEntry,DocNum:this.selectedItem[0].DocNum,pedidoData:{U_NF_STATUS:"Por cargar"==this.u_nf_status?"Solicitado":this.u_nf_status,U_NF_LASTSHIPPPING:this.u_nf_lastshippping,U_NF_DATEOFSHIPPING:this.u_nf_dateofshipping,DocDueDate:this.RequriedDate,Comments:this.comentarios,U_NF_TIPOCARGA:this.nf_tipocarga,U_NF_PAGO:this.nf_pago,U_NF_AGENTE:this.nf_agente,U_NF_MOTONAVE:this.nf_motonave,U_NF_PUERTOSALIDA:this.nf_puertosalida,U_NT_Incoterms:this.nf_Incoterms}};console.log(o),this.comprasService.actualizarPedidoSAP(this.authService.getToken(),o).subscribe({next:t=>{console.log(t),this.messageService.add({severity:"success",summary:"!Ok\xa1",detail:t.message}),this.onChangeTabla.emit(this.nombreLista),this.selectedItem=[],this.loading=!0,this.formulario=!1},error:t=>{console.log(t),this.messageService.add({severity:"error",summary:"!Error",detail:t})}})}else this.messageService.add({severity:"error",summary:"!Error",detail:"Debe diligenciar los campos resaltados en rojo"})}envairSAP(){this.loading=!0,"N"==this.selectedItem[0].approved?this.comprasService.enviarSolpedSAP(this.authService.getToken(),{id:this.selectedItem[0].id}).subscribe({next:o=>{this.messageService.add(o.status?{severity:"success",summary:"!Ok\xa1",detail:o.message}:{severity:"error",summary:"!Ok\xa1",detail:o.err}),this.loading=!1,this.onChangeTabla.emit(this.nombreLista)},error:o=>{console.log(o),this.loading=!1}}):"C"==this.selectedItem[0].approved?(this.messageService.add({severity:"error",summary:"!Error",detail:"La solped seleccionada fue ya fue cancelada."}),this.loading=!1):"A"==this.selectedItem[0].approved&&(this.messageService.add({severity:"error",summary:"!Error",detail:"La solped seleccionada fue ya fue enviada a SAP."}),this.loading=!1)}cancelarSolped(){let o=[];new Date,this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],console.log(this.selectedItem);for(let i of this.selectedItem)"C"===i.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(i.id)),o.push(i.id);this.arrayIdSolped=o;let a="";this.errorSolpedCancelada?(a=this.arrayErrorSolpedCancelada.length>1?`Los documentos ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladaos.`:`El documento ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelado`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSolpedCancelada=!1):(a=o.length>1?"\xbfDesea Continuar con la cancelaci\xf3n de los documentos seleccionados?":"\xbfDesea Continuar con la cancelaci\xf3n del  documento seleccionado?",this.messageService.clear(),this.messageService.add({key:"cdel",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:a}))}onRejectCancel(){this.messageService.clear("cdel")}onConfirmCancel(){this.loading=!0;let o="";this.messageService.clear("cdel"),this.comprasService.cancelacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{"ok"==t.status?(o=this.arrayIdSolped.length>1?"La cancelaci\xf3n de los documentos seleccionados fueron realizados correctamente":"La cancelaci\xf3n del documento seleccionado fue realizado correctamente",this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:o}),this.onChangeTabla.emit(this.nombreLista)):(this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t.message}),this.loading=!1)},error:t=>{console.log(t),this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}exportExcel(){d.e(574).then(d.bind(d,574)).then(o=>{const a={Sheets:{data:o.utils.json_to_sheet(this.documentList)},SheetNames:["data"]},i=o.write(a,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(i,`${this.documento}`)})}saveAsExcelFile(o,t){const l=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});_e.saveAs(l,t+"_export_"+(new Date).getTime()+".xlsx")}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}}Y.\u0275fac=function(o){return new(o||Y)(e.Y36(f.gz),e.Y36(X.l),e.Y36(Z.K),e.Y36(f.F0),e.Y36(u.YP),e.Y36(u.ez),e.Y36(x.e),e.Y36(w.c))},Y.\u0275cmp=e.Xpm({type:Y,selectors:[["app-table-solped-mp"]],viewQuery:function(o,t){if(1&o&&e.Gf(vo,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},inputs:{documentList:"documentList",color:"color",showNuevo:"showNuevo",showEditar:"showEditar",showEnvioSAP:"showEnvioSAP",showDeleteSolped:"showDeleteSolped",titulo:"titulo",nombreLista:"nombreLista",loading:"loading",documento:"documento"},outputs:{onChangeTabla:"onChangeTabla",onChangeLoading:"onChangeLoading"},features:[e._Bn([u.ez,u.YP]),e.TTD],decls:17,vars:23,consts:[["key","tl"],["key","cdel",3,"baseZIndex","onClose"],["pTemplate","message"],[1,"grid"],[1,"col-12"],[1,"card"],["dataKey","key","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","rowsPerPageOptions","loading","rowHover","styleClass","paginator","globalFilterFields","selection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],[3,"header","visible","modal","breakpoints","maximizable","draggable","resizable","visibleChange","onHide"],["pTemplate","content"],["pTemplate","footer"],[1,"flex","flex-column",2,"flex","1"],[1,"text-center"],[1,"pi","pi-exclamation-triangle",2,"font-size","3rem"],[1,"grid","p-fluid"],[1,"col-6"],["type","button","pButton","","label","Si",1,"p-button-success",3,"click"],["type","button","pButton","","label","No",1,"p-button-secondary",3,"click"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","pTooltip","Limpiar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-success p-button-sm","icon","pi pi-plus",3,"disabled","click",4,"ngIf"],["pButton","","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-secondary p-button-sm",3,"pTooltip","icon","disabled","click",4,"ngIf"],["pButton","","pTooltip","Enviar a SAP","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-warning p-button-sm","icon","pi pi-send",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-danger p-button-sm","icon","pi pi-trash",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Exportar a excel","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-file-excel",1,"p-button-outlined","mb-2","mr-2","p-button-success","p-button-sm",3,"click"],["pButton","","pRipple","","type","button",1,"p-button-text","p-button-secondary",3,"label"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar por palabra clave",1,"w-full","p-inputtext-sm",3,"input"],["filter",""],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-plus",1,"p-button-outlined","mb-2","mr-2","p-button-success","p-button-sm",3,"disabled","click"],["pButton","","tooltipPosition","bottom","placeholder","Bottom",1,"p-button-outlined","mb-2","mr-2","p-button-secondary","p-button-sm",3,"pTooltip","icon","disabled","click"],["pButton","","pTooltip","Enviar a SAP","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-send",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],[2,"width","3rem"],[4,"ngIf"],[1,"flex","justify-content-between","align-items-center"],["type","text","field","DocNum","display","menu","placeholder","Buscar por c\xf3digo solped"],["type","text","field","ProveedorDS","display","menu","placeholder","Buscar por \xedtem o nombre \xedtem"],["type","text","field","Description","display","menu","placeholder","Buscar por \xedtem o nombre \xedtem"],["type","text","field","Quantity","display","menu","placeholder","Buscar por cantidad"],["type","text","field","U_NF_PEDMP","display","menu","placeholder","Buscar por"],["type","date","field","RequriedDate","display","menu"],["type","text","field","U_NF_PUERTOSALIDA","display","menu","placeholder","Buscar por puerto salida"],["type","text","field","U_NF_TIPOCARGA","display","menu","placeholder","Buscar por tipo de buque"],["type","text","field","Comments","display","menu","placeholder","Buscar por comentario"],["type","text","field","U_NF_MOTONAVE","display","menu","placeholder","Buscar por motonave"],["type","text","field","pedido","display","menu","placeholder","Buscar por c\xf3digo pedido"],["type","date","field","U_NF_LASTSHIPPPING","display","menu"],["type","date","field","U_NF_DATEOFSHIPPING","display","menu"],["type","text","field","DocumentLines.WarehouseCode","display","menu","placeholder","Buscar por puerto llegada"],["type","text","field","U_NF_AGENTE","display","menu","placeholder","Buscar por agente"],[3,"value"],["style","min-width: 12rem;",4,"ngIf"],[2,"min-width","6rem"],["style","min-width: 6rem;",4,"ngIf"],[2,"min-width","12rem"],["tooltipPosition","top",3,"pTooltip"],[2,"min-width","15rem"],[2,"min-width","8rem"],["style","min-width: 8rem;",4,"ngIf"],["style","min-width: 10rem;",4,"ngIf"],[2,"min-width","10rem"],["colspan","19",1,"text-center"],[1,"field","col"],["for","u_nf_status"],["optionLabel","name","optionValue","name","id","u_nf_status","name","u_nf_status","placeholder","Seleccione una estado","styleClass","p-dropdown-sm w-full",3,"options","ngModel","required","ngClass","ngModelChange"],["for","u_nf_lastshippping"],["inputId","u_nf_lastshippping","styleClass","w-full",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","u_nf_dateofshipping"],["inputId","u_nf_dateofshipping","styleClass","w-full",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["for","RequriedDate"],["inputId","RequriedDate","styleClass","w-full",3,"ngModel","showIcon","required","ngClass","ngModelChange"],["htmlFor","nf_pago"],["pInputText","","id","nf_pago","name","nf_pago","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm","w-full",3,"ngModel","ngModelChange"],["for","nf_tipocarga"],["optionLabel","tipo","optionValue","tipo","id","nf_tipocarga","name","nf_tipocarga","placeholder","Tipo de carga","styleClass","p-dropdown-sm w-full",3,"options","ngModel","required","ngModelChange"],["for","nf_agente"],["optionLabel","tipo","optionValue","tipo","id","nf_agente","name","nf_agente","placeholder","Agente","styleClass","p-dropdown-sm w-full",3,"options","ngModel","required","ngModelChange"],["for","nf_motonave"],["pInputText","","id","nf_motonave","name","nf_motonave","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm","w-full",3,"ngModel","ngModelChange"],["optionLabel","tipo","optionValue","tipo","id","nf_Incoterms","name","nf_Incoterms","placeholder","Incoterms","styleClass","p-dropdown-sm w-full",3,"options","ngModel","required","ngModelChange"],["htmlFor","nf_puertosalida"],["pInputText","","id","nf_puertosalida","name","nf_puertosalida","styleClass","w-full ","type","text","required","",1,"p-inputtext-sm","w-full",3,"ngModel","ngModelChange"],[1,"col"],[1,"field"],["htmlFor","comentarios"],["rows","3","pInputTextarea","","id","comentarios",1,"w-full",3,"ngModel","ngModelChange"],["class","field col",4,"ngIf"],["mode","indeterminate"],["icon","pi pi-check","label","Actualizar","styleClass","p-button-text",3,"disabled","click"]],template:function(o,t){1&o&&(e._UZ(0,"p-toast")(1,"p-toast",0),e.TgZ(2,"p-toast",1),e.NdJ("onClose",function(){return t.onRejectCancel()}),e.YNc(3,To,12,2,"ng-template",2),e.qZA(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"p-table",6,7),e.NdJ("selectionChange",function(i){return t.selectedItem=i}),e.YNc(9,Mo,13,5,"ng-template",8),e.YNc(10,Io,50,12,"ng-template",9),e.YNc(11,Go,40,41,"ng-template",10),e.YNc(12,Ho,3,0,"ng-template",11),e.YNc(13,jo,3,0,"ng-template",12),e.qZA()()()(),e.TgZ(14,"p-dialog",13),e.NdJ("visibleChange",function(i){return t.formulario=i})("onHide",function(){return t.envioFormulario=!1}),e.YNc(15,Xo,55,39,"ng-template",14),e.YNc(16,Wo,1,1,"ng-template",15),e.qZA()),2&o&&(e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(5),e.Q6J("value",t.documentList)("rows",10)("rowsPerPageOptions",e.DdM(19,ei))("loading",t.loading)("rowHover",!0)("styleClass","p-datatable-gridlines p-datatable-sm border-3 "+t.color)("paginator",!0)("globalFilterFields",e.DdM(20,ti))("selection",t.selectedItem),e.xp6(7),e.Akn(e.DdM(21,oi)),e.Q6J("header",t.tituloFormEditPedido)("visible",t.formulario)("modal",!0)("breakpoints",e.DdM(22,ii))("maximizable",!0)("draggable",!1)("resizable",!1))},dependencies:[_.mk,_.O5,h.Fj,h.JJ,h.Q7,h.On,u.jx,T.Hq,T.zx,q.u,ee.f,N.V,F.Lt,P.k,D.g,O.o,So.H,S.iA,S.UA,S.xl,M.FN,_.JJ,_.uU,he.E]});const ai=["filter"];class G{constructor(o,t,a,i,l,r,s,c){this.rutaActiva=o,this.adminService=t,this.comprasService=a,this.router=i,this.confirmationService=l,this.messageService=r,this.authService=s,this.sapService=c,this.urlBreadCrumb="",this.allSolpedMP=[],this.allSolpedMP2=[],this.proyecciones=[],this.proyeccionesBK=[],this.loadingProyecciones=!1,this.selectedProyecciones=[],this.solpedRequest=[],this.solpedRequestBK=[],this.loadingSR=!0,this.selectedSolpedR=[],this.pedidosPorCargar=[],this.pedidosPorCargarBK=[],this.loadingPxC=!0,this.selectedPedidosPxC=[],this.pedidosCargados=[],this.pedidosCargadosBK=[],this.loadingC=!0,this.selectedPedidosC=[],this.pedidosDocumentacion=[],this.pedidosDocumentacionBK=[],this.loadingD=!0,this.selectedPedidosD=[],this.pedidosDescargados=[],this.pedidosDescargadosBK=[],this.loadingPD=!0,this.selectedPedidosPD=[],this.entradasNT=[],this.entradasNTBK=[],this.loadingNT=!0,this.selectedEntradas=[],this.almacenes=[],this.statuses=[{label:"Abierta",value:"O"},{label:"Cerrada",value:"C"}],this.approves=[{label:"No aprobada",value:"No"},{label:"Aprobada",value:"A"},{label:"Pendiente",value:"P"},{label:"Rechazada",value:"R"}],this.tiposMateriaPrima=[{label:"Importada",value:"SI"},{label:"Nacional",value:"NO"},{label:"Todas",value:""}],this.tipoMateriaPrima="Todas"}ngOnInit(){this.infoUsuario=this.authService.getInfoUsuario(),this.perfilesUsuario=this.authService.getPerfilesUsuario(),this.permisosUsuario=this.authService.getPermisosUsuario(),this.permisosUsuarioPagina=this.permisosUsuario.filter(o=>o.url===this.router.url),this.urlBreadCrumb=this.router.url,this.getAlmacenesMPSL()}getAlmacenesMPSL(){this.sapService.getAlmacenesMPSL(this.authService.getToken()).subscribe({next:o=>{for(let t in o.value)this.almacenes.push({store:o.value[t].WarehouseCode,storename:o.value[t].WarehouseName,zonacode:o.value[t].State});this.getListadosTrackingMP()},error:o=>{console.log(o)}})}getListadosTrackingMP(){this.getSolpedRequest(),this.getPedidosPorCargar(),this.getPedidosCargados(),this.getPedidosConDocumentacion(),this.getPedidosDescargados(),this.getEntradasNacionalizadas()}getSolpedRequest(){this.comprasService.SolpedMP(this.authService.getToken(),"Request").subscribe({next:o=>{let t=[];for(let i of o.proyecciones)i.WarehouseName="",this.almacenes.filter(l=>l.store===i.WarehouseCode).length>0&&(i.WarehouseName=this.almacenes.filter(l=>l.store===i.WarehouseCode)[0].storename),i.U_NF_PEDMP="S"==i.U_NF_PEDMP?"SI":"NO",t.push(i);this.proyecciones=t,this.proyeccionesBK=t;let a=[];for(let i of o.solicitudesSAP)i.WarehouseName="",this.almacenes.filter(l=>l.store===i.WarehouseCode).length>0&&(i.WarehouseName=this.almacenes.filter(l=>l.store===i.WarehouseCode)[0].storename),i.U_NF_PEDMP="S"==i.U_NF_PEDMP?"SI":"NO",a.push(i);this.solpedRequest=a,this.solpedRequestBK=a},error:o=>{console.log(o)}})}getPedidosPorCargar(){var t,o=this;this.comprasService.PedidosdMP(this.authService.getToken(),"Solicitado").subscribe({next:(t=(0,C.Z)(function*(a){a.value&&(o.pedidosPorCargar=yield o.convertirObjetoSLtoArray(a),o.pedidosPorCargarBK=o.pedidosPorCargar)}),function(i){return t.apply(this,arguments)}),error:t=>{console.log(t)}})}getPedidosCargados(){var t,o=this;this.comprasService.PedidosdMP(this.authService.getToken(),"Cargado").subscribe({next:(t=(0,C.Z)(function*(a){a.value&&(o.pedidosCargados=yield o.convertirObjetoSLtoArray(a),o.pedidosCargadosBK=o.pedidosCargados)}),function(i){return t.apply(this,arguments)}),error:t=>{console.log(t)}})}getPedidosConDocumentacion(){}getPedidosDescargados(){var t,o=this;this.comprasService.PedidosdMP(this.authService.getToken(),"Pedidos en puerto").subscribe({next:(t=(0,C.Z)(function*(a){a.value&&(o.pedidosDescargados=yield o.convertirObjetoSLtoArray(a),o.pedidosDescargadosBK=o.pedidosDescargados)}),function(i){return t.apply(this,arguments)}),error:t=>{console.log(t)}})}getEntradasNacionalizadas(){var t,o=this;this.comprasService.EntradasMP(this.authService.getToken()).subscribe({next:(t=(0,C.Z)(function*(a){let i=[];for(let l in a){let r="";o.almacenes.filter(s=>s.store===a[l].WhsCode).length>0&&(r=o.almacenes.filter(s=>s.store===a[l].WhsCode)[0].storename),i.push({Comments:a[l].Comments,DocNum:a[l].DocNum,pedido:a[l].pedido,Incoterms:a[l].Incoterms,ItemCode:a[l].ItemCode,ItemDescription:a[l].Dscription,Description:`${a[l].ItemCode} - ${a[l].Dscription}`,LineNum:a[l].LineNum,Quantity:a[l].Quantity,RequriedDate:a[l].DocDueDate,U_NF_AGENTE:a[l].U_NF_AGENTE,U_NF_DATEOFSHIPPING:a[l].U_NF_DATEOFSHIPPING,U_NF_LASTSHIPPPING:a[l].U_NF_LASTSHIPPPING,U_NF_MOTONAVE:a[l].U_NF_MOTONAVE,U_NF_PAGO:a[l].U_NF_PAGO,U_NF_PUERTOSALIDA:a[l].U_NF_PUERTOSALIDA,U_NF_STATUS:a[l].U_NF_STATUS,U_NF_TIPOCARGA:a[l].U_NF_TIPOCARGA,U_NF_PEDMP:"S"==a[l].U_NF_PEDMP?"SI":"NO",WarehouseCode:a[l].WhsCode,WarehouseName:r,approved:"S",id:a[l].DocEntry,key:a[l].DocNum+"-"+a[l].LineNum,DocEntry:a[l].DocEntry,RemainingOpenQuantity:0,U_NT_Incoterms:a[l].U_NT_Incoterms,MeasureUnit:a[l].unitMsr,CardCode:a[l].CardCode,CardName:a[l].CardName,ProveedorDS:`${a[l].CardCode} - ${a[l].CardName}`})}console.log(i),o.entradasNT=i,o.entradasNTBK=i}),function(i){return t.apply(this,arguments)}),error:t=>{console.log(t)}})}filtrarTablas(){if(this.proyecciones=this.proyeccionesBK,this.solpedRequest=this.solpedRequestBK,this.pedidosPorCargar=this.pedidosPorCargarBK,this.pedidosCargados=this.pedidosCargadosBK,this.pedidosDescargados=this.pedidosDescargadosBK,this.entradasNT=this.entradasNTBK,"Todas"!=this.tipoMateriaPrima){let o=this.tiposMateriaPrima.filter(t=>t.label==this.tipoMateriaPrima)[0].value;this.proyecciones=this.proyecciones.filter(t=>t.U_NF_PEDMP==o),this.solpedRequest=this.solpedRequest.filter(t=>t.U_NF_PEDMP==o),this.pedidosPorCargar=this.pedidosPorCargar.filter(t=>t.U_NF_PEDMP==o),this.pedidosCargados=this.pedidosCargados.filter(t=>t.U_NF_PEDMP==o),this.pedidosDescargados=this.pedidosDescargados.filter(t=>t.U_NF_PEDMP==o),this.entradasNT=this.entradasNT.filter(t=>t.U_NF_PEDMP==o)}}reestablecerFiltro(){this.tipoMateriaPrima="Todas",this.filtrarTablas()}newSolped(){}convertirObjetoSLtoArray(o){let t=[];for(let a of o.value)for(let i of a.DocumentLines){let l="";this.almacenes.filter(r=>r.store===i.WarehouseCode).length>0&&(l=this.almacenes.filter(r=>r.store===i.WarehouseCode)[0].storename),t.push({Comments:a.Comments,DocNum:a.DocNum,Incoterms:i.Incoterms,ItemCode:i.ItemCode,ItemDescription:i.ItemDescription,Description:`${i.ItemCode} - ${i.ItemDescription}`,LineNum:i.LineNum,Quantity:i.Quantity,RequriedDate:a.DocDueDate,U_NF_AGENTE:a.U_NF_AGENTE,U_NF_DATEOFSHIPPING:a.U_NF_DATEOFSHIPPING,U_NF_LASTSHIPPPING:a.U_NF_LASTSHIPPPING,U_NF_MOTONAVE:a.U_NF_MOTONAVE,U_NF_PAGO:a.U_NF_PAGO,U_NF_PUERTOSALIDA:a.U_NF_PUERTOSALIDA,U_NF_STATUS:a.U_NF_STATUS,U_NF_TIPOCARGA:a.U_NF_TIPOCARGA,U_NF_PEDMP:"S"==a.U_NF_PEDMP?"SI":"NO",WarehouseCode:i.WarehouseCode,WarehouseName:l,approved:"S",id:a.DocEntry,key:a.DocNum+"-"+i.LineNum,DocEntry:a.DocEntry,RemainingOpenQuantity:i.RemainingOpenQuantity,U_NT_Incoterms:a.U_NT_Incoterms,MeasureUnit:i.MeasureUnit,CardCode:a.CardCode,CardName:a.CardName,ProveedorDS:`${a.CardCode} - ${a.CardName}`})}return t}updateTable(o){this.getSolpedRequest(),this.getPedidosPorCargar(),this.getPedidosCargados(),this.getPedidosConDocumentacion(),this.getPedidosDescargados(),this.getEntradasNacionalizadas()}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}}G.\u0275fac=function(o){return new(o||G)(e.Y36(f.gz),e.Y36(X.l),e.Y36(Z.K),e.Y36(f.F0),e.Y36(u.YP),e.Y36(u.ez),e.Y36(x.e),e.Y36(w.c))},G.\u0275cmp=e.Xpm({type:G,selectors:[["app-tracking-mp"]],viewQuery:function(o,t){if(1&o&&e.Gf(ai,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},features:[e._Bn([u.ez,u.YP])],decls:19,vars:41,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12"],[1,"card"],[1,"field","col-2"],["for","tipoMateriaPrima"],["optionLabel","label","optionValue","label","styleClass","w-full","id","tipoMateriaPrima","name","tipoMateriaPrima",3,"options","ngModel","required","ngModelChange","onChange"],[1,"field","col-2","flex","align-content-end","flex-wrap"],["pButton","","pTooltip","Limpiar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["nombreLista","solpedRequest","color","border-bluegray-200","titulo","Proyecciones",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","showDeleteSolped","onChangeTabla"],["nombreLista","solpedRequest","color","border-bluegray-500","titulo","Solicitudes de compra",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","onChangeTabla"],["nombreLista","pedidosPorCargar","color","border-cyan-500","titulo","Pedidos pendientes x cargar",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","onChangeTabla"],["nombreLista","pedidosCargados","color","border-pink-500","titulo","Pedidos cargados",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","onChangeTabla"],["nombreLista","pedidosDescargados","color","border-yellow-500","titulo","Pedidos en puerto",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","onChangeTabla"],["nombreLista","entradasNT","color","border-teal-500","titulo","Entradas - Nacionalizadas",3,"documentList","loading","documento","showNuevo","showEditar","showEnvioSAP","onChangeTabla"]],template:function(o,t){1&o&&(e._UZ(0,"app-breadcrumb",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"h6"),e._uU(5,"Filtros generales"),e.qZA(),e.TgZ(6,"div",1)(7,"div",4)(8,"label",5),e._uU(9,"Tipo Materia prima"),e.qZA(),e.TgZ(10,"p-dropdown",6),e.NdJ("ngModelChange",function(i){return t.tipoMateriaPrima=i})("onChange",function(){return t.filtrarTablas()}),e.qZA()(),e.TgZ(11,"div",7)(12,"button",8),e.NdJ("click",function(){return t.reestablecerFiltro()}),e.qZA()()()()()(),e.TgZ(13,"app-table-solped-mp",9),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA(),e.TgZ(14,"app-table-solped-mp",10),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA(),e.TgZ(15,"app-table-solped-mp",11),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA(),e.TgZ(16,"app-table-solped-mp",12),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA(),e.TgZ(17,"app-table-solped-mp",13),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA(),e.TgZ(18,"app-table-solped-mp",14),e.NdJ("onChangeTabla",function(i){return t.updateTable(i)}),e.qZA()),2&o&&(e.Q6J("urlBreadCrumb",t.urlBreadCrumb),e.xp6(10),e.Q6J("options",t.tiposMateriaPrima)("ngModel",t.tipoMateriaPrima)("required",!0),e.xp6(3),e.Q6J("documentList",t.proyecciones)("loading",!0)("documento","Proyecciones")("showNuevo",!0)("showEditar",!0)("showEnvioSAP",!0)("showDeleteSolped",!0),e.xp6(1),e.Q6J("documentList",t.solpedRequest)("loading",!0)("documento","Solped")("showNuevo",!1)("showEditar",!0)("showEnvioSAP",!1),e.xp6(1),e.Q6J("documentList",t.pedidosPorCargar)("loading",!0)("documento","Pedido")("showNuevo",!1)("showEditar",!0)("showEnvioSAP",!1),e.xp6(1),e.Q6J("documentList",t.pedidosCargados)("loading",!0)("documento","Pedido")("showNuevo",!1)("showEditar",!0)("showEnvioSAP",!1),e.xp6(1),e.Q6J("documentList",t.pedidosDescargados)("loading",!0)("documento","Pedido")("showNuevo",!1)("showEditar",!0)("showEnvioSAP",!1),e.xp6(1),e.Q6J("documentList",t.entradasNT)("loading",!0)("documento","Entrada")("showNuevo",!1)("showEditar",!1)("showEnvioSAP",!1))},dependencies:[h.JJ,h.Q7,h.On,T.Hq,q.u,F.Lt,z.L,Y]});var ge=d(7453);const ni=["filter"];function li(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.newSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].create_accion)}}function ri(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.editSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("pTooltip",t.permisosUsuarioPagina[0].update_accion?"Editar":"Consultar")("icon",t.permisosUsuarioPagina[0].update_accion?"pi pi-pencil":"pi pi-search")("disabled",!t.permisosUsuarioPagina[0].read_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function si(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.solicitudAprobacion())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].update_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function di(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",46),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.cancelarSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].update_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function pi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.aprobar())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].aproved_accion||!t.selectedSolped||0==t.selectedSolped.length)}}function ci(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.rechazar())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].aproved_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function ui(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",30)(1,"div")(2,"button",31),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(5);return e.KtG(i.clear(l))}),e.qZA(),e.YNc(3,li,1,1,"button",32),e.YNc(4,ri,1,3,"button",33),e.YNc(5,si,1,1,"button",34),e.YNc(6,di,1,1,"button",35),e.YNc(7,pi,1,1,"button",36),e.YNc(8,ci,1,1,"button",37),e.TgZ(9,"button",38),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.exportExcel())}),e.qZA()(),e.TgZ(10,"span",39),e._UZ(11,"i",40),e.TgZ(12,"input",41,42),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(5);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.permisosUsuarioPagina[0].create_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].aproved_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].aproved_accion)}}function mi(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function _i(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",62),e.NdJ("onChange",function(i){const r=e.CHM(t).filterCallback;return e.KtG(r(i.value))}),e.YNc(1,mi,2,3,"ng-template",63),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.statuses)}}function hi(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function gi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",62),e.NdJ("onChange",function(i){const r=e.CHM(t).filterCallback;return e.KtG(r(i.value))}),e.YNc(1,hi,2,3,"ng-template",63),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.approves)}}function fi(n,o){1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",49),e.TgZ(2,"th")(3,"div",50),e._uU(4," Id "),e._UZ(5,"p-columnFilter",51),e.qZA()(),e.TgZ(6,"th")(7,"div",50),e._uU(8," Tipo "),e._UZ(9,"p-columnFilter",52),e.qZA()(),e.TgZ(10,"th")(11,"div",50),e._uU(12," Fecha contabilizaci\xf3n "),e._UZ(13,"p-columnFilter",53),e.qZA()(),e.TgZ(14,"th")(15,"div",50),e._uU(16," Fecha necesaria "),e._UZ(17,"p-columnFilter",54),e.qZA()(),e.TgZ(18,"th")(19,"div",50),e._uU(20," Comentarios "),e._UZ(21,"p-columnFilter",55),e.qZA()(),e.TgZ(22,"th")(23,"div",50),e._uU(24," \xc1rea "),e._UZ(25,"p-columnFilter",56),e.qZA()(),e.TgZ(26,"th")(27,"div",50),e._uU(28," Estado "),e.TgZ(29,"p-columnFilter",57),e.YNc(30,_i,2,2,"ng-template",58),e.qZA()()(),e.TgZ(31,"th")(32,"div",50),e._uU(33," Aprobada? "),e.TgZ(34,"p-columnFilter",59),e.YNc(35,gi,2,2,"ng-template",58),e.qZA()()(),e.TgZ(36,"th")(37,"div",50),e._uU(38," Usuario "),e._UZ(39,"p-columnFilter",60),e.qZA()(),e.TgZ(40,"th")(41,"div",50),e._uU(42," N\xfamero solped SAP "),e._UZ(43,"p-columnFilter",61),e.qZA()(),e.TgZ(44,"th")(45,"div",50),e._uU(46," Total Solped "),e.qZA()(),e._UZ(47,"th")(48,"th")(49,"th"),e.qZA()),2&n&&(e.xp6(29),e.Q6J("showMatchModes",!1)("showOperator",!1),e.xp6(5),e.Q6J("showMatchModes",!1)("showOperator",!1))}function Ci(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"i",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw();return e.KtG(l.mostrarAprobaciones(i.id))}),e.qZA()}}function bi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",64),e.qZA(),e.TgZ(3,"td",65),e._uU(4),e.qZA(),e.TgZ(5,"td",65),e._uU(6),e.qZA(),e.TgZ(7,"td",66),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",66),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"td",66),e._uU(14),e.qZA(),e.TgZ(15,"td",66),e._uU(16),e.qZA(),e.TgZ(17,"td",66),e._uU(18),e.ALo(19,"estados"),e.qZA(),e.TgZ(20,"td",66),e._uU(21),e.ALo(22,"estados"),e.qZA(),e.TgZ(23,"td",66),e._uU(24),e.qZA(),e.TgZ(25,"td",66),e._uU(26),e.qZA(),e.TgZ(27,"td"),e._uU(28),e.ALo(29,"number"),e.qZA(),e.TgZ(30,"td")(31,"i",67),e.NdJ("click",function(){const l=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.mostrarDetalle(l.id))}),e.qZA()(),e.TgZ(32,"td"),e.YNc(33,Ci,1,0,"i",68),e.qZA(),e.TgZ(34,"td")(35,"i",69),e.NdJ("click",function(){const l=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.mostrarAadjuntos(l.id))}),e.qZA()()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.id," "),e.xp6(2),e.hij(" ",t.serieStr," "),e.xp6(2),e.hij(" ",e.lcZ(9,14,t.docdate)," "),e.xp6(3),e.hij(" ",e.lcZ(12,16,t.reqdate)," "),e.xp6(3),e.hij(" ",t.comments," "),e.xp6(2),e.hij(" ",t.u_nf_depen_solped," "),e.xp6(2),e.hij(" ",e.xi3(19,18,t.status,"solped")," "),e.xp6(3),e.AsE(" ",e.xi3(22,21,t.approved,"aprobacion"),""," "+t.aprobador," "),e.xp6(3),e.hij(" ",t.fullname," "),e.xp6(2),e.hij(" ",t.sapdocnum," "),e.xp6(2),e.hij(" ",e.lcZ(29,24,t.subtotal)," "),e.xp6(5),e.Q6J("ngIf","N"!=t.approved)}}function Si(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",71),e._uU(2,"No se econtraron solicitudes de pedido."),e.qZA()())}function vi(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",71),e._uU(2,"Cargando solicitudes de pedido. Por favor espere"),e.qZA()())}function Ti(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",72)(1,"div",73),e._UZ(2,"i",74),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",75)(8,"div",76)(9,"button",77),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirm())}),e.qZA()(),e.TgZ(10,"div",76)(11,"button",78),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onReject())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function yi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",72)(1,"div",73),e._UZ(2,"i",74),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",75)(8,"div",76)(9,"button",77),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmAp())}),e.qZA()(),e.TgZ(10,"div",76)(11,"button",78),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectAp())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function xi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",72)(1,"div",73),e._UZ(2,"i",74),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",75)(8,"div",76)(9,"button",77),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmRap())}),e.qZA()(),e.TgZ(10,"div",76)(11,"button",78),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectRap())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function Zi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",72)(1,"div",73),e._UZ(2,"i",74),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",75)(8,"div",76)(9,"button",77),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmCancel())}),e.qZA()(),e.TgZ(10,"div",76)(11,"button",78),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectCancel())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function Ai(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",79),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.rechazarSolped())}),e.qZA()}}function Mi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",30)(1,"div")(2,"button",31),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(31);return e.KtG(i.clear(l))}),e.qZA()(),e.TgZ(3,"span",39),e._UZ(4,"i",40),e.TgZ(5,"input",41,42),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(31);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}}function Ui(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function Ni(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",80),e.NdJ("onChange",function(i){const r=e.CHM(t).filterCallback;return e.KtG(r(i.value))}),e.YNc(1,Ui,2,3,"ng-template",63),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.approves)}}function wi(n,o){1&n&&(e.TgZ(0,"tr")(1,"th")(2,"div",50),e._uU(3," Nivel "),e._UZ(4,"p-columnFilter",51),e.qZA()(),e.TgZ(5,"th")(6,"div",50),e._uU(7," Fecha envio solicitud "),e._UZ(8,"p-columnFilter",53),e.qZA()(),e.TgZ(9,"th")(10,"div",50),e._uU(11," Aprbador "),e._UZ(12,"p-columnFilter",52),e.qZA()(),e.TgZ(13,"th")(14,"div",50),e._uU(15," Estado "),e.TgZ(16,"p-columnFilter",59),e.YNc(17,Ni,2,2,"ng-template",58),e.qZA()()(),e.TgZ(18,"th")(19,"div",50),e._uU(20," Fecha aprobaci\xf3n "),e._UZ(21,"p-columnFilter",54),e.qZA()(),e.TgZ(22,"th")(23,"div",50),e._uU(24," Comentarios "),e._UZ(25,"p-columnFilter",55),e.qZA()()()),2&n&&(e.xp6(16),e.Q6J("showMatchModes",!1)("showOperator",!1))}function qi(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",66),e._uU(2),e.qZA(),e.TgZ(3,"td",66),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td",66),e._uU(7),e.qZA(),e.TgZ(8,"td",66),e._uU(9),e.ALo(10,"estados"),e.qZA(),e.TgZ(11,"td",66),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td",66),e._uU(15),e.ALo(16,"tooltips"),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t.nivel," "),e.xp6(2),e.hij(" ",e.lcZ(5,6,t.created_at)," "),e.xp6(3),e.hij(" ",t.nombreaprobador," "),e.xp6(2),e.hij(" ",e.xi3(10,8,t.estadoap,"aprobacion")," "),e.xp6(3),e.hij(" ","P"!=t.estadoap?e.lcZ(13,11,t.updated_at):""," "),e.xp6(3),e.hij(" ",e.xi3(16,13,t.comments,35)," ")}}function Fi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",79),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.dialogAprobaciones=!1)}),e.qZA()}}function Pi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",30)(1,"div")(2,"button",31),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(31);return e.KtG(i.clear(l))}),e.qZA()(),e.TgZ(3,"span",39),e._UZ(4,"i",40),e.TgZ(5,"input",41,42),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(31);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}}function Ei(n,o){1&n&&(e.TgZ(0,"tr")(1,"th")(2,"div",50),e._uU(3," Tipo "),e._UZ(4,"p-columnFilter",81),e.qZA()(),e.TgZ(5,"th")(6,"div",50),e._uU(7," Nombre "),e._UZ(8,"p-columnFilter",82),e.qZA()(),e.TgZ(9,"th")(10,"div",50),e._uU(11," Tama\xf1o "),e.qZA()(),e.TgZ(12,"th")(13,"div",50),e._uU(14," Fecha creaci\xf3n "),e._UZ(15,"p-columnFilter",53),e.qZA()(),e.TgZ(16,"th")(17,"div",83),e._UZ(18,"i",84),e.qZA()()())}function Li(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",66),e._uU(2),e.qZA(),e.TgZ(3,"td",66),e._uU(4),e.qZA(),e.TgZ(5,"td",66),e._uU(6),e.qZA(),e.TgZ(7,"td",66),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",85)(11,"p-button",86),e.NdJ("onClick",function(){const l=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.downloadAnexo(l.id,l.id_solped))}),e.qZA()()()}if(2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t.tipo," "),e.xp6(2),e.hij(" ",t.nombre," "),e.xp6(2),e.hij(" ",t.size," "),e.xp6(2),e.hij(" ",e.lcZ(9,4,t.created_at)," ")}}function Ji(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",87),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.dialogAdjuntos=!1)}),e.qZA()}}const Ii=function(){return{height:"6px"}};function ki(n,o){1&n&&(e.TgZ(0,"div",18),e._UZ(1,"p-progressBar",88),e.qZA()),2&n&&(e.xp6(1),e.Akn(e.DdM(2,Ii)))}function Di(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",30)(1,"div")(2,"button",89),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(31);return e.KtG(i.clear(l))}),e.qZA()(),e.TgZ(3,"span",39),e._UZ(4,"i",40),e.TgZ(5,"input",41,42),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(31);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}}function Oi(n,o){1&n&&(e.TgZ(0,"tr")(1,"th")(2,"div",50),e._uU(3," L\xednea detalle "),e._UZ(4,"p-columnFilter",90),e.qZA()(),e.TgZ(5,"th")(6,"div",50),e._uU(7," C\xf3digo \xcdtem "),e._UZ(8,"p-columnFilter",91),e.qZA()(),e.TgZ(9,"th")(10,"div",50),e._uU(11," Descripci\xf3n "),e._UZ(12,"p-columnFilter",92),e.qZA()(),e.TgZ(13,"th")(14,"div",50),e._uU(15," Fecha requerida "),e.qZA()(),e.TgZ(16,"th")(17,"div",50),e._uU(18," Proveedor "),e._UZ(19,"p-columnFilter",93),e.qZA()(),e.TgZ(20,"th")(21,"div",50),e._uU(22," Cuenta Mayor "),e._UZ(23,"p-columnFilter",94),e.qZA()(),e.TgZ(24,"th")(25,"div",50),e._uU(26," Vicepresidencia "),e._UZ(27,"p-columnFilter",95),e.qZA()(),e.TgZ(28,"th")(29,"div",50),e._uU(30," Dependencia "),e._UZ(31,"p-columnFilter",96),e.qZA()(),e.TgZ(32,"th")(33,"div",50),e._uU(34," Localidad "),e._UZ(35,"p-columnFilter",97),e.qZA()(),e.TgZ(36,"th")(37,"div",50),e._uU(38," Cantidad "),e.qZA()(),e.TgZ(39,"th")(40,"div",50),e._uU(41," Precio "),e.qZA()(),e.TgZ(42,"th")(43,"div",50),e._uU(44," Impuesto "),e.qZA()(),e.TgZ(45,"th")(46,"div",50),e._uU(47," Valor Impuesto "),e.qZA()(),e.TgZ(48,"th")(49,"div",50),e._uU(50," Subtotal l\xednea "),e.qZA()(),e.TgZ(51,"th")(52,"div",50),e._uU(53," Total l\xednea "),e.qZA()()())}function zi(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",66),e._uU(2),e.qZA(),e.TgZ(3,"td",66),e._uU(4),e.qZA(),e.TgZ(5,"td",66),e._uU(6),e.qZA(),e.TgZ(7,"td",66),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",66),e._uU(11),e.qZA(),e.TgZ(12,"td",66),e._uU(13),e.qZA(),e.TgZ(14,"td",66),e._uU(15),e.qZA(),e.TgZ(16,"td",66),e._uU(17),e.qZA(),e.TgZ(18,"td",66),e._uU(19),e.qZA(),e.TgZ(20,"td",66),e._uU(21),e.qZA(),e.TgZ(22,"td",66),e._uU(23),e.ALo(24,"currency"),e.qZA(),e.TgZ(25,"td",66),e._uU(26),e.ALo(27,"percent"),e.qZA(),e.TgZ(28,"td",66),e._uU(29),e.ALo(30,"currency"),e.qZA(),e.TgZ(31,"td",66),e._uU(32),e.ALo(33,"currency"),e.qZA(),e.TgZ(34,"td",66),e._uU(35),e.ALo(36,"currency"),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t.linenum," "),e.xp6(2),e.hij(" ",t.itemcode," "),e.xp6(2),e.hij(" ",t.dscription," "),e.xp6(2),e.hij(" ",e.lcZ(9,16,t.reqdatedet)," "),e.xp6(3),e.hij(" ",t.linevendor," "),e.xp6(2),e.hij(" ",t.acctcode," "),e.xp6(2),e.hij(" ",t.ocrcode3," "),e.xp6(2),e.hij(" ",t.ocrcode2," "),e.xp6(2),e.hij(" ",t.ocrcode," "),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",e.xi3(24,18,t.price,t.moneda)," "),e.xp6(3),e.AsE(" ",t.tax," ",e.lcZ(27,21,t.linegtotal/t.linetotal-1)," "),e.xp6(3),e.hij(" ",e.xi3(30,23,t.taxvalor,"COP")," "),e.xp6(3),e.hij(" ",e.xi3(33,26,t.linetotal,"COP")," "),e.xp6(3),e.hij(" ",e.xi3(36,29,t.linegtotal,"COP")," ")}}function Qi(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",98),e._uU(2,"Total"),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"currency"),e.qZA()()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(e.xi3(5,3,t.totalimpuestos,"COP")),e.xp6(3),e.Oqu(e.xi3(8,6,t.subtotal,"COP")),e.xp6(3),e.Oqu(e.xi3(11,9,t.grantotal,"COP"))}}function Bi(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",99),e._uU(2,"No se econtraron lineas asociadas a la solped."),e.qZA()())}function Ri(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",99),e._uU(2,"Cargando solicitudes de pedido. Por favor espere"),e.qZA()())}function Ki(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",79),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.listadoLineas=!1)}),e.qZA()}}const ae=function(){return["serie","status","sapdocnum","approved","u_nf_depen_solped","taxtdate","reqdate","fullname"]},H=function(){return{width:"50vw"}},Yi=function(n){return{"ng-invalid ng-dirty":n}},Gi=function(){return["itemcode","dscription","linevendor","acctcodename","acctcode","ocrcode","ocrcode2","ocrcode3"]};class j{constructor(o,t,a,i,l,r,s,c){this.rutaActiva=o,this.adminService=t,this.sapService=a,this.comprasService=i,this.router=l,this.confirmationService=r,this.messageService=s,this.authService=c,this.solped=[],this.loading=!0,this.errorFechaAprobacion=!1,this.arrayErrorFecha=[],this.errorTrmAprobacion=!1,this.arrayIdSolped=[],this.frmRechazo=!1,this.motivoRechazo="",this.submitRechazo=!1,this.errorUsuarioAprobador=!1,this.arrayErrorUsuarioAprobador=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSopledARechazada=!1,this.arraySolpedRechazadas=[],this.arraryErrorTrm=[],this.selectedSolped=[],this.dialogAprobaciones=!1,this.loadingAp=!0,this.urlBreadCrumb="",this.dialogAdjuntos=!1,this.series=[],this.listaDocumentosSolped=[],this.loadingDocumentos=!0,this.displayModal=!1,this.loadingCargue=!1,this.lineasSolped=[],this.lineaSeleccionada=[],this.listadoLineas=!1,this.totalimpuestos=0,this.subtotal=0,this.grantotal=0}ngOnInit(){this.infoUsuario=this.authService.getInfoUsuario(),this.perfilesUsuario=this.authService.getPerfilesUsuario(),this.permisosUsuario=this.authService.getPermisosUsuario(),this.permisosUsuarioPagina=this.permisosUsuario.filter(o=>o.url===this.router.url),this.urlBreadCrumb=this.router.url,this.statuses=[{label:"Abierta",value:"O"},{label:"Cerrada",value:"C"}],this.approves=[{label:"No enviada",value:"N"},{label:"Aprobada",value:"A"},{label:"Pendiente",value:"P"},{label:"Rechazada",value:"R"}],this.getSeries()}getSeries(){this.sapService.seriesDocXEngineSAP(this.authService.getToken(),"1470000113").subscribe({next:o=>{for(let t in o)this.series.push(o[t]);this.getListado()},error:o=>{}})}newSolped(){this.router.navigate(["/portal/compras/solped/nueva"])}editSolped(){this.router.navigate(["/portal/compras/solped/editar",this.selectedSolped[0].id])}confirm(){this.confirmationService.confirm({message:"Are you sure that you want to proceed?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{this.messageService.add({severity:"info",summary:"Confirmed",detail:"You have accepted"})},reject:o=>{switch(o){case u.wB.REJECT:this.messageService.add({severity:"error",summary:"Rejected",detail:"You have rejected"});break;case u.wB.CANCEL:this.messageService.add({severity:"warn",summary:"Cancelled",detail:"You have cancelled"})}}})}mostrarAprobaciones(o){this.dialogAprobaciones=!0,this.comprasService.aprobacionesSolped(this.authService.getToken(),o).subscribe({next:t=>{this.listaAprobaciones=t,this.loadingAp=!1},error:t=>{}})}mostrarAadjuntos(o){this.dialogAdjuntos=!0,this.comprasService.solpedById(this.authService.getToken(),o).subscribe({next:t=>{this.listaDocumentosSolped=t.anexos,this.loadingDocumentos=!1},error:t=>{}})}downloadAnexo(o,t){var a=this;return(0,C.Z)(function*(){let i=a.listaDocumentosSolped.filter(l=>l.id===o)[0];var l;a.comprasService.getAnexoSolped(a.authService.getToken(),o,t).subscribe({next:(l=(0,C.Z)(function*(r){if(""!==r.data){const s=`data:application/pdf;base64,${r.data}`,c=document.createElement("a");c.href=s,c.download=`${i.nombre}`,c.click()}else a.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:"No existe documento cargado en la base de datos"})}),function(s){return l.apply(this,arguments)}),error:l=>{}})})()}base64toBlob(o,t=""){return(0,C.Z)(function*(){const i=atob(o),l=i.length,r=Math.ceil(l/1024),s=new Array(r);for(let c=0;c<r;c+=1){const p=1024*c,m=Math.min(p+1024,l),y=new Array(m-p);for(let v=p,U=0;v<m;U+=1,v+=1)y[U]=i[v].charCodeAt(0);s[c]=new Uint8Array(y)}return new Blob(s,{type:t})})()}cancelarSolped(){let o=[];new Date,this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[];for(let i of this.selectedSolped)"C"===i.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(i.id)),"P"===i.approved&&(this.errorSolpedEnviada=!0,this.arrayErrorSolpedEnviada.push(i.id)),"A"===i.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(i.id)),o.push(i.id);this.arrayIdSolped=o;let a="";this.errorSolpedCancelada?(a=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSolpedCancelada=!1):this.errorSolpedEnviada?(a=this.arrayErrorSolpedEnviada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya han sido enviadas a aprobaci\xf3n.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya ha sido enviada a aprobaci\xf3n`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSolpedEnviada=!1):(a=o.length>1?"\xbfDesea Continuar con la cancelaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la cancelaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"cdel",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:a}))}solicitudAprobacion(){let a,o=[],t=new Date;this.errorFechaAprobacion=!1,this.arrayErrorFecha=[],this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorTrmAprobacion=!1,this.arraryErrorTrm=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[];for(let l of this.selectedSolped)a=new Date(l.docdate),"C"===l.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(l.id)),a.toDateString()!==t.toDateString()&&(this.errorFechaAprobacion=!0,this.arrayErrorFecha.push(l.id)),"P"===l.approved&&(this.errorSolpedEnviada=!0,this.arrayErrorSolpedEnviada.push(l.id)),"A"===l.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(l.id)),0===l.trm&&(this.errorTrmAprobacion=!0,this.arraryErrorTrm.push(l.id)),o.push(l.id);this.arrayIdSolped=o;let i="";this.errorSolpedCancelada?(i=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSolpedCancelada=!1):this.errorTrmAprobacion?(i=this.arraryErrorTrm.length>1?`Las solicitudes ${JSON.stringify(this.arraryErrorTrm)} no poseen TRM, por favor acutalice la TRM en las sulicitudes`:`La solicitud ${JSON.stringify(this.arraryErrorTrm)} no posee TRM, por favor acutalice la TRM de la sulicitud`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorTrmAprobacion=!1):this.errorSopledAprobada?(i=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha fue aprobada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSopledAprobada=!1):this.errorSolpedEnviada?(i=this.arrayErrorSolpedEnviada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya han sido enviadas a aprobaci\xf3n.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya ha fue enviada a aprobaci\xf3n`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSolpedEnviada=!1):(i=this.errorFechaAprobacion?this.arrayErrorFecha.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorFecha)} tienen fechas de contabilizaci\xf3n diferentes a la fecha actual. \n                       Recuerde que la TRM de la aprobaci\xf3n sera basada en la fecha de contabilizaci\xf3n de la solicitud.\n                       \xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas? `:`La fecha de contabilizaci\xf3n de la solicitud ${JSON.stringify(this.arrayErrorFecha)}  es diferente a la fecha actual. \n            Recuerde que la TRM de la aprobaci\xf3n sera basada en la fecha de contabilizaci\xf3n de la solicitud.\n            \xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada? `:o.length>1?"\xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"c",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:i}))}onConfirm(){this.loadingCargue=!0,this.displayModal=!0,this.loading=!0;let o="";this.messageService.clear("c"),this.comprasService.envioAprobacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{this.loadingCargue=!1,this.displayModal=!1,0===t.filter(a=>"error"===a.status).length?(o=this.selectedSolped.length>1?"Las solicitudes seleccionadas, han sido enviadas a aprobaci\xf3n":"Las solicitud seleccionada, ha sido enviada a aprobaci\xf3n",this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:o}),this.getListado()):(this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t[0].message}))},error:t=>{this.loading=!1,this.loadingCargue=!1,this.displayModal=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}rechazar(){this.arrayIdSolped=[];let o=[];this.arraySolpedRechazadas=[],this.arraySolpedAprobadas=[],this.arrayErrorUsuarioAprobador=[],this.errorSopledARechazada=!1,this.errorSopledAprobada=!1,this.errorUsuarioAprobador=!1;for(let a of this.selectedSolped)"R"===a.approved&&(this.errorSopledARechazada=!0,this.arraySolpedRechazadas.push(a.id)),"A"===a.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(a.id)),a.usersapaprobador!==this.infoUsuario.codusersap&&(this.errorUsuarioAprobador=!0,this.arrayErrorUsuarioAprobador.push(a.id)),o.push(a.id);this.arrayIdSolped=o;let t="";this.errorSopledARechazada?(t=this.arraySolpedRechazadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedRechazadas)} ya fueron rechazadas.`:`La solicitud ${JSON.stringify(this.arraySolpedRechazadas)} ya fue rechazada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledARechazada=!1):this.errorSopledAprobada?(t=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha sido aprobada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledAprobada=!1):this.errorUsuarioAprobador?(t=this.arrayErrorUsuarioAprobador.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no pueden ser rechazadas por el usuario por ahora.`:`La solicitud ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no puede ser rechazada por el usuario por ahora.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorUsuarioAprobador=!1):(t=o.length>1?"\xbfDesea Continuar con el rechazo de las solicitudes seleccionadas?":"\xbfDesea Continuar con el rechazo de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"rj",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:t}))}aprobar(){this.arrayIdSolped=[];let o=[];this.arraySolpedRechazadas=[],this.arraySolpedAprobadas=[],this.arrayErrorUsuarioAprobador=[],this.errorSopledARechazada=!1,this.errorSopledAprobada=!1,this.errorUsuarioAprobador=!1,this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[];for(let a of this.selectedSolped)"R"===a.approved&&(this.errorSopledARechazada=!0,this.arraySolpedRechazadas.push(a.id)),"C"===a.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(a.id)),"A"===a.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(a.id)),a.usersapaprobador!==this.infoUsuario.codusersap&&(this.errorUsuarioAprobador=!0,this.arrayErrorUsuarioAprobador.push(a.id)),o.push(a.id);this.arrayIdSolped=o;let t="";this.errorSolpedCancelada?(t=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSolpedCancelada=!1):this.errorSopledARechazada?(t=this.arraySolpedRechazadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedRechazadas)} ya fueron rechazadas.`:`La solicitud ${JSON.stringify(this.arraySolpedRechazadas)} ya fue rechazada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledARechazada=!1):this.errorSopledAprobada?(t=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha sido aprobada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledAprobada=!1):this.errorUsuarioAprobador?(t=this.arrayErrorUsuarioAprobador.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no pueden ser aprobadas por el usuario por ahora.`:`La solicitud ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no puede ser aprobada por el usuario por ahora.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorUsuarioAprobador=!1):(t=o.length>1?"\xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"ap",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:t}))}onReject(){this.messageService.clear("c"),this.errorFechaAprobacion=!1}onRejectAp(){this.messageService.clear("ap")}onRejectRap(){this.messageService.clear("rj")}onRejectCancel(){this.messageService.clear("cdel")}onConfirmCancel(){this.loadingCargue=!0,this.displayModal=!0,this.loading=!0;let o="";this.messageService.clear("cdel"),this.comprasService.cancelacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{this.loadingCargue=!1,this.displayModal=!1,"ok"==t.status?(o=this.arrayIdSolped.length>1?"La cancelaci\xf3n de las solicitudes seleccionadas fueron realizadas correctamente":"La cancelaci\xf3n de la solicitud seleccionada fue realizada correctamente",this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:o}),this.getListado()):(this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t.message}),this.loading=!1)},error:t=>{this.loading=!1,this.loadingCargue=!1,this.displayModal=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}onConfirmRap(){this.messageService.clear("rj"),this.frmRechazo=!0}rechazarSolped(){this.loadingCargue=!0,this.displayModal=!0,this.submitRechazo=!0,this.motivoRechazo?this.comprasService.aprobacionesSolped(this.authService.getToken(),this.selectedSolped[0].id).subscribe({next:o=>{let t=o.filter(i=>i.usersapaprobador===this.infoUsuario.codusersap&&"A"===i.estadoseccion&&"P"===i.estadoap);this.comprasService.rechazoSolped({autor:{fullname:t[0].nombreautor,email:t[0].emailautor},aprobador:{fullname:t[0].nombreaprobador,email:t[0].emailaprobador,usersap:t[0].usersapaprobador},infoSolped:{id_solped:this.selectedSolped[0].id,idlineap:t[0].id,bdmysql:this.infoUsuario.bdmysql,companysap:this.infoUsuario.dbcompanysap,logo:this.infoUsuario.logoempresa,comments:this.motivoRechazo}}).subscribe({next:i=>{this.loadingCargue=!1,this.displayModal=!1,"ok"===i[0].status?(this.getListado(),this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:i[0].message}),this.frmRechazo=!1):this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i[0].message})},error:i=>{this.loadingCargue=!1,this.displayModal=!1}})},error:o=>{this.loadingCargue=!1,this.displayModal=!1}}):this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:"Debe diligenciar el motivo por el cual desea rechazar la solicitud seleccionada"})}onConfirmAp(){this.loadingCargue=!0,this.displayModal=!0,this.loading=!0,this.messageService.clear("ap"),this.comprasService.aprobacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{console.log(t),this.loadingCargue=!1,this.displayModal=!1;let a=[];if(t[0].status&&"error"==t[0].status)this.messageService.add({key:"t1",severity:"error",summary:"!Error",detail:t[0].message});else{if(console.log("aqui entro"),t[0].arrayErrors.length>0){for(let i of t[0].arrayErrors)a.push({key:"tl",severity:"error",summary:"!Error",detail:i.message,life:5e3});if(t[0].arrayAproved.length>0){a.push({key:"tl",severity:"warn",summary:"!informaci\xf3n",detail:"Es posible que las siguentes solicitudes no se lograran guardar debido a los errores presentados.",life:5e3});for(let i of t[0].arrayAproved)a.push({key:"tl",severity:"warn",summary:"!informaci\xf3n",detail:i.message,life:5e3})}}else if(t[0].arrayAproved.length>0)for(let i of t[0].arrayAproved)a.push({key:"tl",severity:"success",summary:"!Ok",detail:i.messageSolped,life:5e3});this.getListado(),this.messageService.addAll(a)}},error:t=>{this.loading=!1,this.loadingCargue=!1,this.displayModal=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}clearToast(){this.messageService.clear()}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}getListado(){this.comprasService.listSolped(this.authService.getToken()).subscribe({next:o=>{console.log(o),this.loading=!1;for(let t of o)""!==t.serie&&(t.serieStr=this.series.filter(a=>a.code==t.serie)[0].name);this.solped=o,this.loading=!1},error:o=>{}})}mostrarDetalle(o){this.displayModal=!0,this.comprasService.solpedById(this.authService.getToken(),o).subscribe({next:t=>{console.log(t);let a=0,i=0,l=0;for(let r of t.solpedDet)a+=r.taxvalor,i+=r.linetotal,l+=r.linegtotal;this.displayModal=!1,this.listadoLineas=!0,this.lineasSolped=t.solpedDet,this.totalimpuestos=a,this.subtotal=i,this.grantotal=l},error:t=>{console.error(t),this.displayModal=!1}})}exportExcel(){d.e(574).then(d.bind(d,574)).then(o=>{const a={Sheets:{data:o.utils.json_to_sheet(this.solped)},SheetNames:["data"]},i=o.write(a,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(i,"solpeds")})}saveAsExcelFile(o,t){const l=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});_e.saveAs(l,t+"_export_"+(new Date).getTime()+".xlsx")}}j.\u0275fac=function(o){return new(o||j)(e.Y36(f.gz),e.Y36(X.l),e.Y36(w.c),e.Y36(Z.K),e.Y36(f.F0),e.Y36(u.YP),e.Y36(u.ez),e.Y36(x.e))},j.\u0275cmp=e.Xpm({type:j,selectors:[["app-solped"]],viewQuery:function(o,t){if(1&o&&e.Gf(ni,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},features:[e._Bn([u.ez,u.YP])],decls:59,vars:79,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12"],[1,"card"],["dataKey","id","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["key","tl"],["key","c",3,"baseZIndex","onClose"],["pTemplate","message"],["key","ap",3,"baseZIndex","onClose"],["key","rj",3,"baseZIndex","onClose"],["key","cdel",3,"baseZIndex","onClose"],["header","Motivo rechazo solped",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],[1,"field","col"],["pInputTextarea","","styleClass","w-full","rows","10",1,"w-full","h-full",3,"ngModel","ngClass","ngModelChange"],["pTemplate","footer"],["header","Proceso de aprobaci\xf3n",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","id","styleClass","p-datatable-gridlines p-datatable-sm ","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields"],["dt2",""],["header","Documentos adjuntos de solped",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["header","Cargando",3,"visible","modal","draggable","resizable","visibleChange"],[1,"m-0"],["class","field col",4,"ngIf"],["header","Detalle de la solicitud de pedido",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","linenum","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","pTooltip","Limpiar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-success p-button-sm","icon","pi pi-plus",3,"disabled","click",4,"ngIf"],["pButton","","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-secondary p-button-sm",3,"pTooltip","icon","disabled","click",4,"ngIf"],["pButton","","pTooltip","Enviar a aprobaci\xf3n","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-warning p-button-sm","icon","pi pi-send",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-danger p-button-sm","icon","pi pi-trash",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Aprobar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-help p-button-sm","icon","pi pi-check-circle",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Rechazar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-danger p-button-sm","icon","pi pi-times-circle",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Exportar a excel","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-file-excel",1,"p-button-outlined","mb-2","mr-2","p-button-success","p-button-sm",3,"click"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar por palabra clave",1,"w-full","p-inputtext-sm",3,"input"],["filter",""],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-plus",1,"p-button-outlined","mb-2","mr-2","p-button-success","p-button-sm",3,"disabled","click"],["pButton","","tooltipPosition","bottom","placeholder","Bottom",1,"p-button-outlined","mb-2","mr-2","p-button-secondary","p-button-sm",3,"pTooltip","icon","disabled","click"],["pButton","","pTooltip","Enviar a aprobaci\xf3n","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-send",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Aprobar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-check-circle",1,"p-button-outlined","mb-2","mr-2","p-button-help","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Rechazar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-times-circle",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],[2,"width","3rem"],[1,"flex","justify-content-between","align-items-center"],["type","text","field","id","display","menu","placeholder","Buscar por c\xf3digo solped"],["type","text","field","serie","display","menu","placeholder","Buscar por tipo solped"],["type","date","field","docdate","display","menu"],["type","date","field","reqdate","display","menu"],["type","text","field","comments","display","menu","placeholder","Buscar por comentario"],["type","text","field","u_nf_depen_solped","display","menu","placeholder","Buscar por area"],["field","status","matchMode","equals","display","menu","placeholder","Buscar por estado",3,"showMatchModes","showOperator"],["pTemplate","filter"],["field","approved","display","menu","matchMode","equals","placeholder","Buscar por aprobaci\xf3n",3,"showMatchModes","showOperator"],["type","text","field","fullname","display","menu","placeholder","Buscar por usuario"],["type","text","field","sapsocnum","display","menu","placeholder","Buscar por c\xf3digo SAP"],["placeholder","Cualquiera",3,"ngModel","options","onChange"],["pTemplate","item"],[3,"value"],[2,"min-width","6rem"],[2,"min-width","12rem"],["pTooltip","Detalle","tooltipPosition","left",1,"pi","pi-list",3,"click"],["class","pi pi-check-square","pTooltip","Aprobaciones","tooltipPosition","left",3,"click",4,"ngIf"],["pTooltip","Adjuntos","tooltipPosition","left",1,"pi","pi-file-pdf",3,"click"],["pTooltip","Aprobaciones","tooltipPosition","left",1,"pi","pi-check-square",3,"click"],["colspan","11",1,"text-center"],[1,"flex","flex-column",2,"flex","1"],[1,"text-center"],[1,"pi","pi-exclamation-triangle",2,"font-size","3rem"],[1,"grid","p-fluid"],[1,"col-6"],["type","button","pButton","","label","Si",1,"p-button-success",3,"click"],["type","button","pButton","","label","No",1,"p-button-secondary",3,"click"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"click"],["placeholder","Any",3,"ngModel","options","onChange"],["type","text","field","tipo","display","menu","placeholder","Buscar por tipo documento"],["type","text","field","nombre","display","menu","placeholder","Buscar por nombre documento"],[1,"align-content-center","justify-content-center"],["pTooltip","Adjuntos","tooltipPosition","left",1,"pi","pi-file-pdf"],[2,"min-width","4rem"],["label","Descargar","icon","pi pi-download","iconPos","left",1,"w-full",3,"onClick"],["icon","pi pi-check","label","Cerrar","styleClass","p-button-text",3,"click"],["mode","indeterminate"],["pButton","","label","Limpiar","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["type","text","field","linenum","display","menu","placeholder","Buscar por linea detalle"],["type","text","field","itemcode","display","menu","placeholder","Buscar por c\xf3digo item"],["type","text","field","dscription","display","menu","placeholder","Buscar por descripci\xf3n"],["type","text","field","linevendor","display","menu","placeholder","Buscar por proveedor"],["type","text","field","acctcode","display","menu","placeholder","Buscar por cuenta"],["type","text","field","ocrcode3","display","menu","placeholder","Buscar por vicepresidencia"],["type","text","field","orecode2","display","menu","placeholder","Buscar por dependencia"],["type","text","field","location","display","menu","placeholder","Buscar por localidad"],["colspan","12",1,"text-right"],["colspan","15",1,"text-center"]],template:function(o,t){1&o&&(e._UZ(0,"app-breadcrumb",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"p-table",4,5),e.NdJ("selectionChange",function(i){return t.selectedSolped=i}),e.YNc(6,ui,14,6,"ng-template",6),e.YNc(7,fi,50,4,"ng-template",7),e.YNc(8,bi,36,26,"ng-template",8),e.YNc(9,Si,3,0,"ng-template",9),e.YNc(10,vi,3,0,"ng-template",10),e.qZA()()()(),e._UZ(11,"p-toast",11),e.TgZ(12,"p-toast",12),e.NdJ("onClose",function(){return t.onReject()}),e.YNc(13,Ti,12,2,"ng-template",13),e.qZA(),e.TgZ(14,"p-toast",14),e.NdJ("onClose",function(){return t.onRejectAp()}),e.YNc(15,yi,12,2,"ng-template",13),e.qZA(),e.TgZ(16,"p-toast",15),e.NdJ("onClose",function(){return t.onRejectRap()}),e.YNc(17,xi,12,2,"ng-template",13),e.qZA(),e.TgZ(18,"p-toast",16),e.NdJ("onClose",function(){return t.onRejectCancel()}),e.YNc(19,Zi,12,2,"ng-template",13),e.qZA(),e.TgZ(20,"p-dialog",17),e.NdJ("visibleChange",function(i){return t.frmRechazo=i}),e.TgZ(21,"div",1)(22,"div",18)(23,"textarea",19),e.NdJ("ngModelChange",function(i){return t.motivoRechazo=i}),e._uU(24,"\t\t\t"),e.qZA()()(),e.YNc(25,Ai,1,0,"ng-template",20),e.qZA(),e.TgZ(26,"p-dialog",21),e.NdJ("visibleChange",function(i){return t.dialogAprobaciones=i}),e.TgZ(27,"div",1)(28,"div",2)(29,"div",3)(30,"p-table",22,23),e.YNc(32,Mi,7,0,"ng-template",6),e.YNc(33,wi,26,2,"ng-template",7),e.YNc(34,qi,17,16,"ng-template",8),e.qZA()()()(),e.YNc(35,Fi,1,0,"ng-template",20),e.qZA(),e.TgZ(36,"p-dialog",24),e.NdJ("visibleChange",function(i){return t.dialogAdjuntos=i}),e.TgZ(37,"div",1)(38,"div",2)(39,"div",3)(40,"p-table",22,23),e.YNc(42,Pi,7,0,"ng-template",6),e.YNc(43,Ei,19,0,"ng-template",7),e.YNc(44,Li,12,6,"ng-template",8),e.qZA()()()(),e.YNc(45,Ji,1,0,"ng-template",20),e.qZA(),e.TgZ(46,"p-dialog",25),e.NdJ("visibleChange",function(i){return t.displayModal=i}),e._UZ(47,"p",26),e.YNc(48,ki,2,3,"div",27),e.qZA(),e.TgZ(49,"p-dialog",28),e.NdJ("visibleChange",function(i){return t.listadoLineas=i}),e.TgZ(50,"p-table",29,23),e.NdJ("selectionChange",function(i){return t.lineaSeleccionada=i}),e.YNc(52,Di,7,0,"ng-template",6),e.YNc(53,Oi,54,0,"ng-template",7),e.YNc(54,zi,37,32,"ng-template",8),e.YNc(55,Qi,12,12,"ng-template",20),e.YNc(56,Bi,3,0,"ng-template",9),e.YNc(57,Ri,3,0,"ng-template",10),e.qZA(),e.YNc(58,Ki,1,0,"ng-template",20),e.qZA()),2&o&&(e.Q6J("urlBreadCrumb",t.urlBreadCrumb),e.xp6(4),e.Q6J("value",t.solped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(68,ae))("selection",t.selectedSolped),e.xp6(8),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Akn(e.DdM(69,H)),e.Q6J("visible",t.frmRechazo)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(3),e.Q6J("ngModel",t.motivoRechazo)("ngClass",e.VKq(70,Yi,t.submitRechazo&&!t.motivoRechazo)),e.xp6(3),e.Akn(e.DdM(72,H)),e.Q6J("visible",t.dialogAprobaciones)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(4),e.Q6J("value",t.listaAprobaciones)("rows",10)("loading",t.loadingAp)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(73,ae)),e.xp6(6),e.Akn(e.DdM(74,H)),e.Q6J("visible",t.dialogAdjuntos)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(4),e.Q6J("value",t.listaDocumentosSolped)("rows",10)("loading",t.loadingDocumentos)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(75,ae)),e.xp6(6),e.Akn(e.DdM(76,H)),e.Q6J("visible",t.displayModal)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(2),e.Q6J("ngIf",t.loadingCargue),e.xp6(1),e.Akn(e.DdM(77,H)),e.Q6J("visible",t.listadoLineas)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(1),e.Q6J("value",t.lineasSolped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(78,Gi))("selection",t.lineaSeleccionada))},dependencies:[_.mk,_.O5,h.Fj,h.JJ,h.On,u.jx,T.Hq,T.zx,q.u,N.V,F.Lt,P.k,D.g,O.o,S.iA,S.UA,S.xl,M.FN,z.L,_.JJ,_.Zx,_.H9,_.uU,ge.L,he.E],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]});const Hi=["filter"];function ji(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.newSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].create_accion)}}function $i(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",38),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.editSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("pTooltip",t.permisosUsuarioPagina[0].update_accion?"Editar":"Consultar")("icon",t.permisosUsuarioPagina[0].update_accion?"pi pi-pencil":"pi pi-search")("disabled",!t.permisosUsuarioPagina[0].read_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function Vi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.solicitudAprobacion())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].update_accion||!t.selectedSolped||0==t.selectedSolped.length)}}function Xi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.cancelarSolped())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].update_accion||!t.selectedSolped||0==t.selectedSolped.length)}}function Wi(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.aprobar())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].aproved_accion||!t.selectedSolped||0==t.selectedSolped.length)}}function ea(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.rechazar())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.permisosUsuarioPagina[0].aproved_accion||!t.selectedSolped||1!=t.selectedSolped.length)}}function ta(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",25)(1,"div")(2,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(5);return e.KtG(i.clear(l))}),e.qZA(),e.YNc(3,ji,1,1,"button",27),e.YNc(4,$i,1,3,"button",28),e.YNc(5,Vi,1,1,"button",29),e.YNc(6,Xi,1,1,"button",30),e.YNc(7,Wi,1,1,"button",31),e.YNc(8,ea,1,1,"button",32),e.qZA(),e.TgZ(9,"span",33),e._UZ(10,"i",34),e.TgZ(11,"input",35,36),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(5);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.permisosUsuarioPagina[0].create_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].update_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].aproved_accion),e.xp6(1),e.Q6J("ngIf",t.permisosUsuarioPagina[0].aproved_accion)}}function oa(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function ia(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",56),e.NdJ("onChange",function(i){const r=e.CHM(t).filterCallback;return e.KtG(r(i.value))}),e.YNc(1,oa,2,3,"ng-template",57),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.statuses)}}function aa(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function na(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",56),e.NdJ("onChange",function(i){const r=e.CHM(t).filterCallback;return e.KtG(r(i.value))}),e.YNc(1,aa,2,3,"ng-template",57),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.approves)}}function la(n,o){1&n&&(e.TgZ(0,"tr"),e._UZ(1,"th",43),e.TgZ(2,"th")(3,"div",44),e._uU(4," Id "),e._UZ(5,"p-columnFilter",45),e.qZA()(),e.TgZ(6,"th")(7,"div",44),e._uU(8," Tipo "),e._UZ(9,"p-columnFilter",46),e.qZA()(),e.TgZ(10,"th")(11,"div",44),e._uU(12," Fecha contabilizaci\xf3n "),e._UZ(13,"p-columnFilter",47),e.qZA()(),e.TgZ(14,"th")(15,"div",44),e._uU(16," Fecha necesaria "),e._UZ(17,"p-columnFilter",48),e.qZA()(),e.TgZ(18,"th")(19,"div",44),e._uU(20," Comentarios "),e._UZ(21,"p-columnFilter",49),e.qZA()(),e.TgZ(22,"th")(23,"div",44),e._uU(24," \xc1rea "),e._UZ(25,"p-columnFilter",50),e.qZA()(),e.TgZ(26,"th")(27,"div",44),e._uU(28," Estado "),e.TgZ(29,"p-columnFilter",51),e.YNc(30,ia,2,2,"ng-template",52),e.qZA()()(),e.TgZ(31,"th")(32,"div",44),e._uU(33," Aprobada? "),e.TgZ(34,"p-columnFilter",53),e.YNc(35,na,2,2,"ng-template",52),e.qZA()()(),e.TgZ(36,"th")(37,"div",44),e._uU(38," Usuario "),e._UZ(39,"p-columnFilter",54),e.qZA()(),e.TgZ(40,"th")(41,"div",44),e._uU(42," N\xfamero solped SAP "),e._UZ(43,"p-columnFilter",55),e.qZA()(),e._UZ(44,"th")(45,"th"),e.qZA()),2&n&&(e.xp6(29),e.Q6J("showMatchModes",!1)("showOperator",!1),e.xp6(5),e.Q6J("showMatchModes",!1)("showOperator",!1))}function ra(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"i",63),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw();return e.KtG(l.mostrarAprobaciones(i.id))}),e.qZA()}}function sa(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",58),e.qZA(),e.TgZ(3,"td",59),e._uU(4),e.qZA(),e.TgZ(5,"td",59),e._uU(6),e.qZA(),e.TgZ(7,"td",60),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",60),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"td",60),e._uU(14),e.qZA(),e.TgZ(15,"td",60),e._uU(16),e.qZA(),e.TgZ(17,"td",60),e._uU(18),e.ALo(19,"estados"),e.qZA(),e.TgZ(20,"td",60),e._uU(21),e.ALo(22,"estados"),e.qZA(),e.TgZ(23,"td",60),e._uU(24),e.qZA(),e.TgZ(25,"td",60),e._uU(26),e.qZA(),e.TgZ(27,"td"),e.YNc(28,ra,1,0,"i",61),e.qZA(),e.TgZ(29,"td")(30,"i",62),e.NdJ("click",function(){const l=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.mostrarAadjuntos(l.id))}),e.qZA()()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Q6J("value",t),e.xp6(2),e.hij(" ",t.id," "),e.xp6(2),e.hij(" ",t.serieStr," "),e.xp6(2),e.hij(" ",e.lcZ(9,13,t.docdate)," "),e.xp6(3),e.hij(" ",e.lcZ(12,15,t.reqdate)," "),e.xp6(3),e.hij(" ",t.comments," "),e.xp6(2),e.hij(" ",t.u_nf_depen_solped," "),e.xp6(2),e.hij(" ",e.xi3(19,17,t.status,"solped")," "),e.xp6(3),e.AsE(" ",e.xi3(22,20,t.approved,"aprobacion"),""," "+t.aprobador," "),e.xp6(3),e.hij(" ",t.fullname," "),e.xp6(2),e.hij(" ",t.sapdocnum," "),e.xp6(2),e.Q6J("ngIf","N"!=t.approved)}}function da(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",64),e._uU(2,"No se econtraron solicitudes de pedido."),e.qZA()())}function pa(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",64),e._uU(2,"Cargando solicitudes de pedido. Por favor espere"),e.qZA()())}function ca(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",65)(1,"div",66),e._UZ(2,"i",67),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",68)(8,"div",69)(9,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirm())}),e.qZA()(),e.TgZ(10,"div",69)(11,"button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onReject())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function ua(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",65)(1,"div",66),e._UZ(2,"i",67),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",68)(8,"div",69)(9,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmAp())}),e.qZA()(),e.TgZ(10,"div",69)(11,"button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectAp())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function ma(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",65)(1,"div",66),e._UZ(2,"i",67),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",68)(8,"div",69)(9,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmRap())}),e.qZA()(),e.TgZ(10,"div",69)(11,"button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectRap())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function _a(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",65)(1,"div",66),e._UZ(2,"i",67),e.TgZ(3,"h4"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",68)(8,"div",69)(9,"button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onConfirmCancel())}),e.qZA()(),e.TgZ(10,"div",69)(11,"button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onRejectCancel())}),e.qZA()()()()}if(2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.summary),e.xp6(2),e.Oqu(t.detail)}}function ha(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",72),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.rechazarSolped())}),e.qZA()}}function ga(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",25)(1,"div")(2,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(31);return e.KtG(i.clear(l))}),e.qZA()(),e.TgZ(3,"span",33),e._UZ(4,"i",34),e.TgZ(5,"input",35,36),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(31);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}}function fa(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Tol("customer-badge status-"+t.value),e.xp6(1),e.Oqu(t.label)}}function Ca(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",56),e.NdJ("onChange",function(i){const r=e.CHM(t).filterCallback;return e.KtG(r(i.value))}),e.YNc(1,fa,2,3,"ng-template",57),e.qZA()}if(2&n){const t=o.$implicit,a=e.oxw(2);e.Q6J("ngModel",t)("options",a.approves)}}function ba(n,o){1&n&&(e.TgZ(0,"tr")(1,"th")(2,"div",44),e._uU(3," Nivel "),e._UZ(4,"p-columnFilter",45),e.qZA()(),e.TgZ(5,"th")(6,"div",44),e._uU(7," Fecha envio solicitud "),e._UZ(8,"p-columnFilter",47),e.qZA()(),e.TgZ(9,"th")(10,"div",44),e._uU(11," Aprbador "),e._UZ(12,"p-columnFilter",46),e.qZA()(),e.TgZ(13,"th")(14,"div",44),e._uU(15," Estado "),e.TgZ(16,"p-columnFilter",53),e.YNc(17,Ca,2,2,"ng-template",52),e.qZA()()(),e.TgZ(18,"th")(19,"div",44),e._uU(20," Fecha aprobaci\xf3n "),e._UZ(21,"p-columnFilter",48),e.qZA()(),e.TgZ(22,"th")(23,"div",44),e._uU(24," Comentarios "),e._UZ(25,"p-columnFilter",49),e.qZA()()()),2&n&&(e.xp6(16),e.Q6J("showMatchModes",!1)("showOperator",!1))}function Sa(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",60),e._uU(2),e.qZA(),e.TgZ(3,"td",60),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td",60),e._uU(7),e.qZA(),e.TgZ(8,"td",60),e._uU(9),e.ALo(10,"estados"),e.qZA(),e.TgZ(11,"td",60),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td",60),e._uU(15),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t.nivel," "),e.xp6(2),e.hij(" ",e.lcZ(5,6,t.created_at)," "),e.xp6(3),e.hij(" ",t.nombreaprobador," "),e.xp6(2),e.hij(" ",e.xi3(10,8,t.estadoap,"aprobacion")," "),e.xp6(3),e.hij(" ","P"!=t.estadoap?e.lcZ(13,11,t.updated_at):""," "),e.xp6(3),e.hij(" ",t.comments," ")}}function va(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",72),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.dialogAprobaciones=!1)}),e.qZA()}}function Ta(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",25)(1,"div")(2,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=e.MAs(31);return e.KtG(i.clear(l))}),e.qZA()(),e.TgZ(3,"span",33),e._UZ(4,"i",34),e.TgZ(5,"input",35,36),e.NdJ("input",function(i){e.CHM(t);const l=e.oxw(),r=e.MAs(31);return e.KtG(l.onGlobalFilter(r,i))}),e.qZA()()()}}function ya(n,o){1&n&&(e.TgZ(0,"tr")(1,"th")(2,"div",44),e._uU(3," Tipo "),e._UZ(4,"p-columnFilter",73),e.qZA()(),e.TgZ(5,"th")(6,"div",44),e._uU(7," Nombre "),e._UZ(8,"p-columnFilter",74),e.qZA()(),e.TgZ(9,"th")(10,"div",44),e._uU(11," Tama\xf1o "),e.qZA()(),e.TgZ(12,"th")(13,"div",44),e._uU(14," Fecha creaci\xf3n "),e._UZ(15,"p-columnFilter",47),e.qZA()(),e.TgZ(16,"th")(17,"div",75),e._UZ(18,"i",76),e.qZA()()())}function xa(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",60),e._uU(2),e.qZA(),e.TgZ(3,"td",60),e._uU(4),e.qZA(),e.TgZ(5,"td",60),e._uU(6),e.qZA(),e.TgZ(7,"td",60),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",77)(11,"p-button",78),e.NdJ("onClick",function(){const l=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.downloadAnexo(l.id,l.id_solped))}),e.qZA()()()}if(2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t.tipo," "),e.xp6(2),e.hij(" ",t.nombre," "),e.xp6(2),e.hij(" ",t.size," "),e.xp6(2),e.hij(" ",e.lcZ(9,4,t.created_at)," ")}}function Za(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",79),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.dialogAdjuntos=!1)}),e.qZA()}}const ne=function(){return["serie","status","sapdocnum","approved","u_nf_depen_solped","taxtdate","reqdate","fullname"]},le=function(){return{width:"50vw"}},Aa=function(n){return{"ng-invalid ng-dirty":n}};class ${constructor(o,t,a,i,l,r,s,c){this.rutaActiva=o,this.adminService=t,this.sapService=a,this.comprasService=i,this.router=l,this.confirmationService=r,this.messageService=s,this.authService=c,this.solped=[],this.loading=!0,this.errorFechaAprobacion=!1,this.arrayErrorFecha=[],this.errorTrmAprobacion=!1,this.arrayIdSolped=[],this.frmRechazo=!1,this.motivoRechazo="",this.submitRechazo=!1,this.errorUsuarioAprobador=!1,this.arrayErrorUsuarioAprobador=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSopledARechazada=!1,this.arraySolpedRechazadas=[],this.arraryErrorTrm=[],this.selectedSolped=[],this.dialogAprobaciones=!1,this.loadingAp=!0,this.urlBreadCrumb="",this.dialogAdjuntos=!1,this.series=[],this.listaDocumentosSolped=[],this.loadingDocumentos=!0}ngOnInit(){this.infoUsuario=this.authService.getInfoUsuario(),this.perfilesUsuario=this.authService.getPerfilesUsuario(),this.permisosUsuario=this.authService.getPermisosUsuario(),this.permisosUsuarioPagina=this.permisosUsuario.filter(o=>o.url===this.router.url),this.urlBreadCrumb=this.router.url,this.statuses=[{label:"Abierta",value:"O"},{label:"Cerrada",value:"C"}],this.approves=[{label:"No aprobada",value:"N"},{label:"Aprobada",value:"A"},{label:"Pendiente",value:"P"},{label:"Rechazada",value:"R"}],this.getSeries()}getSeries(){this.sapService.seriesDocXEngineSAP(this.authService.getToken(),"1470000113").subscribe({next:o=>{for(let t in o)this.series.push(o[t]);console.log(this.series),this.getListado()},error:o=>{console.log(o)}})}newSolped(){this.router.navigate(["/portal/compras/solped/nueva"])}editSolped(){this.router.navigate(["/portal/compras/solped/editar",this.selectedSolped[0].id])}confirm(){this.confirmationService.confirm({message:"Are you sure that you want to proceed?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{this.messageService.add({severity:"info",summary:"Confirmed",detail:"You have accepted"})},reject:o=>{switch(o){case u.wB.REJECT:this.messageService.add({severity:"error",summary:"Rejected",detail:"You have rejected"});break;case u.wB.CANCEL:this.messageService.add({severity:"warn",summary:"Cancelled",detail:"You have cancelled"})}}})}mostrarAprobaciones(o){this.dialogAprobaciones=!0,this.comprasService.aprobacionesSolped(this.authService.getToken(),o).subscribe({next:t=>{this.listaAprobaciones=t,this.loadingAp=!1},error:t=>{console.log(t)}})}mostrarAadjuntos(o){this.dialogAdjuntos=!0,this.comprasService.solpedById(this.authService.getToken(),o).subscribe({next:t=>{console.log(t.anexos),this.listaDocumentosSolped=t.anexos,this.loadingDocumentos=!1},error:t=>{console.log(t)}})}downloadAnexo(o,t){var a=this;return(0,C.Z)(function*(){let i=a.listaDocumentosSolped.filter(l=>l.id===o)[0];var l;a.comprasService.getAnexoSolped(a.authService.getToken(),o,t).subscribe({next:(l=(0,C.Z)(function*(r){if(""!==r.data){const s=`data:application/pdf;base64,${r.data}`,c=document.createElement("a");c.href=s,c.download=`${i.nombre}`,c.click()}else a.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:"No existe documento cargado en la base de datos"})}),function(s){return l.apply(this,arguments)}),error:l=>{console.log(l)}})})()}base64toBlob(o,t=""){return(0,C.Z)(function*(){const i=atob(o),l=i.length,r=Math.ceil(l/1024),s=new Array(r);for(let c=0;c<r;c+=1){const p=1024*c,m=Math.min(p+1024,l),y=new Array(m-p);for(let v=p,U=0;v<m;U+=1,v+=1)y[U]=i[v].charCodeAt(0);s[c]=new Uint8Array(y)}return new Blob(s,{type:t})})()}cancelarSolped(){let o=[];new Date,this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[];for(let i of this.selectedSolped)"C"===i.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(i.id)),"P"===i.approved&&(this.errorSolpedEnviada=!0,this.arrayErrorSolpedEnviada.push(i.id)),"A"===i.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(i.id)),o.push(i.id);this.arrayIdSolped=o;let a="";this.errorSolpedCancelada?(a=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSolpedCancelada=!1):this.errorSopledAprobada?(a=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha sido aprobada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSopledAprobada=!1):this.errorSolpedEnviada?(a=this.arrayErrorSolpedEnviada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya han sido enviadas a aprobaci\xf3n.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya ha sido enviada a aprobaci\xf3n`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:a}),this.errorSolpedEnviada=!1):(a=o.length>1?"\xbfDesea Continuar con la cancelaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la cancelaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"cdel",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:a}))}solicitudAprobacion(){let a,o=[],t=new Date;this.errorFechaAprobacion=!1,this.arrayErrorFecha=[],this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[],this.errorTrmAprobacion=!1,this.arraryErrorTrm=[],this.errorSolpedEnviada=!1,this.arrayErrorSolpedEnviada=[],this.errorSopledAprobada=!1,this.arraySolpedAprobadas=[];for(let l of this.selectedSolped)a=new Date(l.docdate),"C"===l.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(l.id)),a.toDateString()!==t.toDateString()&&(this.errorFechaAprobacion=!0,this.arrayErrorFecha.push(l.id)),"P"===l.approved&&(this.errorSolpedEnviada=!0,this.arrayErrorSolpedEnviada.push(l.id)),"A"===l.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(l.id)),0===l.trm&&(this.errorTrmAprobacion=!0,this.arraryErrorTrm.push(l.id)),o.push(l.id);this.arrayIdSolped=o;let i="";this.errorSolpedCancelada?(i=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSolpedCancelada=!1):this.errorTrmAprobacion?(i=this.arraryErrorTrm.length>1?`Las solicitudes ${JSON.stringify(this.arraryErrorTrm)} no poseen TRM, por favor acutalice la TRM en las sulicitudes`:`La solicitud ${JSON.stringify(this.arraryErrorTrm)} no posee TRM, por favor acutalice la TRM de la sulicitud`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorTrmAprobacion=!1):this.errorSopledAprobada?(i=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha fue aprobada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSopledAprobada=!1):this.errorSolpedEnviada?(i=this.arrayErrorSolpedEnviada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya han sido enviadas a aprobaci\xf3n.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedEnviada)} ya ha fue enviada a aprobaci\xf3n`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i}),this.errorSolpedEnviada=!1):(i=this.errorFechaAprobacion?this.arrayErrorFecha.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorFecha)} tienen fechas de contabilizaci\xf3n diferentes a la fecha actual. \n                       Recuerde que la TRM de la aprobaci\xf3n sera basada en la fecha de contabilizaci\xf3n de la solicitud.\n                       \xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas? `:`La fecha de contabilizaci\xf3n de la solicitud ${JSON.stringify(this.arrayErrorFecha)}  es diferente a la fecha actual. \n            Recuerde que la TRM de la aprobaci\xf3n sera basada en la fecha de contabilizaci\xf3n de la solicitud.\n            \xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada? `:o.length>1?"\xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"c",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:i}))}onConfirm(){this.loading=!0;let o="";this.messageService.clear("c"),this.comprasService.envioAprobacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{console.log(t),0===t.filter(a=>"error"===a.status).length?(o=this.selectedSolped.length>1?"Las solicitudes seleccionadas, han sido enviadas a aprobaci\xf3n":"Las solicitud seleccionada, ha sido enviada a aprobaci\xf3n",this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:o}),this.getListado()):(this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t[0].message}))},error:t=>{console.log(t),this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}rechazar(){this.arrayIdSolped=[];let o=[];this.arraySolpedRechazadas=[],this.arraySolpedAprobadas=[],this.arrayErrorUsuarioAprobador=[],this.errorSopledARechazada=!1,this.errorSopledAprobada=!1,this.errorUsuarioAprobador=!1;for(let a of this.selectedSolped)"R"===a.approved&&(this.errorSopledARechazada=!0,this.arraySolpedRechazadas.push(a.id)),"A"===a.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(a.id)),a.usersapaprobador!==this.infoUsuario.codusersap&&(this.errorUsuarioAprobador=!0,this.arrayErrorUsuarioAprobador.push(a.id)),o.push(a.id);this.arrayIdSolped=o;let t="";this.errorSopledARechazada?(t=this.arraySolpedRechazadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedRechazadas)} ya fueron rechazadas.`:`La solicitud ${JSON.stringify(this.arraySolpedRechazadas)} ya fue rechazada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledARechazada=!1):this.errorSopledAprobada?(t=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha sido aprobada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledAprobada=!1):this.errorUsuarioAprobador?(t=this.arrayErrorUsuarioAprobador.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no pueden ser rechazadas por el usuario por ahora.`:`La solicitud ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no puede ser rechazada por el usuario por ahora.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorUsuarioAprobador=!1):(t=o.length>1?"\xbfDesea Continuar con el rechazo de las solicitudes seleccionadas?":"\xbfDesea Continuar con el rechazo de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"rj",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:t}))}aprobar(){this.arrayIdSolped=[];let o=[];this.arraySolpedRechazadas=[],this.arraySolpedAprobadas=[],this.arrayErrorUsuarioAprobador=[],this.errorSopledARechazada=!1,this.errorSopledAprobada=!1,this.errorUsuarioAprobador=!1,this.errorSolpedCancelada=!1,this.arrayErrorSolpedCancelada=[];for(let a of this.selectedSolped)"R"===a.approved&&(this.errorSopledARechazada=!0,this.arraySolpedRechazadas.push(a.id)),"C"===a.approved&&(this.errorSolpedCancelada=!0,this.arrayErrorSolpedCancelada.push(a.id)),"A"===a.approved&&(this.errorSopledAprobada=!0,this.arraySolpedAprobadas.push(a.id)),a.usersapaprobador!==this.infoUsuario.codusersap&&(this.errorUsuarioAprobador=!0,this.arrayErrorUsuarioAprobador.push(a.id)),o.push(a.id);this.arrayIdSolped=o;let t="";this.errorSolpedCancelada?(t=this.arrayErrorSolpedCancelada.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya han sido canceladas.`:`La solicitud ${JSON.stringify(this.arrayErrorSolpedCancelada)} ya ha sido cancelada`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSolpedCancelada=!1):this.errorSopledARechazada?(t=this.arraySolpedRechazadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedRechazadas)} ya fueron rechazadas.`:`La solicitud ${JSON.stringify(this.arraySolpedRechazadas)} ya fue rechazada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledARechazada=!1):this.errorSopledAprobada?(t=this.arraySolpedAprobadas.length>1?`Las solicitudes ${JSON.stringify(this.arraySolpedAprobadas)} ya han sido aprobadas.`:`La solicitud ${JSON.stringify(this.arraySolpedAprobadas)} ya ha sido aprobada.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorSopledAprobada=!1):this.errorUsuarioAprobador?(t=this.arrayErrorUsuarioAprobador.length>1?`Las solicitudes ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no pueden ser aprobadas por el usuario por ahora.`:`La solicitud ${JSON.stringify(this.arrayErrorUsuarioAprobador)} no puede ser aprobada por el usuario por ahora.`,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t}),this.errorUsuarioAprobador=!1):(t=o.length>1?"\xbfDesea Continuar con la aprobaci\xf3n de las solicitudes seleccionadas?":"\xbfDesea Continuar con la aprobaci\xf3n de la solicitud seleccionada?",this.messageService.clear(),this.messageService.add({key:"ap",sticky:!0,severity:"warn",summary:"Confirmaci\xf3n",detail:t}))}onReject(){this.messageService.clear("c"),this.errorFechaAprobacion=!1}onRejectAp(){this.messageService.clear("ap"),console.log(this.arrayIdSolped)}onRejectRap(){this.messageService.clear("rj")}onRejectCancel(){this.messageService.clear("cdel")}onConfirmCancel(){this.loading=!0;let o="";this.messageService.clear("cdel"),this.comprasService.cancelacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{"ok"==t.status?(o=this.arrayIdSolped.length>1?"La cancelaci\xf3n de las solicitudes seleccionadas fueron realizadas correctamente":"La cancelaci\xf3n de la solicitud seleccionada fue realizada correctamente",this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:o}),this.getListado()):(this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t.message}),this.loading=!1)},error:t=>{console.log(t),this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}onConfirmRap(){this.messageService.clear("rj"),this.frmRechazo=!0}rechazarSolped(){this.submitRechazo=!0,this.motivoRechazo?this.comprasService.aprobacionesSolped(this.authService.getToken(),this.selectedSolped[0].id).subscribe({next:o=>{let t=o.filter(i=>i.usersapaprobador===this.infoUsuario.codusersap&&"A"===i.estadoseccion&&"P"===i.estadoap);this.comprasService.rechazoSolped({autor:{fullname:t[0].nombreautor,email:t[0].emailautor},aprobador:{fullname:t[0].nombreaprobador,email:t[0].emailaprobador,usersap:t[0].usersapaprobador},infoSolped:{id_solped:this.selectedSolped[0].id,idlineap:t[0].id,bdmysql:this.infoUsuario.bdmysql,companysap:this.infoUsuario.dbcompanysap,logo:this.infoUsuario.logoempresa,comments:this.motivoRechazo}}).subscribe({next:i=>{"ok"===i[0].status?(this.getListado(),this.messageService.add({key:"tl",severity:"success",summary:"!Ok",detail:i[0].message}),this.frmRechazo=!1):this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:i[0].message})},error:i=>{console.log(i)}})},error:o=>{console.log(o)}}):this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:"Debe diligenciar el motivo por el cual desea rechazar la solicitud seleccionada"})}onConfirmAp(){this.loading=!0,this.messageService.clear("ap"),this.comprasService.aprobacionSolped(this.authService.getToken(),this.arrayIdSolped).subscribe({next:t=>{let a=[];if(t.arrayErrors.length>0){for(let i of t.arrayErrors)a.push({key:"tl",severity:"error",summary:"!Error",detail:i.messageSolped,life:5e3});if(t.arrayAproved.length>0){a.push({key:"tl",severity:"warn",summary:"!informaci\xf3n",detail:"Es posible que las siguentes solicitudes no se lograran guardar debido a los errores presentados.",life:5e3});for(let i of t.arrayAproved)a.push({key:"tl",severity:"warn",summary:"!informaci\xf3n",detail:i.messageSolped,life:5e3})}}else if(t.arrayAproved.length>0)for(let i of t.arrayAproved)a.push({key:"tl",severity:"success",summary:"!Ok",detail:i.messageSolped,life:5e3});this.getListado(),this.messageService.addAll(a)},error:t=>{this.loading=!1,this.messageService.add({key:"tl",severity:"error",summary:"!Error",detail:t})}})}clearToast(){this.messageService.clear()}formatCurrency(o){return o.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}clear(o){o.clear(),this.filter.nativeElement.value=""}getListado(){this.comprasService.listSolpedAprobadas(this.authService.getToken()).subscribe({next:o=>{this.loading=!1;for(let t of o)t.serieStr=this.series.filter(a=>a.code==t.serie)[0].name;this.solped=o,console.log(this.solped),this.loading=!1},error:o=>{console.log(o)}})}}$.\u0275fac=function(o){return new(o||$)(e.Y36(f.gz),e.Y36(X.l),e.Y36(w.c),e.Y36(Z.K),e.Y36(f.F0),e.Y36(u.YP),e.Y36(u.ez),e.Y36(x.e))},$.\u0275cmp=e.Xpm({type:$,selectors:[["app-solpeds-aprobadas"]],viewQuery:function(o,t){if(1&o&&e.Gf(Hi,5),2&o){let a;e.iGM(a=e.CRH())&&(t.filter=a.first)}},features:[e._Bn([u.ez,u.YP])],decls:46,vars:55,consts:[[3,"urlBreadCrumb"],[1,"grid"],[1,"col-12"],[1,"card"],["dataKey","id","styleClass","p-datatable-gridlines p-datatable-sm","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields","selection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["key","tl"],["key","c",3,"baseZIndex","onClose"],["pTemplate","message"],["key","ap",3,"baseZIndex","onClose"],["key","rj",3,"baseZIndex","onClose"],["key","cdel",3,"baseZIndex","onClose"],["header","Motivo rechazo solped",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],[1,"field","col"],["pInputTextarea","","styleClass","w-full","rows","10",1,"w-full","h-full",3,"ngModel","ngClass","ngModelChange"],["pTemplate","footer"],["header","Proceso de aprobaci\xf3n",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],["dataKey","id","styleClass","p-datatable-gridlines p-datatable-sm ","selectionMode","multiple","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields"],["dt2",""],["header","Documentos adjuntos de solped",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","pTooltip","Limpiar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2","mr-2","p-button-sm",3,"click"],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-success p-button-sm","icon","pi pi-plus",3,"disabled","click",4,"ngIf"],["pButton","","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-secondary p-button-sm",3,"pTooltip","icon","disabled","click",4,"ngIf"],["pButton","","pTooltip","Enviar a aprobaci\xf3n","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-warning p-button-sm","icon","pi pi-send",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-danger p-button-sm","icon","pi pi-trash",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Aprobar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-help p-button-sm","icon","pi pi-check-circle",3,"disabled","click",4,"ngIf"],["pButton","","pTooltip","Rechazar","tooltipPosition","bottom","placeholder","Bottom","class","p-button-outlined mb-2 mr-2 p-button-danger p-button-sm","icon","pi pi-times-circle",3,"disabled","click",4,"ngIf"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar por palabra clave",1,"w-full","p-inputtext-sm",3,"input"],["filter",""],["pButton","","pTooltip","Nuevo","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-plus",1,"p-button-outlined","mb-2","mr-2","p-button-success","p-button-sm",3,"disabled","click"],["pButton","","tooltipPosition","bottom","placeholder","Bottom",1,"p-button-outlined","mb-2","mr-2","p-button-secondary","p-button-sm",3,"pTooltip","icon","disabled","click"],["pButton","","pTooltip","Enviar a aprobaci\xf3n","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-send",1,"p-button-outlined","mb-2","mr-2","p-button-warning","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Cancelar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-trash",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Aprobar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-check-circle",1,"p-button-outlined","mb-2","mr-2","p-button-help","p-button-sm",3,"disabled","click"],["pButton","","pTooltip","Rechazar","tooltipPosition","bottom","placeholder","Bottom","icon","pi pi-times-circle",1,"p-button-outlined","mb-2","mr-2","p-button-danger","p-button-sm",3,"disabled","click"],[2,"width","3rem"],[1,"flex","justify-content-between","align-items-center"],["type","text","field","id","display","menu","placeholder","Buscar por c\xf3digo solped"],["type","text","field","serie","display","menu","placeholder","Buscar por tipo solped"],["type","date","field","docdate","display","menu"],["type","date","field","reqdate","display","menu"],["type","text","field","comments","display","menu","placeholder","Buscar por comentario"],["type","text","field","u_nf_depen_solped","display","menu","placeholder","Buscar por area"],["field","status","matchMode","equals","display","menu","placeholder","Buscar por estado",3,"showMatchModes","showOperator"],["pTemplate","filter"],["field","approved","display","menu","matchMode","equals","placeholder","Buscar por aprobaci\xf3n",3,"showMatchModes","showOperator"],["type","text","field","fullname","display","menu","placeholder","Buscar por usuario"],["type","text","field","sapsocnum","display","menu","placeholder","Buscar por c\xf3digo SAP"],["placeholder","Any",3,"ngModel","options","onChange"],["pTemplate","item"],[3,"value"],[2,"min-width","6rem"],[2,"min-width","12rem"],["class","pi pi-check-square","pTooltip","Aprobaciones","tooltipPosition","left",3,"click",4,"ngIf"],["pTooltip","Adjuntos","tooltipPosition","left",1,"pi","pi-file-pdf",3,"click"],["pTooltip","Aprobaciones","tooltipPosition","left",1,"pi","pi-check-square",3,"click"],["colspan","11",1,"text-center"],[1,"flex","flex-column",2,"flex","1"],[1,"text-center"],[1,"pi","pi-exclamation-triangle",2,"font-size","3rem"],[1,"grid","p-fluid"],[1,"col-6"],["type","button","pButton","","label","Si",1,"p-button-success",3,"click"],["type","button","pButton","","label","No",1,"p-button-secondary",3,"click"],["icon","pi pi-check","label","Ok","styleClass","p-button-text",3,"click"],["type","text","field","tipo","display","menu","placeholder","Buscar por tipo documento"],["type","text","field","nombre","display","menu","placeholder","Buscar por nombre documento"],[1,"align-content-center","justify-content-center"],["pTooltip","Adjuntos","tooltipPosition","left",1,"pi","pi-file-pdf"],[2,"min-width","4rem"],["label","Descargar","icon","pi pi-download","iconPos","left",1,"w-full",3,"onClick"],["icon","pi pi-check","label","Cerrar","styleClass","p-button-text",3,"click"]],template:function(o,t){1&o&&(e._UZ(0,"app-breadcrumb",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"p-table",4,5),e.NdJ("selectionChange",function(i){return t.selectedSolped=i}),e.YNc(6,ta,13,6,"ng-template",6),e.YNc(7,la,46,4,"ng-template",7),e.YNc(8,sa,31,23,"ng-template",8),e.YNc(9,da,3,0,"ng-template",9),e.YNc(10,pa,3,0,"ng-template",10),e.qZA()()()(),e._UZ(11,"p-toast",11),e.TgZ(12,"p-toast",12),e.NdJ("onClose",function(){return t.onReject()}),e.YNc(13,ca,12,2,"ng-template",13),e.qZA(),e.TgZ(14,"p-toast",14),e.NdJ("onClose",function(){return t.onRejectAp()}),e.YNc(15,ua,12,2,"ng-template",13),e.qZA(),e.TgZ(16,"p-toast",15),e.NdJ("onClose",function(){return t.onRejectRap()}),e.YNc(17,ma,12,2,"ng-template",13),e.qZA(),e.TgZ(18,"p-toast",16),e.NdJ("onClose",function(){return t.onRejectCancel()}),e.YNc(19,_a,12,2,"ng-template",13),e.qZA(),e.TgZ(20,"p-dialog",17),e.NdJ("visibleChange",function(i){return t.frmRechazo=i}),e.TgZ(21,"div",1)(22,"div",18)(23,"textarea",19),e.NdJ("ngModelChange",function(i){return t.motivoRechazo=i}),e._uU(24,"\t\t\t"),e.qZA()()(),e.YNc(25,ha,1,0,"ng-template",20),e.qZA(),e.TgZ(26,"p-dialog",21),e.NdJ("visibleChange",function(i){return t.dialogAprobaciones=i}),e.TgZ(27,"div",1)(28,"div",2)(29,"div",3)(30,"p-table",22,23),e.YNc(32,ga,7,0,"ng-template",6),e.YNc(33,ba,26,2,"ng-template",7),e.YNc(34,Sa,16,13,"ng-template",8),e.qZA()()()(),e.YNc(35,va,1,0,"ng-template",20),e.qZA(),e.TgZ(36,"p-dialog",24),e.NdJ("visibleChange",function(i){return t.dialogAdjuntos=i}),e.TgZ(37,"div",1)(38,"div",2)(39,"div",3)(40,"p-table",22,23),e.YNc(42,Ta,7,0,"ng-template",6),e.YNc(43,ya,19,0,"ng-template",7),e.YNc(44,xa,12,6,"ng-template",8),e.qZA()()()(),e.YNc(45,Za,1,0,"ng-template",20),e.qZA()),2&o&&(e.Q6J("urlBreadCrumb",t.urlBreadCrumb),e.xp6(4),e.Q6J("value",t.solped)("rows",10)("loading",t.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(47,ne))("selection",t.selectedSolped),e.xp6(8),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Q6J("baseZIndex",5e3),e.xp6(2),e.Akn(e.DdM(48,le)),e.Q6J("visible",t.frmRechazo)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(3),e.Q6J("ngModel",t.motivoRechazo)("ngClass",e.VKq(49,Aa,t.submitRechazo&&!t.motivoRechazo)),e.xp6(3),e.Akn(e.DdM(51,le)),e.Q6J("visible",t.dialogAprobaciones)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(4),e.Q6J("value",t.listaAprobaciones)("rows",10)("loading",t.loadingAp)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(52,ne)),e.xp6(6),e.Akn(e.DdM(53,le)),e.Q6J("visible",t.dialogAdjuntos)("modal",!0)("maximizable",!0)("draggable",!1)("resizable",!1),e.xp6(4),e.Q6J("value",t.listaDocumentosSolped)("rows",10)("loading",t.loadingDocumentos)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(54,ne)))},dependencies:[_.mk,_.O5,h.Fj,h.JJ,h.On,u.jx,T.Hq,T.zx,q.u,N.V,F.Lt,D.g,O.o,S.iA,S.UA,S.xl,M.FN,z.L,_.uU,ge.L],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]});class I{}I.\u0275fac=function(o){return new(o||I)},I.\u0275mod=e.oAB({type:I}),I.\u0275inj=e.cJS({imports:[f.Bz.forChild([{path:"",component:j},{path:"nueva",component:J},{path:"editar/:solped",component:R},{path:"formSolped",component:J},{path:"tracking",component:G},{path:"nueva-mp",component:K},{path:"editar-mp/:solped",component:Q},{path:"aprobadas",component:$}]),f.Bz]});var Ma=d(931),Ua=d(3983),Na=d(3837);class k{}k.\u0275fac=function(o){return new(o||k)},k.\u0275mod=e.oAB({type:k}),k.\u0275inj=e.cJS({imports:[_.ez,I,h.u5,h.UX,Ma.W,Ua.G,Na.S]})}}]);